import{$ as _h,A as ht,B as qA,C as HA,D as kn,E as gi,F as mh,G as oc,H as Wy,I as GA,J as zA,K as ie,L as ln,M as vt,N as Ky,O as WA,P as ac,Q as Ee,R as mn,S as yh,T as Qy,U as On,V as mi,W as vs,X as uc,Y as vh,Z as KA,_ as _s,a as z,aa as it,b as xe,ba as _t,c as kA,ca as Yy,d as Hy,e as M,f as OA,g as lh,h as FA,i as VA,j as V,k as Vo,l as dh,m as LA,n as jA,o as hh,p as Ct,q as fh,r as sc,s as Gy,t as UA,u as hr,v as zy,w as ph,x as BA,y as $A,z as gh}from"./chunk-MQJ75LOD.js";var QA=null;var Zy=1,YA=Symbol("SIGNAL");function be(n){let e=QA;return QA=n,e}var ZA={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function LL(n){if(!(ev(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Zy)){if(!n.producerMustRecompute(n)&&!Jy(n)){n.dirty=!1,n.lastCleanEpoch=Zy;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Zy}}function JA(n){return n&&(n.nextProducerIndex=0),be(n)}function XA(n,e){if(be(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ev(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Xy(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Jy(n){wh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(LL(t),r!==t.version))return!0}return!1}function eS(n){if(wh(n),ev(n))for(let e=0;e<n.producerNode.length;e++)Xy(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Xy(n,e){if(jL(n),wh(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)Xy(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];wh(i),i.producerIndexOfThis[r]=e}}function ev(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function wh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function jL(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function UL(){throw new Error}var BL=UL;function tS(n){BL=n}function ae(n){return typeof n=="function"}function Lo(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Eh=Lo(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ws(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var st=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ae(r))try{r()}catch(s){e=s instanceof Eh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{nS(s)}catch(o){e=e??[],o instanceof Eh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Eh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)nS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ws(t,e)}remove(e){let{_finalizers:t}=this;t&&ws(t,e),e instanceof n&&e._removeParent(this)}};st.EMPTY=(()=>{let n=new st;return n.closed=!0,n})();var tv=st.EMPTY;function Ih(n){return n instanceof st||n&&"closed"in n&&ae(n.remove)&&ae(n.add)&&ae(n.unsubscribe)}function nS(n){ae(n)?n():n.unsubscribe()}var Yn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var jo={setTimeout(n,e,...t){let{delegate:r}=jo;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=jo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ch(n){jo.setTimeout(()=>{let{onUnhandledError:e}=Yn;if(e)e(n);else throw n})}function Es(){}var rS=nv("C",void 0,void 0);function iS(n){return nv("E",void 0,n)}function sS(n){return nv("N",n,void 0)}function nv(n,e,t){return{kind:n,value:e,error:t}}var Is=null;function Uo(n){if(Yn.useDeprecatedSynchronousErrorHandling){let e=!Is;if(e&&(Is={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Is;if(Is=null,t)throw r}}else n()}function oS(n){Yn.useDeprecatedSynchronousErrorHandling&&Is&&(Is.errorThrown=!0,Is.error=n)}var Cs=class extends st{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ih(e)&&e.add(this)):this.destination=HL}static create(e,t,r){return new $r(e,t,r)}next(e){this.isStopped?iv(sS(e),this):this._next(e)}error(e){this.isStopped?iv(iS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?iv(rS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},$L=Function.prototype.bind;function rv(n,e){return $L.call(n,e)}var sv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Dh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Dh(r)}else Dh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Dh(t)}}},$r=class extends Cs{constructor(e,t,r){super();let i;if(ae(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Yn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&rv(e.next,s),error:e.error&&rv(e.error,s),complete:e.complete&&rv(e.complete,s)}):i=e}this.destination=new sv(i)}};function Dh(n){Yn.useDeprecatedSynchronousErrorHandling?oS(n):Ch(n)}function qL(n){throw n}function iv(n,e){let{onStoppedNotification:t}=Yn;t&&jo.setTimeout(()=>t(n,e))}var HL={closed:!0,next:Es,error:qL,complete:Es};var Bo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function St(n){return n}function ov(...n){return av(n)}function av(n){return n.length===0?St:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var he=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=zL(t)?t:new $r(t,r,i);return Uo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=aS(r),new r((i,s)=>{let o=new $r({next:a=>{try{t(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Bo](){return this}pipe(...t){return av(t)(this)}toPromise(t){return t=aS(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function aS(n){var e;return(e=n??Yn.Promise)!==null&&e!==void 0?e:Promise}function GL(n){return n&&ae(n.next)&&ae(n.error)&&ae(n.complete)}function zL(n){return n&&n instanceof Cs||GL(n)&&Ih(n)}function uv(n){return ae(n?.lift)}function ce(n){return e=>{if(uv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(n,e,t,r,i){return new cv(n,e,t,r,i)}var cv=class extends Cs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function $o(){return ce((n,e)=>{let t=null;n._refCount++;let r=ue(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var qo=class extends he{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,uv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new st;let t=this.getSubject();e.add(this.source.subscribe(ue(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=st.EMPTY)}return e}refCount(){return $o()(this)}};var uS=Lo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var tt=(()=>{class n extends he{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new bh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new uS}next(t){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?tv:(this.currentObservers=null,s.push(t),new st(()=>{this.currentObservers=null,ws(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new he;return t.source=this,t}}return n.create=(e,t)=>new bh(e,t),n})(),bh=class extends tt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:tv}};var Rt=class extends tt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var cc={now(){return(cc.delegate||Date).now()},delegate:void 0};var Th=class extends tt{constructor(e=1/0,t=1/0,r=cc){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var Ah=class extends st{constructor(e,t){super()}schedule(e,t=0){return this}};var lc={setInterval(n,e,...t){let{delegate:r}=lc;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=lc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Ho=class extends Ah{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return lc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&lc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ws(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Go=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Go.now=cc.now;var zo=class extends Go{constructor(e,t=Go.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Ds=new zo(Ho);var Sh=class extends Ho{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Rh=class extends zo{};var lv=new Rh(Sh);var Yt=new he(n=>n.complete());function cS(n){return n&&ae(n.schedule)}function dv(n){return n[n.length-1]}function Wo(n){return ae(dv(n))?n.pop():void 0}function fr(n){return cS(dv(n))?n.pop():void 0}function lS(n,e){return typeof dv(n)=="number"?n.pop():e}var xh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Mh(n){return ae(n?.then)}function Nh(n){return ae(n[Bo])}function Ph(n){return Symbol.asyncIterator&&ae(n?.[Symbol.asyncIterator])}function kh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function WL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Oh=WL();function Fh(n){return ae(n?.[Oh])}function Vh(n){return FA(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield lh(t.read());if(i)return yield lh(void 0);yield yield lh(r)}}finally{t.releaseLock()}})}function Lh(n){return ae(n?.getReader)}function Le(n){if(n instanceof he)return n;if(n!=null){if(Nh(n))return KL(n);if(xh(n))return QL(n);if(Mh(n))return YL(n);if(Ph(n))return dS(n);if(Fh(n))return ZL(n);if(Lh(n))return JL(n)}throw kh(n)}function KL(n){return new he(e=>{let t=n[Bo]();if(ae(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function QL(n){return new he(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function YL(n){return new he(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ch)})}function ZL(n){return new he(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function dS(n){return new he(e=>{XL(n,e).catch(t=>e.error(t))})}function JL(n){return dS(Vh(n))}function XL(n,e){var t,r,i,s;return OA(this,void 0,void 0,function*(){try{for(t=VA(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function dn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function yn(n,e=0){return ce((t,r)=>{t.subscribe(ue(r,i=>dn(r,n,()=>r.next(i),e),()=>dn(r,n,()=>r.complete(),e),i=>dn(r,n,()=>r.error(i),e)))})}function Fn(n,e=0){return ce((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function hS(n,e){return Le(n).pipe(Fn(e),yn(e))}function fS(n,e){return Le(n).pipe(Fn(e),yn(e))}function pS(n,e){return new he(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function gS(n,e){return new he(t=>{let r;return dn(t,e,()=>{r=n[Oh](),dn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ae(r?.return)&&r.return()})}function jh(n,e){if(!n)throw new Error("Iterable cannot be null");return new he(t=>{dn(t,e,()=>{let r=n[Symbol.asyncIterator]();dn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function mS(n,e){return jh(Vh(n),e)}function yS(n,e){if(n!=null){if(Nh(n))return hS(n,e);if(xh(n))return pS(n,e);if(Mh(n))return fS(n,e);if(Ph(n))return jh(n,e);if(Fh(n))return gS(n,e);if(Lh(n))return mS(n,e)}throw kh(n)}function Me(n,e){return e?yS(n,e):Le(n)}function ee(...n){let e=fr(n);return Me(n,e)}function Ko(n,e){let t=ae(n)?n:()=>n,r=i=>i.error(t());return new he(e?i=>e.schedule(r,0,i):r)}function hv(n){return!!n&&(n instanceof he||ae(n.lift)&&ae(n.subscribe))}var qr=Lo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Z(n,e){return ce((t,r)=>{let i=0;t.subscribe(ue(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:ej}=Array;function tj(n,e){return ej(e)?n(...e):n(e)}function Uh(n){return Z(e=>tj(n,e))}var{isArray:nj}=Array,{getPrototypeOf:rj,prototype:ij,keys:sj}=Object;function Bh(n){if(n.length===1){let e=n[0];if(nj(e))return{args:e,keys:null};if(oj(e)){let t=sj(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function oj(n){return n&&typeof n=="object"&&rj(n)===ij}function $h(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function qh(...n){let e=fr(n),t=Wo(n),{args:r,keys:i}=Bh(n);if(r.length===0)return Me([],e);let s=new he(aj(r,e,i?o=>$h(i,o):St));return t?s.pipe(Uh(t)):s}function aj(n,e,t=St){return r=>{vS(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)vS(e,()=>{let l=Me(n[u],e),d=!1;l.subscribe(ue(r,h=>{s[u]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function vS(n,e,t){n?dn(t,n,e):e()}function _S(n,e,t,r,i,s,o,a){let u=[],l=0,d=0,h=!1,g=()=>{h&&!u.length&&!l&&e.complete()},y=D=>l<r?_(D):u.push(D),_=D=>{s&&e.next(D),l++;let A=!1;Le(t(D,d++)).subscribe(ue(e,P=>{i?.(P),s?y(P):e.next(P)},()=>{A=!0},void 0,()=>{if(A)try{for(l--;u.length&&l<r;){let P=u.shift();o?dn(e,o,()=>_(P)):_(P)}g()}catch(P){e.error(P)}}))};return n.subscribe(ue(e,y,()=>{h=!0,g()})),()=>{a?.()}}function wt(n,e,t=1/0){return ae(e)?wt((r,i)=>Z((s,o)=>e(r,s,i,o))(Le(n(r,i))),t):(typeof e=="number"&&(t=e),ce((r,i)=>_S(r,i,n,t)))}function dc(n=1/0){return wt(St,n)}function wS(){return dc(1)}function Qo(...n){return wS()(Me(n,fr(n)))}function Hh(n){return new he(e=>{Le(n()).subscribe(e)})}function fv(...n){let e=Wo(n),{args:t,keys:r}=Bh(n),i=new he(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),u=o,l=o;for(let d=0;d<o;d++){let h=!1;Le(t[d]).subscribe(ue(s,g=>{h||(h=!0,l--),a[d]=g},()=>u--,void 0,()=>{(!u||!h)&&(l||s.next(r?$h(r,a):a),s.complete())}))}});return e?i.pipe(Uh(e)):i}function Yo(...n){let e=fr(n),t=lS(n,1/0),r=n;return r.length?r.length===1?Le(r[0]):dc(t)(Me(r,e)):Yt}function xt(n,e){return ce((t,r)=>{let i=0;t.subscribe(ue(r,s=>n.call(e,s,i++)&&r.next(s)))})}function yi(n){return ce((e,t)=>{let r=null,i=!1,s;r=e.subscribe(ue(t,void 0,void 0,o=>{s=Le(n(o,yi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function ES(n,e,t,r,i){return(s,o)=>{let a=t,u=e,l=0;s.subscribe(ue(o,d=>{let h=l++;u=a?n(u,d,h):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function bs(n,e){return ae(e)?wt(n,e,1):wt(n,1)}function vi(n){return ce((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Hr(n){return n<=0?()=>Yt:ce((e,t)=>{let r=0;e.subscribe(ue(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function pv(n){return Z(()=>n)}function hc(n,e=St){return n=n??uj,ce((t,r)=>{let i,s=!0;t.subscribe(ue(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function uj(n,e){return n===e}function Gh(n=cj){return ce((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function cj(){return new qr}function Zo(n){return ce((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function vn(n,e){let t=arguments.length>=2;return r=>r.pipe(n?xt((i,s)=>n(i,s,r)):St,Hr(1),t?vi(e):Gh(()=>new qr))}function Jo(n){return n<=0?()=>Yt:ce((e,t)=>{let r=[];e.subscribe(ue(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function gv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?xt((i,s)=>n(i,s,r)):St,Jo(1),t?vi(e):Gh(()=>new qr))}function fc(){return ce((n,e)=>{let t,r=!1;n.subscribe(ue(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function pr(n,e){return ce(ES(n,e,arguments.length>=2,!0))}function pc(n={}){let{connector:e=()=>new tt,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,l=0,d=!1,h=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),o=u=void 0,d=h=!1},_=()=>{let D=o;y(),D?.unsubscribe()};return ce((D,A)=>{l++,!h&&!d&&g();let P=u=u??e();A.add(()=>{l--,l===0&&!h&&!d&&(a=mv(_,i))}),P.subscribe(A),!o&&l>0&&(o=new $r({next:U=>P.next(U),error:U=>{h=!0,g(),a=mv(y,t,U),P.error(U)},complete:()=>{d=!0,g(),a=mv(y,r),P.complete()}}),Le(D).subscribe(o))})(s)}}function mv(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new $r({next:()=>{r.unsubscribe(),n()}});return Le(e(...t)).subscribe(r)}function zh(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,pc({connector:()=>new Th(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function yv(n){return ce((e,t)=>{let r=!1,i=0;e.subscribe(ue(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}function Ts(...n){let e=fr(n);return ce((t,r)=>{(e?Qo(n,t,e):Qo(n,t)).subscribe(r)})}function We(n,e){return ce((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(ue(r,u=>{i?.unsubscribe();let l=0,d=s++;Le(n(u,d)).subscribe(i=ue(r,h=>r.next(e?e(u,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Wh(n,e){return ae(e)?We(()=>n,e):We(()=>n)}function vv(n){return ce((e,t)=>{Le(n).subscribe(ue(t,()=>t.complete(),Es)),!t.closed&&e.subscribe(t)})}function ot(n,e,t){let r=ae(n)||e||t?{next:n,error:e,complete:t}:n;return r?ce((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ue(s,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),s.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):St}function _v(...n){let e=Wo(n);return ce((t,r)=>{let i=n.length,s=new Array(i),o=n.map(()=>!1),a=!1;for(let u=0;u<i;u++)Le(n[u]).subscribe(ue(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(St))&&(o=null))},Es));t.subscribe(ue(r,u=>{if(a){let l=[u,...s];r.next(e?e(...l):l)}}))})}var sR="https://g.co/ng/security#xss",ne=class extends Error{constructor(e,t){super(Rf(e,t)),this.code=e}};function Rf(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Mc(n){return{toString:n}.toString()}var Kh="__parameters__";function lj(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function dj(n,e,t){return Mc(()=>{let r=lj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,l,d){let h=u.hasOwnProperty(Kh)?u[Kh]:Object.defineProperty(u,Kh,{value:[]})[Kh];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var As=globalThis;function je(n){for(let e in n)if(n[e]===je)return e;throw Error("Could not find renamed property on target object.")}function hj(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function hn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(hn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function IS(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var fj=je({__forward_ref__:je});function ha(n){return n.__forward_ref__=ha,n.toString=function(){return hn(this())},n}function Zt(n){return oR(n)?n():n}function oR(n){return typeof n=="function"&&n.hasOwnProperty(fj)&&n.__forward_ref__===ha}function te(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Jt(n){return{providers:n.providers||[],imports:n.imports||[]}}function xf(n){return CS(n,uR)||CS(n,cR)}function aR(n){return xf(n)!==null}function CS(n,e){return n.hasOwnProperty(e)?n[e]:null}function pj(n){let e=n&&(n[uR]||n[cR]);return e||null}function DS(n){return n&&(n.hasOwnProperty(bS)||n.hasOwnProperty(gj))?n[bS]:null}var uR=je({\u0275prov:je}),bS=je({\u0275inj:je}),cR=je({ngInjectableDef:je}),gj=je({ngInjectorDef:je}),G=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=te({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function lR(n){return n&&!!n.\u0275providers}var mj=je({\u0275cmp:je}),yj=je({\u0275dir:je}),vj=je({\u0275pipe:je}),_j=je({\u0275mod:je}),af=je({\u0275fac:je}),gc=je({__NG_ELEMENT_ID__:je}),TS=je({__NG_ENV_ID__:je});function Mf(n){return typeof n=="string"?n:n==null?"":String(n)}function wj(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Mf(n)}function Ej(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ne(-200,n)}function S_(n,e){throw new ne(-201,!1)}var _e=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(_e||{}),Lv;function dR(){return Lv}function Vn(n){let e=Lv;return Lv=n,e}function hR(n,e,t){let r=xf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&_e.Optional)return null;if(e!==void 0)return e;S_(n,"Injector")}var Ij={},mc=Ij,jv="__NG_DI_FLAG__",uf="ngTempTokenPath",Cj="ngTokenPath",Dj=/\n/gm,bj="\u0275",AS="__source",na;function Tj(){return na}function _i(n){let e=na;return na=n,e}function Aj(n,e=_e.Default){if(na===void 0)throw new ne(-203,!1);return na===null?hR(n,void 0,e):na.get(n,e&_e.Optional?null:void 0,e)}function L(n,e=_e.Default){return(dR()||Aj)(Zt(n),e)}function B(n,e=_e.Default){return L(n,Nf(e))}function Nf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Uv(n){let e=[];for(let t=0;t<n.length;t++){let r=Zt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ne(900,!1);let i,s=_e.Default;for(let o=0;o<r.length;o++){let a=r[o],u=Rj(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(L(i,s))}else e.push(L(r))}return e}function Sj(n,e){return n[jv]=e,n.prototype[jv]=e,n}function Rj(n){return n[jv]}function xj(n,e,t,r){let i=n[uf];throw e[AS]&&i.unshift(e[AS]),n.message=Mj(`
`+n.message,i,t,r),n[Cj]=i,n[uf]=null,n}function Mj(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==bj?n.slice(2):n;let i=hn(e);if(Array.isArray(e))i=e.map(hn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):hn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Dj,`
  `)}`}var at=Sj(dj("Optional"),8);function ia(n,e){let t=n.hasOwnProperty(af);return t?n[af]:null}function R_(n,e){n.forEach(t=>Array.isArray(t)?R_(t,e):e(t))}function fR(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function cf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Nj(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function Pj(n,e,t){let r=Nc(n,e);return r>=0?n[r|1]=t:(r=~r,Nj(n,r,e,t)),r}function wv(n,e){let t=Nc(n,e);if(t>=0)return n[t|1]}function Nc(n,e){return kj(n,e,1)}function kj(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var sa={},_n=[],Rs=new G(""),pR=new G("",-1),gR=new G(""),lf=class{get(e,t=mc){if(t===mc){let r=new Error(`NullInjectorError: No provider for ${hn(e)}!`);throw r.name="NullInjectorError",r}return t}},mR=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(mR||{}),yr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(yr||{}),$t=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}($t||{});function Oj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Bv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];Fj(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function yR(n){return n===3||n===4||n===6}function Fj(n){return n.charCodeAt(0)===64}function yc(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?SS(n,t,i,null,e[++r]):SS(n,t,i,null,null))}}return n}function SS(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var vR="ng-template";function Vj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Oj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(x_(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function x_(n){return n.type===4&&n.value!==vR}function Lj(n,e,t){let r=n.type===4&&!t?vR:n.value;return e===r}function jj(n,e,t){let r=4,i=n.attrs,s=i!==null?$j(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Zn(r)&&!Zn(u))return!1;if(o&&Zn(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!Lj(n,u,t)||u===""&&e.length===1){if(Zn(r))return!1;o=!0}}else if(r&8){if(i===null||!Vj(n,i,u,t)){if(Zn(r))return!1;o=!0}}else{let l=e[++a],d=Uj(u,i,x_(n),t);if(d===-1){if(Zn(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Zn(r))return!1;o=!0}}}}return Zn(r)||o}function Zn(n){return(n&1)===0}function Uj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return qj(e,n)}function Bj(n,e,t=!1){for(let r=0;r<e.length;r++)if(jj(n,e[r],t))return!0;return!1}function $j(n){for(let e=0;e<n.length;e++){let t=n[e];if(yR(t))return e}return n.length}function qj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function RS(n,e){return n?":not("+e.trim()+")":e}function Hj(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Zn(o)&&(e+=RS(s,i),i=""),r=o,s=s||!Zn(r);t++}return i!==""&&(e+=RS(s,i)),e}function Gj(n){return n.map(Hj).join(",")}function zj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Zn(i))break;i=s}r++}return{attrs:e,classes:t}}function Un(n){return Mc(()=>{let e=CR(n),t=xe(z({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===mR.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||yr.Emulated,styles:n.styles||_n,_:null,schemas:n.schemas||null,tView:null,id:""});DR(t);let r=n.dependencies;return t.directiveDefs=MS(r,!1),t.pipeDefs=MS(r,!0),t.id=Qj(t),t})}function Wj(n){return xs(n)||_R(n)}function Kj(n){return n!==null}function Xt(n){return Mc(()=>({type:n.type,bootstrap:n.bootstrap||_n,declarations:n.declarations||_n,imports:n.imports||_n,exports:n.exports||_n,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function xS(n,e){if(n==null)return sa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=$t.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==$t.None?[r,a]:r,e[s]=o):t[s]=r}return t}function In(n){return Mc(()=>{let e=CR(n);return DR(e),e})}function xs(n){return n[mj]||null}function _R(n){return n[yj]||null}function wR(n){return n[vj]||null}function ER(n){let e=xs(n)||_R(n)||wR(n);return e!==null?e.standalone:!1}function IR(n,e){let t=n[_j]||null;if(!t&&e===!0)throw new Error(`Type ${hn(n)} does not have '\u0275mod' property.`);return t}function CR(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||sa,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||_n,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:xS(n.inputs,e),outputs:xS(n.outputs),debugInfo:null}}function DR(n){n.features?.forEach(e=>e(n))}function MS(n,e){if(!n)return null;let t=e?wR:Wj;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Kj)}function Qj(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function en(n){return{\u0275providers:n}}function M_(...n){return{\u0275providers:bR(!0,n),\u0275fromNgModule:!0}}function bR(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return R_(e,o=>{let a=o;$v(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&TR(i,s),t}function TR(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];N_(i,s=>{e(s,r)})}}function $v(n,e,t,r){if(n=Zt(n),!n)return!1;let i=null,s=DS(n),o=!s&&xs(n);if(!s&&!o){let u=n.ngModule;if(s=DS(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of u)$v(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{R_(s.imports,d=>{$v(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&TR(l,e)}if(!a){let l=ia(i)||(()=>new i);e({provide:i,useFactory:l,deps:_n},i),e({provide:gR,useValue:i,multi:!0},i),e({provide:Rs,useValue:()=>L(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let l=n;N_(u,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function N_(n,e){for(let t of n)lR(t)&&(t=t.\u0275providers),Array.isArray(t)?N_(t,e):e(t)}var Yj=je({provide:String,useValue:je});function AR(n){return n!==null&&typeof n=="object"&&Yj in n}function Zj(n){return!!(n&&n.useExisting)}function Jj(n){return!!(n&&n.useFactory)}function oa(n){return typeof n=="function"}function Xj(n){return!!n.useClass}var Pf=new G(""),tf={},e2={},Ev;function P_(){return Ev===void 0&&(Ev=new lf),Ev}var Ln=class{},vc=class extends Ln{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Hv(e,o=>this.processProvider(o)),this.records.set(pR,Xo(void 0,this)),i.has("environment")&&this.records.set(Ln,Xo(void 0,this));let s=this.records.get(Pf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(gR,_n,_e.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=be(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),be(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=_i(this),r=Vn(void 0),i;try{return e()}finally{_i(t),Vn(r)}}get(e,t=mc,r=_e.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(TS))return e[TS](this);r=Nf(r);let i,s=_i(this),o=Vn(void 0);try{if(!(r&_e.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=s2(e)&&xf(e);l&&this.injectableDefInScope(l)?u=Xo(qv(e),tf):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&_e.Self?P_():this.parent;return t=r&_e.Optional&&t===mc?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[uf]=a[uf]||[]).unshift(hn(e)),s)throw a;return xj(a,e,"R3InjectorError",this.source)}else throw a}finally{Vn(o),_i(s)}}resolveInjectorInitializers(){let e=be(null),t=_i(this),r=Vn(void 0),i;try{let s=this.get(Rs,_n,_e.Self);for(let o of s)o()}finally{_i(t),Vn(r),be(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(hn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ne(205,!1)}processProvider(e){e=Zt(e);let t=oa(e)?e:Zt(e&&e.provide),r=n2(e);if(!oa(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Xo(void 0,tf,!0),i.factory=()=>Uv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=be(null);try{return t.value===tf&&(t.value=e2,t.value=t.factory()),typeof t.value=="object"&&t.value&&i2(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{be(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Zt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function qv(n){let e=xf(n),t=e!==null?e.factory:ia(n);if(t!==null)return t;if(n instanceof G)throw new ne(204,!1);if(n instanceof Function)return t2(n);throw new ne(204,!1)}function t2(n){if(n.length>0)throw new ne(204,!1);let t=pj(n);return t!==null?()=>t.factory(n):()=>new n}function n2(n){if(AR(n))return Xo(void 0,n.useValue);{let e=SR(n);return Xo(e,tf)}}function SR(n,e,t){let r;if(oa(n)){let i=Zt(n);return ia(i)||qv(i)}else if(AR(n))r=()=>Zt(n.useValue);else if(Jj(n))r=()=>n.useFactory(...Uv(n.deps||[]));else if(Zj(n))r=()=>L(Zt(n.useExisting));else{let i=Zt(n&&(n.useClass||n.provide));if(r2(n))r=()=>new i(...Uv(n.deps));else return ia(i)||qv(i)}return r}function Xo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function r2(n){return!!n.deps}function i2(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function s2(n){return typeof n=="function"||typeof n=="object"&&n instanceof G}function Hv(n,e){for(let t of n)Array.isArray(t)?Hv(t,e):t&&lR(t)?Hv(t.\u0275providers,e):e(t)}function Ci(n,e){n instanceof vc&&n.assertNotDestroyed();let t,r=_i(n),i=Vn(void 0);try{return e()}finally{_i(r),Vn(i)}}function o2(){return dR()!==void 0||Tj()!=null}function a2(n){return typeof n=="function"}var wn=0,pe=1,oe=2,Mt=3,Jn=4,tr=5,jn=6,_c=7,Ut=8,aa=9,Xn=10,Ye=11,wc=12,NS=13,fa=14,En=15,kf=16,ea=17,ua=18,Of=19,RR=20,wi=21,Iv=22,Ms=23,qt=25,xR=1,Ec=6,zr=7,df=8,hf=9,Bt=10,k_=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(k_||{});function Gr(n){return Array.isArray(n)&&typeof n[xR]=="object"}function vr(n){return Array.isArray(n)&&n[xR]===!0}function MR(n){return(n.flags&4)!==0}function Pc(n){return n.componentOffset>-1}function O_(n){return(n.flags&1)===1}function Ei(n){return!!n.template}function NR(n){return(n[oe]&512)!==0}var Gv=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function PR(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Di(){return kR}function kR(n){return n.type.prototype.ngOnChanges&&(n.setInput=c2),u2}Di.ngInherit=!0;function u2(){let n=FR(this),e=n?.current;if(e){let t=n.previous;if(t===sa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function c2(n,e,t,r,i){let s=this.declaredInputs[r],o=FR(n)||l2(n,{previous:sa,current:null}),a=o.current||(o.current={}),u=o.previous,l=u[s];a[s]=new Gv(l&&l.currentValue,t,u===sa),PR(n,e,i,t)}var OR="__ngSimpleChanges__";function FR(n){return n[OR]||null}function l2(n,e){return n[OR]=e}var PS=null;var gr=function(n,e,t){PS?.(n,e,t)},d2="svg",h2="math",f2=!1;function p2(){return f2}function er(n){for(;Array.isArray(n);)n=n[wn];return n}function VR(n,e){return er(e[n])}function Cn(n,e){return er(e[n.index])}function F_(n,e){return n.data[e]}function bi(n,e){let t=e[n];return Gr(t)?t:t[wn]}function V_(n){return(n[oe]&128)===128}function g2(n){return vr(n[Mt])}function ff(n,e){return e==null?null:n[e]}function LR(n){n[ea]=0}function m2(n){n[oe]&1024||(n[oe]|=1024,V_(n)&&Ic(n))}function y2(n,e){for(;n>0;)e=e[fa],n--;return e}function L_(n){return!!(n[oe]&9216||n[Ms]?.dirty)}function zv(n){n[Xn].changeDetectionScheduler?.notify(1),L_(n)?Ic(n):n[oe]&64&&(p2()?(n[oe]|=1024,Ic(n)):n[Xn].changeDetectionScheduler?.notify())}function Ic(n){n[Xn].changeDetectionScheduler?.notify();let e=Cc(n);for(;e!==null&&!(e[oe]&8192||(e[oe]|=8192,!V_(e)));)e=Cc(e)}function jR(n,e){if((n[oe]&256)===256)throw new ne(911,!1);n[wi]===null&&(n[wi]=[]),n[wi].push(e)}function v2(n,e){if(n[wi]===null)return;let t=n[wi].indexOf(e);t!==-1&&n[wi].splice(t,1)}function Cc(n){let e=n[Mt];return vr(e)?e[Mt]:e}var Ie={lFrame:KR(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function _2(){return Ie.lFrame.elementDepthCount}function w2(){Ie.lFrame.elementDepthCount++}function E2(){Ie.lFrame.elementDepthCount--}function UR(){return Ie.bindingsEnabled}function kc(){return Ie.skipHydrationRootTNode!==null}function I2(n){return Ie.skipHydrationRootTNode===n}function C2(n){Ie.skipHydrationRootTNode=n}function D2(){Ie.skipHydrationRootTNode=null}function Ge(){return Ie.lFrame.lView}function nr(){return Ie.lFrame.tView}function BR(n){return Ie.lFrame.contextLView=n,n[Ut]}function $R(n){return Ie.lFrame.contextLView=null,n}function Bn(){let n=qR();for(;n!==null&&n.type===64;)n=n.parent;return n}function qR(){return Ie.lFrame.currentTNode}function b2(){let n=Ie.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Oc(n,e){let t=Ie.lFrame;t.currentTNode=n,t.isParent=e}function HR(){return Ie.lFrame.isParent}function T2(){Ie.lFrame.isParent=!1}function A2(n){return Ie.lFrame.bindingIndex=n}function Fc(){return Ie.lFrame.bindingIndex++}function S2(n){let e=Ie.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function R2(){return Ie.lFrame.inI18n}function x2(n,e){let t=Ie.lFrame;t.bindingIndex=t.bindingRootIndex=n,Wv(e)}function M2(){return Ie.lFrame.currentDirectiveIndex}function Wv(n){Ie.lFrame.currentDirectiveIndex=n}function N2(n){let e=Ie.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function GR(n){Ie.lFrame.currentQueryIndex=n}function P2(n){let e=n[pe];return e.type===2?e.declTNode:e.type===1?n[tr]:null}function zR(n,e,t){if(t&_e.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&_e.Host);)if(i=P2(s),i===null||(s=s[fa],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Ie.lFrame=WR();return r.currentTNode=e,r.lView=n,!0}function j_(n){let e=WR(),t=n[pe];Ie.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function WR(){let n=Ie.lFrame,e=n===null?null:n.child;return e===null?KR(n):e}function KR(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function QR(){let n=Ie.lFrame;return Ie.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var YR=QR;function U_(){let n=QR();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function k2(n){return(Ie.lFrame.contextLView=y2(n,Ie.lFrame.contextLView))[Ut]}function Vs(){return Ie.lFrame.selectedIndex}function Ns(n){Ie.lFrame.selectedIndex=n}function ZR(){let n=Ie.lFrame;return F_(n.tView,n.selectedIndex)}function JR(){return Ie.lFrame.currentNamespace}var XR=!0;function B_(){return XR}function _r(n){XR=n}function O2(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=kR(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function $_(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function nf(n,e,t){ex(n,e,3,t)}function rf(n,e,t,r){(n[oe]&3)===t&&ex(n,e,t,r)}function Cv(n,e){let t=n[oe];(t&3)===e&&(t&=16383,t+=1,n[oe]=t)}function ex(n,e,t,r){let i=r!==void 0?n[ea]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[ea]+=65536),(a<s||s==-1)&&(F2(n,t,e,u),n[ea]=(n[ea]&4294901760)+u+2),u++}function kS(n,e){gr(4,n,e);let t=be(null);try{e.call(n)}finally{be(t),gr(5,n,e)}}function F2(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[oe]>>14<n[ea]>>16&&(n[oe]&3)===e&&(n[oe]+=16384,kS(a,s)):kS(a,s)}var ra=-1,Ps=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function V2(n){return n instanceof Ps}function L2(n){return(n.flags&8)!==0}function j2(n){return(n.flags&16)!==0}function tx(n){return n!==ra}function pf(n){return n&32767}function U2(n){return n>>16}function gf(n,e){let t=U2(n),r=e;for(;t>0;)r=r[fa],t--;return r}var Kv=!0;function OS(n){let e=Kv;return Kv=n,e}var B2=256,nx=B2-1,rx=5,$2=0,mr={};function q2(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(gc)&&(r=t[gc]),r==null&&(r=t[gc]=$2++);let i=r&nx,s=1<<i;e.data[n+(i>>rx)]|=s}function mf(n,e){let t=ix(n,e);if(t!==-1)return t;let r=e[pe];r.firstCreatePass&&(n.injectorIndex=e.length,Dv(r.data,n),Dv(e,null),Dv(r.blueprint,null));let i=q_(n,e),s=n.injectorIndex;if(tx(i)){let o=pf(i),a=gf(i,e),u=a[pe].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function Dv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ix(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function q_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=cx(i),r===null)return ra;if(t++,i=i[fa],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return ra}function Qv(n,e,t){q2(n,e,t)}function H2(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(yR(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function sx(n,e,t){if(t&_e.Optional||n!==void 0)return n;S_(e,"NodeInjector")}function ox(n,e,t,r){if(t&_e.Optional&&r===void 0&&(r=null),!(t&(_e.Self|_e.Host))){let i=n[aa],s=Vn(void 0);try{return i?i.get(e,r,t&_e.Optional):hR(e,r,t&_e.Optional)}finally{Vn(s)}}return sx(r,e,t)}function ax(n,e,t,r=_e.Default,i){if(n!==null){if(e[oe]&2048&&!(r&_e.Self)){let o=Q2(n,e,t,r,mr);if(o!==mr)return o}let s=ux(n,e,t,r,mr);if(s!==mr)return s}return ox(e,t,r,i)}function ux(n,e,t,r,i){let s=W2(t);if(typeof s=="function"){if(!zR(e,n,r))return r&_e.Host?sx(i,t,r):ox(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&_e.Optional))S_(t);else return o}finally{YR()}}else if(typeof s=="number"){let o=null,a=ix(n,e),u=ra,l=r&_e.Host?e[En][tr]:null;for((a===-1||r&_e.SkipSelf)&&(u=a===-1?q_(n,e):e[a+8],u===ra||!VS(r,!1)?a=-1:(o=e[pe],a=pf(u),e=gf(u,e)));a!==-1;){let d=e[pe];if(FS(s,a,d.data)){let h=G2(a,e,t,o,r,l);if(h!==mr)return h}u=e[a+8],u!==ra&&VS(r,e[pe].data[a+8]===l)&&FS(s,a,e)?(o=d,a=pf(u),e=gf(u,e)):a=-1}}return i}function G2(n,e,t,r,i,s){let o=e[pe],a=o.data[n+8],u=r==null?Pc(a)&&Kv:r!=o&&(a.type&3)!==0,l=i&_e.Host&&s===a,d=z2(a,o,t,u,l);return d!==null?ca(e,o,d,a):mr}function z2(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,u=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,g=i?a+d:l;for(let y=h;y<g;y++){let _=o[y];if(y<u&&t===_||y>=u&&_.type===t)return y}if(i){let y=o[u];if(y&&Ei(y)&&y.type===t)return u}return null}function ca(n,e,t,r){let i=n[t],s=e.data;if(V2(i)){let o=i;o.resolving&&Ej(wj(s[t]));let a=OS(o.canSeeViewProviders);o.resolving=!0;let u,l=o.injectImpl?Vn(o.injectImpl):null,d=zR(n,r,_e.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&O2(t,s[t],e)}finally{l!==null&&Vn(l),OS(a),o.resolving=!1,YR()}}return i}function W2(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(gc)?n[gc]:void 0;return typeof e=="number"?e>=0?e&nx:K2:e}function FS(n,e,t){let r=1<<n;return!!(t[e+(n>>rx)]&r)}function VS(n,e){return!(n&_e.Self)&&!(n&_e.Host&&e)}var Ss=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return ax(this._tNode,this._lView,e,Nf(r),t)}};function K2(){return new Ss(Bn(),Ge())}function Vc(n){return Mc(()=>{let e=n.prototype.constructor,t=e[af]||Yv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[af]||Yv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Yv(n){return oR(n)?()=>{let e=Yv(Zt(n));return e&&e()}:ia(n)}function Q2(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[oe]&2048&&!(o[oe]&512);){let a=ux(s,o,t,r|_e.Self,mr);if(a!==mr)return a;let u=s.parent;if(!u){let l=o[RR];if(l){let d=l.get(t,mr,r);if(d!==mr)return d}u=cx(o),o=o[fa]}s=u}return i}function cx(n){let e=n[pe],t=e.type;return t===2?e.declTNode:t===1?n[tr]:null}function H_(n){return H2(Bn(),n)}function LS(n,e=null,t=null,r){let i=lx(n,e,t,r);return i.resolveInjectorInitializers(),i}function lx(n,e=null,t=null,r,i=new Set){let s=[t||_n,M_(n)];return r=r||(typeof n=="object"?void 0:hn(n)),new vc(s,e||P_(),r||null,i)}var Ht=(()=>{class n{static{this.THROW_IF_NOT_FOUND=mc}static{this.NULL=new lf}static create(t,r){if(Array.isArray(t))return LS({name:""},r,t,"");{let i=t.name??"";return LS({name:i},t.parent,t.providers,i)}}static{this.\u0275prov=te({token:n,providedIn:"any",factory:()=>L(pR)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();var Y2="ngOriginalError";function bv(n){return n[Y2]}var Wr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&bv(e);for(;t&&bv(t);)t=bv(t);return t||null}},dx=new G("",{providedIn:"root",factory:()=>B(Wr).handleError.bind(void 0)}),hx=(()=>{class n{static{this.__NG_ELEMENT_ID__=Z2}static{this.__NG_ENV_ID__=t=>t}}return n})(),Zv=class extends hx{constructor(e){super(),this._lView=e}onDestroy(e){return jR(this._lView,e),()=>v2(this._lView,e)}};function Z2(){return new Zv(Ge())}function J2(){return G_(Bn(),Ge())}function G_(n,e){return new Ti(Cn(n,e))}var Ti=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=J2}}return n})();var Jv=class extends tt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,o2()&&(this.destroyRef=B(hx,{optional:!0})??void 0)}emit(e){let t=be(null);try{super.next(e)}finally{be(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Tv(s),i&&(i=Tv(i)),o&&(o=Tv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof st&&e.add(a),a}};function Tv(n){return e=>{setTimeout(n,void 0,e)}}var jt=Jv;var X2="ngSkipHydration",eU="ngskiphydration";function fx(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let r=e[t];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===eU)return!0}return!1}function px(n){return n.hasAttribute(X2)}function yf(n){return(n.flags&128)===128}function tU(n){if(yf(n))return!0;let e=n.parent;for(;e;){if(yf(n)||fx(e))return!0;e=e.parent}return!1}var gx=new Map,nU=0;function rU(){return nU++}function iU(n){gx.set(n[Of],n)}function sU(n){gx.delete(n[Of])}var jS="__ngContext__";function ks(n,e){Gr(e)?(n[jS]=e[Of],iU(e)):n[jS]=e}function mx(n){return vx(n[wc])}function yx(n){return vx(n[Jn])}function vx(n){for(;n!==null&&!vr(n);)n=n[Jn];return n}var Xv;function _x(n){Xv=n}function Ff(){if(Xv!==void 0)return Xv;if(typeof document<"u")return document;throw new ne(210,!1)}var Vf=new G("",{providedIn:"root",factory:()=>oU}),oU="ng",z_=new G(""),ft=new G("",{providedIn:"platform",factory:()=>"unknown"});var W_=new G("",{providedIn:"root",factory:()=>Ff().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function aU(){let n=new Ls;return B(ft)==="browser"&&(n.store=uU(Ff(),B(Vf))),n}var Ls=(()=>{class n{constructor(){this.store={},this.onSerializeCallbacks={}}static{this.\u0275prov=te({token:n,providedIn:"root",factory:aU})}get(t,r){return this.store[t]!==void 0?this.store[t]:r}set(t,r){this.store[t]=r}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,r){this.onSerializeCallbacks[t]=r}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(r){console.warn("Exception in onSerialize callback: ",r)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function uU(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(r){console.warn("Exception while restoring TransferState for app "+e,r)}return{}}var wx="h",Ex="b",e_=function(n){return n.FirstChild="f",n.NextSibling="n",n}(e_||{}),cU="e",lU="t",K_="c",Ix="x",vf="r",dU="i",hU="n",fU="d",pU="__nghData__",Cx=pU,Av="ngh",gU="nghm",Dx=()=>null;function mU(n,e,t=!1){let r=n.getAttribute(Av);if(r==null)return null;let[i,s]=r.split("|");if(r=t?s:i,!r)return null;let o=s?`|${s}`:"",a=t?i:o,u={};if(r!==""){let d=e.get(Ls,null,{optional:!0});d!==null&&(u=d.get(Cx,[])[Number(r)])}let l={data:u,firstChild:n.firstChild??null};return t&&(l.firstChild=n,Lf(l,0,n.nextSibling)),a?n.setAttribute(Av,a):n.removeAttribute(Av),l}function yU(){Dx=mU}function Q_(n,e,t=!1){return Dx(n,e,t)}function vU(n){let e=n._lView;return e[pe].type===2?null:(NR(e)&&(e=e[qt]),e)}function _U(n){return n.textContent?.replace(/\s/gm,"")}function wU(n){let e=Ff(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(s){let o=_U(s);return o==="ngetn"||o==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=t.nextNode();)i.push(r);for(let s of i)s.textContent==="ngetn"?s.replaceWith(e.createTextNode("")):s.remove()}function Lf(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function t_(n,e){return n.segmentHeads?.[e]??null}function EU(n,e){let t=n.data,r=t[cU]?.[e]??null;return r===null&&t[K_]?.[e]&&(r=Y_(n,e)),r}function bx(n,e){return n.data[K_]?.[e]??null}function Y_(n,e){let t=bx(n,e)??[],r=0;for(let i of t)r+=i[vf]*(i[Ix]??1);return r}function jf(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[fU];n.disconnectedNodes=t?new Set(t):null}return!!n.disconnectedNodes?.has(e)}var Qh=new G(""),Tx=!1,Ax=new G("",{providedIn:"root",factory:()=>Tx}),IU=new G("");var Yh;function CU(){if(Yh===void 0&&(Yh=null,As.trustedTypes))try{Yh=As.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Yh}function US(n){return CU()?.createScriptURL(n)||n}var _f=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${sR})`}};function Lc(n){return n instanceof _f?n.changingThisBreaksApplicationSecurity:n}function Z_(n,e){let t=DU(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${sR})`)}return t===e}function DU(n){return n instanceof _f&&n.getTypeName()||null}var bU=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Sx(n){return n=String(n),n.match(bU)?n:"unsafe:"+n}var Uf=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Uf||{});function TU(n){let e=xx();return e?e.sanitize(Uf.URL,n)||"":Z_(n,"URL")?Lc(n):Sx(Mf(n))}function AU(n){let e=xx();if(e)return US(e.sanitize(Uf.RESOURCE_URL,n)||"");if(Z_(n,"ResourceURL"))return US(Lc(n));throw new ne(904,!1)}function SU(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?AU:TU}function Rx(n,e,t){return SU(e,t)(n)}function xx(){let n=Ge();return n&&n[Xn].sanitizer}var RU=/^>|^->|<!--|-->|--!>|<!-$/g,xU=/(<|>)/g,MU="\u200B$1\u200B";function NU(n){return n.replace(RU,e=>e.replace(xU,MU))}function PU(n){return n.ownerDocument.body}function Mx(n){return n instanceof Function?n():n}function Zh(n){return(n??B(Ht)).get(ft)==="browser"}var Kr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Kr||{}),kU;function J_(n,e){return kU(n,e)}function ta(n,e,t,r,i){if(r!=null){let s,o=!1;vr(r)?s=r:Gr(r)&&(o=!0,r=r[wn]);let a=er(r);n===0&&t!==null?i==null?kx(e,t,a):wf(e,t,a,i||null,!0):n===1&&t!==null?wf(e,t,a,i||null,!0):n===2?rw(e,a,o):n===3&&e.destroyNode(a),s!=null&&ZU(e,n,s,t,i)}}function X_(n,e){return n.createText(e)}function OU(n,e,t){n.setValue(e,t)}function ew(n,e){return n.createComment(NU(e))}function Bf(n,e,t){return n.createElement(e,t)}function FU(n,e){Nx(n,e),e[wn]=null,e[tr]=null}function VU(n,e,t,r,i,s){r[wn]=i,r[tr]=e,qf(n,r,t,1,i,s)}function Nx(n,e){e[Xn].changeDetectionScheduler?.notify(1),qf(n,e,e[Ye],2,null,null)}function LU(n){let e=n[wc];if(!e)return Sv(n[pe],n);for(;e;){let t=null;if(Gr(e))t=e[wc];else{let r=e[Bt];r&&(t=r)}if(!t){for(;e&&!e[Jn]&&e!==n;)Gr(e)&&Sv(e[pe],e),e=e[Mt];e===null&&(e=n),Gr(e)&&Sv(e[pe],e),t=e&&e[Jn]}e=t}}function jU(n,e,t,r){let i=Bt+r,s=t.length;r>0&&(t[i-1][Jn]=e),r<s-Bt?(e[Jn]=t[i],fR(t,Bt+r,e)):(t.push(e),e[Jn]=null),e[Mt]=t;let o=e[kf];o!==null&&t!==o&&UU(o,e);let a=e[ua];a!==null&&a.insertView(n),zv(e),e[oe]|=128}function UU(n,e){let t=n[hf],i=e[Mt][Mt][En];e[En]!==i&&(n[oe]|=k_.HasTransplantedViews),t===null?n[hf]=[e]:t.push(e)}function Px(n,e){let t=n[hf],r=t.indexOf(e);t.splice(r,1)}function Dc(n,e){if(n.length<=Bt)return;let t=Bt+e,r=n[t];if(r){let i=r[kf];i!==null&&i!==n&&Px(i,r),e>0&&(n[t-1][Jn]=r[Jn]);let s=cf(n,Bt+e);FU(r[pe],r);let o=s[ua];o!==null&&o.detachView(s[pe]),r[Mt]=null,r[Jn]=null,r[oe]&=-129}return r}function $f(n,e){if(!(e[oe]&256)){let t=e[Ye];t.destroyNode&&qf(n,e,t,3,null,null),LU(e)}}function Sv(n,e){if(e[oe]&256)return;let t=be(null);try{e[oe]&=-129,e[oe]|=256,e[Ms]&&eS(e[Ms]),$U(n,e),BU(n,e),e[pe].type===1&&e[Ye].destroy();let r=e[kf];if(r!==null&&vr(e[Mt])){r!==e[Mt]&&Px(r,e);let i=e[ua];i!==null&&i.detachView(n)}sU(e)}finally{be(t)}}function BU(n,e){let t=n.cleanup,r=e[_c];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[_c]=null);let i=e[wi];if(i!==null){e[wi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function $U(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Ps)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];gr(4,a,u);try{u.call(a)}finally{gr(5,a,u)}}else{gr(4,i,s);try{s.call(i)}finally{gr(5,i,s)}}}}}function qU(n,e,t){return HU(n,e.parent,t)}function HU(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[wn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===yr.None||s===yr.Emulated)return null}return Cn(r,t)}}function wf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function kx(n,e,t){n.appendChild(e,t)}function BS(n,e,t,r,i){r!==null?wf(n,e,t,r,i):kx(n,e,t)}function GU(n,e,t,r){n.removeChild(e,t,r)}function tw(n,e){return n.parentNode(e)}function zU(n,e){return n.nextSibling(e)}function WU(n,e,t){return QU(n,e,t)}function KU(n,e,t){return n.type&40?Cn(n,t):null}var QU=KU,$S;function nw(n,e,t,r){let i=qU(n,r,e),s=e[Ye],o=r.parent||e[tr],a=WU(o,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)BS(s,i,t[u],a,!1);else BS(s,i,t,a,!1);$S!==void 0&&$S(s,r,e,t,i)}function sf(n,e){if(e!==null){let t=e.type;if(t&3)return Cn(e,n);if(t&4)return n_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return sf(n,r);{let i=n[e.index];return vr(i)?n_(-1,i):er(i)}}else{if(t&32)return J_(e,n)()||er(n[e.index]);{let r=Ox(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Cc(n[En]);return sf(i,r)}else return sf(n,e.next)}}}return null}function Ox(n,e){if(e!==null){let r=n[En][tr],i=e.projection;return r.projection[i]}return null}function n_(n,e){let t=Bt+n+1;if(t<e.length){let r=e[t],i=r[pe].firstChild;if(i!==null)return sf(r,i)}return e[zr]}function rw(n,e,t){let r=tw(n,e);r&&GU(n,r,e,t)}function Fx(n){n.textContent=""}function iw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],u=t.type;if(o&&e===0&&(a&&ks(er(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)iw(n,e,t.child,r,i,s,!1),ta(e,n,i,a,s);else if(u&32){let l=J_(t,r),d;for(;d=l();)ta(e,n,i,d,s);ta(e,n,i,a,s)}else u&16?YU(n,e,r,t,i,s):ta(e,n,i,a,s);t=o?t.projectionNext:t.next}}function qf(n,e,t,r,i,s){iw(t,r,n.firstChild,e,i,s,!1)}function YU(n,e,t,r,i,s){let o=t[En],u=o[tr].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let d=u[l];ta(e,n,i,d,s)}else{let l=u,d=o[Mt];yf(r)&&(l.flags|=128),iw(n,e,l,d,i,s,!0)}}function ZU(n,e,t,r,i){let s=t[zr],o=er(t);s!==o&&ta(e,n,r,s,i);for(let a=Bt;a<t.length;a++){let u=t[a];qf(u[pe],u,n,e,r,s)}}function JU(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Kr.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Kr.Important),n.setStyle(t,r,i,s))}}function XU(n,e,t){n.setAttribute(e,"style",t)}function Vx(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Lx(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Bv(n,e,r),i!==null&&Vx(n,e,i),s!==null&&XU(n,e,s)}var pa={};function Ai(n=1){jx(nr(),Ge(),Vs()+n,!1)}function jx(n,e,t,r){if(!r)if((e[oe]&3)===3){let s=n.preOrderCheckHooks;s!==null&&nf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&rf(e,s,0,t)}Ns(t)}function Ne(n,e=_e.Default){let t=Ge();if(t===null)return L(n,e);let r=Bn();return ax(r,t,Zt(n),e)}function Ux(n,e,t,r,i,s){let o=be(null);try{let a=null;i&$t.SignalBased&&(a=e[r][YA]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&$t.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):PR(e,a,r,s)}finally{be(o)}}function eB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ns(~i);else{let s=i,o=t[++r],a=t[++r];x2(o,s);let u=e[s];a(2,u)}}}finally{Ns(-1)}}function Hf(n,e,t,r,i,s,o,a,u,l,d){let h=e.blueprint.slice();return h[wn]=i,h[oe]=r|4|128|8|64,(l!==null||n&&n[oe]&2048)&&(h[oe]|=2048),LR(h),h[Mt]=h[fa]=n,h[Ut]=t,h[Xn]=o||n&&n[Xn],h[Ye]=a||n&&n[Ye],h[aa]=u||n&&n[aa]||null,h[tr]=s,h[Of]=rU(),h[jn]=d,h[RR]=l,h[En]=e.type==2?n[En]:h,h}function Gf(n,e,t,r,i){let s=n.data[e];if(s===null)s=tB(n,e,t,r,i),R2()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=b2();s.injectorIndex=o===null?-1:o.injectorIndex}return Oc(s,!0),s}function tB(n,e,t,r,i){let s=qR(),o=HR(),a=o?s:s&&s.parent,u=n.data[e]=aB(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function Bx(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function $x(n,e,t,r,i){let s=Vs(),o=r&2;try{Ns(-1),o&&e.length>qt&&jx(n,e,qt,!1),gr(o?2:0,i),t(r,i)}finally{Ns(s),gr(o?3:1,i)}}function qx(n,e,t){if(MR(e)){let r=be(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let u=t[o];a.contentQueries(1,u,o)}}}finally{be(r)}}}function Hx(n,e,t){UR()&&(pB(n,e,t,Cn(t,e)),(t.flags&64)===64&&Yx(n,e,t))}function Gx(n,e,t=Cn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function zx(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=sw(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function sw(n,e,t,r,i,s,o,a,u,l,d){let h=qt+r,g=h+i,y=nB(h,g),_=typeof l=="function"?l():l;return y[pe]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:_,incompleteFirstPass:!1,ssrId:d}}function nB(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:pa);return t}function rB(n,e,t,r){let s=r.get(Ax,Tx)||t===yr.ShadowDom,o=n.selectRootElement(e,s);return iB(o),o}function iB(n){Wx(n)}var Wx=()=>null;function sB(n){px(n)?Fx(n):wU(n)}function oB(){Wx=sB}function aB(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return kc()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function qS(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=$t.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?HS(r,t,l,a,u):HS(r,t,l,a)}return r}function HS(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function uB(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],u=null,l=null;for(let d=r;d<i;d++){let h=s[d],g=t?t.get(h):null,y=g?g.inputs:null,_=g?g.outputs:null;u=qS(0,h.inputs,d,u,y),l=qS(1,h.outputs,d,l,_);let D=u!==null&&o!==null&&!x_(e)?bB(u,d,o):null;a.push(D)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function cB(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function lB(n,e,t,r,i,s,o,a){let u=Cn(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(ow(n,t,d,r,i),Pc(e)&&dB(t,e.index)):e.type&3?(r=cB(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function dB(n,e){let t=bi(e,n);t[oe]&16||(t[oe]|=64)}function Kx(n,e,t,r){if(UR()){let i=r===null?null:{"":-1},s=mB(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Qx(n,e,t,o,i,a),i&&yB(t,r,i)}t.mergedAttrs=yc(t.mergedAttrs,t.attrs)}function Qx(n,e,t,r,i,s){for(let l=0;l<r.length;l++)Qv(mf(t,e),n,r[l].type);_B(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=Bx(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=yc(t.mergedAttrs,d.hostAttrs),wB(n,t,e,u,d),vB(u,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}uB(n,t,s)}function hB(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;fB(o)!=a&&o.push(a),o.push(t,r,s)}}function fB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function pB(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;Pc(t)&&EB(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||mf(t,e),ks(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let u=n.data[a],l=ca(e,n,a,t);if(ks(l,e),o!==null&&DB(e,a-i,l,u,t,o),Ei(u)){let d=bi(t.index,e);d[Ut]=ca(e,n,a,t)}}}function Yx(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=M2();try{Ns(s);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];Wv(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&gB(u,l)}}finally{Ns(-1),Wv(o)}}function gB(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function mB(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(Bj(e,o.selectors,!1))if(r||(r=[]),Ei(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;r_(n,e,u)}else r.unshift(o),r_(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function r_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function yB(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ne(-301,!1);r.push(e[i],s)}}}function vB(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Ei(e)&&(t[""]=n)}}function _B(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function wB(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=ia(i.type,!0)),o=new Ps(s,Ei(i),Ne);n.blueprint[r]=o,t[r]=o,hB(n,e,r,Bx(n,t,i.hostVars,pa),i)}function EB(n,e,t){let r=Cn(e,n),i=zx(t),s=n[Xn].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=zf(n,Hf(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function IB(n,e,t,r,i,s){let o=Cn(n,e);CB(e[Ye],o,s,n.value,t,r,i)}function CB(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?Mf(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function DB(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],l=o[a++],d=o[a++],h=o[a++];Ux(r,t,u,l,d,h)}}function bB(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function Zx(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Jx(n,e){let t=n.contentQueries;if(t!==null){let r=be(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];GR(s),a.contentQueries(2,e[o],o)}}}finally{be(r)}}}function zf(n,e){return n[wc]?n[NS][Jn]=e:n[wc]=e,n[NS]=e,e}function i_(n,e,t){GR(0);let r=be(null);try{e(n,t)}finally{be(r)}}function TB(n){return n[_c]||(n[_c]=[])}function AB(n){return n.cleanup||(n.cleanup=[])}function Xx(n,e){let t=n[aa],r=t?t.get(Wr,null):null;r&&r.handleError(e)}function ow(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],u=t[s++],l=e[o],d=n.data[o];Ux(d,l,r,a,u,i)}}function SB(n,e,t){let r=VR(e,n);OU(n[Ye],r,t)}function RB(n,e){let t=bi(e,n),r=t[pe];xB(r,t);let i=t[wn];i!==null&&t[jn]===null&&(t[jn]=Q_(i,t[aa])),aw(r,t,t[Ut])}function xB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function aw(n,e,t){j_(e);try{let r=n.viewQuery;r!==null&&i_(1,r,t);let i=n.template;i!==null&&$x(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ua]?.finishViewCreation(n),n.staticContentQueries&&Jx(n,e),n.staticViewQueries&&i_(2,n.viewQuery,t);let s=n.components;s!==null&&MB(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[oe]&=-5,U_()}}function MB(n,e){for(let t=0;t<e.length;t++)RB(n,e[t])}function uw(n,e,t,r){let i=be(null);try{let s=e.tView,a=n[oe]&4096?4096:16,u=Hf(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[kf]=l;let d=n[ua];return d!==null&&(u[ua]=d.createEmbeddedView(s)),aw(s,u,t),u}finally{be(i)}}function eM(n,e){let t=Bt+e;if(t<n.length)return n[t]}function bc(n,e){return!e||e.firstChild===null||yf(n)}function Wf(n,e,t,r=!0){let i=e[pe];if(jU(i,e,n,t),r){let o=n_(t,n),a=e[Ye],u=tw(a,n[zr]);u!==null&&VU(i,n[tr],a,e,u,o)}let s=e[jn];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function tM(n,e){let t=Dc(n,e);return t!==void 0&&$f(t[pe],t),t}function Ef(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(er(s)),vr(s)&&NB(s,r);let o=t.type;if(o&8)Ef(n,e,t.child,r);else if(o&32){let a=J_(t,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=Ox(e,t);if(Array.isArray(a))r.push(...a);else{let u=Cc(e[En]);Ef(u[pe],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function NB(n,e){for(let t=Bt;t<n.length;t++){let r=n[t],i=r[pe].firstChild;i!==null&&Ef(r[pe],r,i,e)}n[zr]!==n[wn]&&e.push(n[zr])}var nM=[];function PB(n){return n[Ms]??kB(n)}function kB(n){let e=nM.pop()??Object.create(FB);return e.lView=n,e}function OB(n){n.lView[Ms]!==n&&(n.lView=null,nM.push(n))}var FB=xe(z({},ZA),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Ic(n.lView)},consumerOnSignalRead(){this.lView[Ms]=this}}),rM=100;function iM(n,e=!0,t=0){let r=n[Xn],i=r.rendererFactory,s=!1;s||i.begin?.();try{VB(n,t)}catch(o){throw e&&Xx(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function VB(n,e){s_(n,e);let t=0;for(;L_(n);){if(t===rM)throw new ne(103,!1);t++,s_(n,1)}}function LB(n,e,t,r){let i=e[oe];if((i&256)===256)return;let s=!1;!s&&e[Xn].inlineEffectRunner?.flush(),j_(e);let o=null,a=null;!s&&jB(n)&&(a=PB(e),o=JA(a));try{LR(e),A2(n.bindingStartIndex),t!==null&&$x(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let h=n.preOrderCheckHooks;h!==null&&nf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&rf(e,h,0,null),Cv(e,0)}if(UB(e),sM(e,0),n.contentQueries!==null&&Jx(n,e),!s)if(u){let h=n.contentCheckHooks;h!==null&&nf(e,h)}else{let h=n.contentHooks;h!==null&&rf(e,h,1),Cv(e,1)}eB(n,e);let l=n.components;l!==null&&aM(e,l,0);let d=n.viewQuery;if(d!==null&&i_(2,d,r),!s)if(u){let h=n.viewCheckHooks;h!==null&&nf(e,h)}else{let h=n.viewHooks;h!==null&&rf(e,h,2),Cv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Iv]){for(let h of e[Iv])h();e[Iv]=null}s||(e[oe]&=-73)}catch(u){throw Ic(e),u}finally{a!==null&&(XA(a,o),OB(a)),U_()}}function jB(n){return n.type!==2}function sM(n,e){for(let t=mx(n);t!==null;t=yx(t))for(let r=Bt;r<t.length;r++){let i=t[r];oM(i,e)}}function UB(n){for(let e=mx(n);e!==null;e=yx(e)){if(!(e[oe]&k_.HasTransplantedViews))continue;let t=e[hf];for(let r=0;r<t.length;r++){let i=t[r],s=i[Mt];m2(i)}}}function BB(n,e,t){let r=bi(e,n);oM(r,t)}function oM(n,e){V_(n)&&s_(n,e)}function s_(n,e){let r=n[pe],i=n[oe],s=n[Ms],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Jy(s)),s&&(s.dirty=!1),n[oe]&=-9217,o)LB(r,n,r.template,n[Ut]);else if(i&8192){sM(n,1);let a=r.components;a!==null&&aM(n,a,1)}}function aM(n,e,t){for(let r=0;r<e.length;r++)BB(n,e[r],t)}function cw(n){for(n[Xn].changeDetectionScheduler?.notify();n;){n[oe]|=64;let e=Cc(n);if(NR(n)&&!e)return n;n=e}return null}var la=class{get rootNodes(){let e=this._lView,t=e[pe];return Ef(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ut]}set context(e){this._lView[Ut]=e}get destroyed(){return(this._lView[oe]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mt];if(vr(e)){let t=e[df],r=t?t.indexOf(this):-1;r>-1&&(Dc(e,r),cf(t,r))}this._attachedToViewContainer=!1}$f(this._lView[pe],this._lView)}onDestroy(e){jR(this._lView,e)}markForCheck(){cw(this._cdRefInjectingView||this._lView)}detach(){this._lView[oe]&=-129}reattach(){zv(this._lView),this._lView[oe]|=128}detectChanges(){this._lView[oe]|=1024,iM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,Nx(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ne(902,!1);this._appRef=e,zv(this._lView)}};function uM(n){let e=n[Ec]??[],r=n[Mt][Ye];for(let i of e)$B(i,r);n[Ec]=_n}function $B(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[vf];for(;t<i;){let s=r.nextSibling;rw(e,r,!1),r=s,t++}}}function cM(n){uM(n);for(let e=Bt;e<n.length;e++)If(n[e])}function qB(n){let e=n[jn]?.i18nNodes;if(e){let t=n[Ye];for(let r of e.values())rw(t,r,!1);n[jn].i18nNodes=void 0}}function If(n){qB(n);let e=n[pe];for(let t=qt;t<e.bindingStartIndex;t++)if(vr(n[t])){let r=n[t];cM(r)}else Gr(n[t])&&If(n[t])}function HB(n){let e=n._views;for(let t of e){let r=vU(t);if(r!==null&&r[wn]!==null)if(Gr(r))If(r);else{let i=r[wn];If(i),cM(r)}}}var GB=new RegExp(`^(\\d+)*(${Ex}|${wx})*(.*)`);function zB(n){let e=n.match(GB),[t,r,i,s]=e,o=r?parseInt(r,10):i,a=[];for(let[u,l,d]of s.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(l,h)}return[o,...a]}function WB(n){return!n.prev&&n.parent?.type===8}function Rv(n){return n.index-qt}function KB(n,e){let t=n.i18nNodes;if(t){let r=t.get(e);return r&&t.delete(e),r}return null}function Kf(n,e,t,r){let i=Rv(r),s=KB(n,i);if(!s){let o=n.data[hU];if(o?.[i])s=YB(o[i],t);else if(e.firstChild===r)s=n.firstChild;else{let a=r.prev===null,u=r.prev??r.parent;if(WB(r)){let l=Rv(r.parent);s=t_(n,l)}else{let l=Cn(u,t);if(a)s=l.firstChild;else{let d=Rv(u),h=t_(n,d);if(u.type===2&&h){let y=Y_(n,d)+1;s=Qf(y,h)}else s=l.nextSibling}}}}return s}function Qf(n,e){let t=e;for(let r=0;r<n;r++)t=t.nextSibling;return t}function QB(n,e){let t=n;for(let r=0;r<e.length;r+=2){let i=e[r],s=e[r+1];for(let o=0;o<s;o++)switch(i){case e_.FirstChild:t=t.firstChild;break;case e_.NextSibling:t=t.nextSibling;break}}return t}function YB(n,e){let[t,...r]=zB(n),i;if(t===wx)i=e[En][wn];else if(t===Ex)i=PU(e[En][wn]);else{let s=Number(t);i=er(e[s+qt])}return QB(i,r)}function ZB(n,e){let t=[];for(let r of e)for(let i=0;i<(r[Ix]??1);i++){let s={data:r,firstChild:null};r[vf]>0&&(s.firstChild=n,n=Qf(r[vf],n)),t.push(s)}return[n,t]}var lM=()=>null;function JB(n,e){let t=n[Ec];return!e||t===null||t.length===0?null:t[0].data[dU]===e?t.shift():(uM(n),null)}function XB(){lM=JB}function Tc(n,e){return lM(n,e)}var o_=class{},a_=class{},Cf=class{};function e$(n){let e=Error(`No component factory found for ${hn(n)}.`);return e[t$]=n,e}var t$="ngComponent";var u_=class{resolveComponentFactory(e){throw e$(e)}},Yf=(()=>{class n{static{this.NULL=new u_}}return n})(),Ac=class{},js=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>n$()}}return n})();function n$(){let n=Ge(),e=Bn(),t=bi(e.index,n);return(Gr(t)?t:n)[Ye]}var r$=(()=>{class n{static{this.\u0275prov=te({token:n,providedIn:"root",factory:()=>null})}}return n})(),xv={};var GS=new Set;function Us(n){GS.has(n)||(GS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function zS(...n){}function i$(){let n=typeof As.requestAnimationFrame=="function",e=As[n?"requestAnimationFrame":"setTimeout"],t=As[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var me=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new jt(!1),this.onMicrotaskEmpty=new jt(!1),this.onStable=new jt(!1),this.onError=new jt(!1),typeof Zone>"u")throw new ne(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=i$().nativeRequestAnimationFrame,a$(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ne(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ne(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,s$,zS,zS);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},s$={};function lw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function o$(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(As,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,c_(n),n.isCheckStableRunning=!0,lw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),c_(n))}function a$(n){let e=()=>{o$(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(u$(a))return t.invokeTask(i,s,o,a);try{return WS(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),KS(n)}},onInvoke:(t,r,i,s,o,a,u)=>{try{return WS(n),t.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),KS(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,c_(n),lw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function c_(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function WS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function KS(n){n._nesting--,lw(n)}function u$(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}var dM=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of t)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}}return n})();function l_(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=IS(i,a);else if(s==2){let u=a,l=e[++o];r=IS(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Df=class extends Yf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=xs(e);return new Sc(t,this.ngModule)}};function QS(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function c$(n){let e=n.toLowerCase();return e==="svg"?d2:e==="math"?h2:null}var d_=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Nf(r);let i=this.injector.get(e,xv,r);return i!==xv||t===xv?i:this.parentInjector.get(e,t,r)}},Sc=class extends Cf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=QS(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return QS(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Gj(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=be(null);try{i=i||this.ngModule;let o=i instanceof Ln?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new d_(e,o):e,u=a.get(Ac,null);if(u===null)throw new ne(407,!1);let l=a.get(r$,null),d=a.get(dM,null),h=a.get(o_,null),g={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},y=u.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",D=r?rB(y,r,this.componentDef.encapsulation,a):Bf(y,_,c$(_)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let P=null;D!==null&&(P=Q_(D,a,!0));let U=sw(0,null,null,1,0,null,null,null,null,null,null),F=Hf(null,U,null,A,null,null,g,y,a,null,P);j_(F);let Q,re;try{let X=this.componentDef,I,v=null;X.findHostDirectiveDefs?(I=[],v=new Map,X.findHostDirectiveDefs(X,I,v),I.push(X)):I=[X];let E=l$(F,D),C=d$(E,D,X,I,F,g,y);re=F_(U,qt),D&&p$(y,X,D,r),t!==void 0&&g$(re,this.ngContentSelectors,t),Q=f$(C,X,I,v,F,[m$]),aw(U,F,null)}finally{U_()}return new h_(this.componentType,Q,G_(re,F),F,re)}finally{be(s)}}},h_=class extends a_{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new la(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;ow(s[pe],s,i,e,t),this.previousInputValues.set(e,t);let o=bi(this._tNode.index,s);cw(o)}}get injector(){return new Ss(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function l$(n,e){let t=n[pe],r=qt;return n[r]=e,Gf(t,r,2,"#host",null)}function d$(n,e,t,r,i,s,o){let a=i[pe];h$(r,n,e,o);let u=null;e!==null&&(u=Q_(e,i[aa]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Hf(i,zx(t),null,d,i[n.index],n,s,l,null,null,u);return a.firstCreatePass&&r_(a,n,r.length-1),zf(i,h),i[n.index]=h}function h$(n,e,t,r){for(let i of n)e.mergedAttrs=yc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(l_(e,e.mergedAttrs,!0),t!==null&&Lx(r,t,e))}function f$(n,e,t,r,i,s){let o=Bn(),a=i[pe],u=Cn(o,i);Qx(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,g=ca(i,a,h,o);ks(g,i)}Yx(a,i,o),u&&ks(u,i);let l=ca(i,a,o.directiveStart+o.componentOffset,o);if(n[Ut]=i[Ut]=l,s!==null)for(let d of s)d(l,e);return qx(a,o,i),l}function p$(n,e,t,r){if(r)Bv(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=zj(e.selectors[0]);i&&Bv(n,t,i),s&&s.length>0&&Vx(n,t,s.join(" "))}}function g$(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function m$(){let n=Bn();$_(Ge()[pe],n)}var Zf=(()=>{class n{static{this.__NG_ELEMENT_ID__=y$}}return n})();function y$(){let n=Bn();return _$(n,Ge())}var v$=Zf,hM=class extends v${constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return G_(this._hostTNode,this._hostLView)}get injector(){return new Ss(this._hostTNode,this._hostLView)}get parentInjector(){let e=q_(this._hostTNode,this._hostLView);if(tx(e)){let t=gf(e,this._hostLView),r=pf(e),i=t[pe].data[r+8];return new Ss(i,t)}else return new Ss(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=YS(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Bt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Tc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,bc(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!a2(e),a;if(o)a=t;else{let _=t||{};a=_.index,r=_.injector,i=_.projectableNodes,s=_.environmentInjector||_.ngModuleRef}let u=o?e:new Sc(xs(e)),l=r||this.parentInjector;if(!s&&u.ngModule==null){let D=(o?l:this.parentInjector).get(Ln,null);D&&(s=D)}let d=xs(u.componentType??{}),h=Tc(this._lContainer,d?.id??null),g=h?.firstChild??null,y=u.create(l,i,g,s);return this.insertImpl(y.hostView,a,bc(this._hostTNode,h)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(g2(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Mt],l=new hM(u,u[tr],u[Mt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Wf(o,i,s,r),e.attachToViewContainerRef(),fR(Mv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=YS(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Dc(this._lContainer,t);r&&(cf(Mv(this._lContainer),t),$f(r[pe],r))}detach(e){let t=this._adjustIndex(e,-1),r=Dc(this._lContainer,t);return r&&cf(Mv(this._lContainer),t)!=null?new la(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function YS(n){return n[df]}function Mv(n){return n[df]||(n[df]=[])}function _$(n,e){let t,r=e[n.index];return vr(r)?t=r:(t=Zx(r,e,null,n),e[n.index]=t,zf(e,t)),fM(t,e,n,r),new hM(t,n,e)}function w$(n,e){let t=n[Ye],r=t.createComment(""),i=Cn(e,n),s=tw(t,i);return wf(t,s,r,zU(t,i),!1),r}var fM=pM,dw=()=>!1;function E$(n,e,t){return dw(n,e,t)}function pM(n,e,t,r){if(n[zr])return;let i;t.type&8?i=er(r):i=w$(e,t),n[zr]=i}function I$(n,e,t){if(n[zr]&&n[Ec])return!0;let r=t[jn],i=e.index-qt;if(!r||tU(e)||jf(r,i))return!1;let o=t_(r,i),a=r.data[K_]?.[i],[u,l]=ZB(o,a);return n[zr]=u,n[Ec]=l,!0}function C$(n,e,t,r){dw(n,t,e)||pM(n,e,t,r)}function D$(){fM=C$,dw=I$}function b$(n){return Object.getPrototypeOf(n.prototype).constructor}function Si(n){let e=b$(n.type),t=!0,r=[n];for(;e;){let i;if(Ei(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ne(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=Jh(n.inputs),o.inputTransforms=Jh(n.inputTransforms),o.declaredInputs=Jh(n.declaredInputs),o.outputs=Jh(n.outputs);let a=i.hostBindings;a&&x$(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&S$(n,u),l&&R$(n,l),T$(n,i),hj(n.outputs,i.outputs),Ei(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Si&&(t=!1)}}e=Object.getPrototypeOf(e)}A$(r)}function T$(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function A$(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=yc(i.hostAttrs,t=yc(t,i.hostAttrs))}}function Jh(n){return n===sa?{}:n===_n?[]:n}function S$(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function R$(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function x$(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function hw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Ii=class{},Rc=class{};var f_=class extends Ii{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Df(this);let i=IR(e);this._bootstrapComponents=Mx(i.bootstrap),this._r3Injector=lx(e,t,[{provide:Ii,useValue:this},{provide:Yf,useValue:this.componentFactoryResolver},...r],hn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},p_=class extends Rc{constructor(e){super(),this.moduleType=e}create(e){return new f_(this.moduleType,e,[])}};var bf=class extends Ii{constructor(e){super(),this.componentFactoryResolver=new Df(this),this.instance=null;let t=new vc([...e.providers,{provide:Ii,useValue:this},{provide:Yf,useValue:this.componentFactoryResolver}],e.parent||P_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function fw(n,e,t=null){return new bf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var jc=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Rt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ga(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Uc(n){return(n.flags&32)===32}function M$(n,e,t,r,i,s,o,a,u){let l=e.consts,d=Gf(e,n,4,o||null,ff(l,a));Kx(e,t,d,ff(l,u)),$_(e,d);let h=d.tView=sw(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function Os(n,e,t,r,i,s,o,a){let u=Ge(),l=nr(),d=n+qt,h=l.firstCreatePass?M$(d,l,u,e,t,r,i,s,o):l.data[d];Oc(h,!1);let g=gM(l,u,h,n);B_()&&nw(l,u,g,h),ks(g,u);let y=Zx(g,u,g,h);return u[d]=y,zf(u,y),E$(y,h,u),O_(h)&&Hx(l,u,h),o!=null&&Gx(u,h,a),Os}var gM=mM;function mM(n,e,t,r){return _r(!0),e[Ye].createComment("")}function N$(n,e,t,r){let i=e[jn],s=!i||kc()||Uc(t)||jf(i,r);if(_r(s),s)return mM(n,e,t,r);let o=i.data[lU]?.[r]??null;o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o);let a=Kf(i,n,e,t);Lf(i,r,a);let u=Y_(i,r);return Qf(u,a)}function P$(){gM=N$}function Jf(n,e,t,r){let i=Ge(),s=Fc();if(ga(i,s,e)){let o=nr(),a=ZR();IB(a,i,n,e,t,r)}return Jf}function k$(n,e,t,r){return ga(n,Fc(),t)?e+Mf(t)+r:pa}function Xh(n,e){return n<<17|e<<2}function Fs(n){return n>>17&32767}function O$(n){return(n&2)==2}function F$(n,e){return n&131071|e<<17}function g_(n){return n|2}function da(n){return(n&131068)>>2}function Nv(n,e){return n&-131069|e<<2}function V$(n){return(n&1)===1}function m_(n){return n|1}function L$(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Fs(o),u=da(o);n[r]=t;let l=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Nc(h,d)>0)&&(l=!0)}else d=t;if(i)if(u!==0){let g=Fs(n[a+1]);n[r+1]=Xh(g,a),g!==0&&(n[g+1]=Nv(n[g+1],r)),n[a+1]=F$(n[a+1],r)}else n[r+1]=Xh(a,0),a!==0&&(n[a+1]=Nv(n[a+1],r)),a=r;else n[r+1]=Xh(u,0),a===0?a=r:n[u+1]=Nv(n[u+1],r),u=r;l&&(n[r+1]=g_(n[r+1])),ZS(n,d,r,!0),ZS(n,d,r,!1),j$(e,d,n,r,s),o=Xh(a,u),s?e.classBindings=o:e.styleBindings=o}function j$(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&Nc(s,e)>=0&&(t[r+1]=m_(t[r+1]))}function ZS(n,e,t,r){let i=n[t+1],s=e===null,o=r?Fs(i):da(i),a=!1;for(;o!==0&&(a===!1||s);){let u=n[o],l=n[o+1];U$(u,e)&&(a=!0,n[o+1]=r?m_(l):g_(l)),o=r?Fs(l):da(l)}a&&(n[t+1]=r?g_(i):m_(i))}function U$(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Nc(n,e)>=0:!1}function pw(n,e,t){let r=Ge(),i=Fc();if(ga(r,i,e)){let s=nr(),o=ZR();lB(s,o,r,n,e,r[Ye],t,!1)}return pw}function JS(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";ow(n,t,s[o],o,r)}function Xf(n,e){return B$(n,e,null,!0),Xf}function B$(n,e,t,r){let i=Ge(),s=nr(),o=S2(2);if(s.firstUpdatePass&&q$(s,n,o,r),e!==pa&&ga(i,o,e)){let a=s.data[Vs()];K$(s,a,i,i[Ye],n,i[o+1]=Q$(e,t),r,o)}}function $$(n,e){return e>=n.expandoStartIndex}function q$(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Vs()],o=$$(n,t);Y$(s,r)&&e===null&&!o&&(e=!1),e=H$(i,s,e,r),L$(i,s,e,t,o,r)}}function H$(n,e,t,r){let i=N2(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Pv(null,n,e,t,r),t=xc(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=Pv(i,n,e,t,r),s===null){let u=G$(n,e,r);u!==void 0&&Array.isArray(u)&&(u=Pv(null,n,e,u[1],r),u=xc(u,e.attrs,r),z$(n,e,r,u))}else s=W$(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function G$(n,e,t){let r=t?e.classBindings:e.styleBindings;if(da(r)!==0)return n[Fs(r)]}function z$(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Fs(i)]=r}function W$(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=xc(r,o,t)}return xc(r,e.attrs,t)}function Pv(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=xc(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function xc(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Pj(n,o,t?!0:e[++s]))}return n===void 0?null:n}function K$(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],d=V$(l)?XS(u,e,t,i,da(l),o):void 0;if(!Tf(d)){Tf(s)||O$(l)&&(s=XS(u,null,t,i,a,o));let h=VR(Vs(),t);JU(r,o,h,i,s)}}function XS(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),d=l?u[1]:u,h=d===null,g=t[i+1];g===pa&&(g=h?_n:void 0);let y=h?wv(g,r):d===r?g:void 0;if(l&&!Tf(y)&&(y=wv(u,r)),Tf(y)&&(a=y,o))return a;let _=n[i+1];i=o?Fs(_):da(_)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=wv(u,r))}return a}function Tf(n){return n!==void 0}function Q$(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=hn(Lc(n)))),n}function Y$(n,e){return(n.flags&(e?8:16))!==0}var y_=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function kv(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function Z$(n,e,t){let r,i,s=0,o=n.length-1;if(Array.isArray(e)){let a=e.length-1;for(;s<=o&&s<=a;){let u=n.at(s),l=e[s],d=kv(s,u,s,l,t);if(d!==0){d<0&&n.updateValue(s,l),s++;continue}let h=n.at(o),g=e[a],y=kv(o,h,a,g,t);if(y!==0){y<0&&n.updateValue(o,g),o--,a--;continue}let _=t(s,u),D=t(o,h),A=t(s,l);if(Object.is(A,D)){let P=t(a,g);Object.is(P,_)?(n.swap(s,o),n.updateValue(o,g),a--,o--):n.move(o,s),n.updateValue(s,l),s++;continue}if(r??=new Af,i??=tR(n,s,o,t),v_(n,r,s,A))n.updateValue(s,l),s++,o++;else if(i.has(A))r.set(_,n.detach(s)),o--;else{let P=n.create(s,e[s]);n.attach(s,P),s++,o++}}for(;s<=a;)eR(n,r,t,s,e[s]),s++}else if(e!=null){let a=e[Symbol.iterator](),u=a.next();for(;!u.done&&s<=o;){let l=n.at(s),d=u.value,h=kv(s,l,s,d,t);if(h!==0)h<0&&n.updateValue(s,d),s++,u=a.next();else{r??=new Af,i??=tR(n,s,o,t);let g=t(s,d);if(v_(n,r,s,g))n.updateValue(s,d),s++,o++,u=a.next();else if(!i.has(g))n.attach(s,n.create(s,d)),s++,o++,u=a.next();else{let y=t(s,l);r.set(y,n.detach(s)),o--}}}for(;!u.done;)eR(n,r,t,n.length,u.value),u=a.next()}for(;s<=o;)n.destroy(n.detach(o--));r?.forEach(a=>{n.destroy(a)})}function v_(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function eR(n,e,t,r,i){if(v_(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function tR(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var Af=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function ep(n,e,t){Us("NgControlFlow");let r=Ge(),i=Fc(),s=I_(r,qt+n),o=0;if(ga(r,i,e)){let a=be(null);try{if(tM(s,o),e!==-1){let u=C_(r[pe],qt+e),l=Tc(s,u.tView.ssrId),d=uw(r,u,t,{dehydratedView:l});Wf(s,d,o,bc(u,l))}}finally{be(a)}}else{let a=eM(s,o);a!==void 0&&(a[Ut]=t)}}var __=class{constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-Bt}};function yM(n){return n}var w_=class{constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function vM(n,e,t,r,i,s,o,a,u,l,d,h,g){Us("NgControlFlow");let y=u!==void 0,_=Ge(),D=a?o.bind(_[En][Ut]):o,A=new w_(y,D);_[qt+n]=A,Os(n+1,e,t,r,i,s),y&&Os(n+2,u,l,d,h,g)}var E_=class extends y_{constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Bt}at(e){return this.getLView(e)[Ut].$implicit}attach(e,t){let r=t[jn];this.needsIndexUpdate||=e!==this.length,Wf(this.lContainer,t,e,bc(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,J$(this.lContainer,e)}create(e,t){let r=Tc(this.lContainer,this.templateTNode.tView.ssrId);return uw(this.hostLView,this.templateTNode,new __(this.lContainer,t,e),{dehydratedView:r})}destroy(e){$f(e[pe],e)}updateValue(e,t){this.getLView(e)[Ut].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ut].$index=e}getLView(e){return X$(this.lContainer,e)}};function _M(n){let e=be(null),t=Vs();try{let r=Ge(),i=r[pe],s=r[t];if(s.liveCollection===void 0){let a=t+1,u=I_(r,a),l=C_(i,a);s.liveCollection=new E_(u,r,l)}else s.liveCollection.reset();let o=s.liveCollection;if(Z$(o,n,s.trackByFn),o.updateIndexes(),s.hasEmptyBlock){let a=Fc(),u=o.length===0;if(ga(r,a,u)){let l=t+2,d=I_(r,l);if(u){let h=C_(i,l),g=Tc(d,h.tView.ssrId),y=uw(r,h,void 0,{dehydratedView:g});Wf(d,y,0,bc(h,g))}else tM(d,0)}}}finally{be(e)}}function I_(n,e){return n[e]}function J$(n,e){return Dc(n,e)}function X$(n,e){return eM(n,e)}function C_(n,e){return F_(n,e)}function e4(n,e,t,r,i,s){let o=e.consts,a=ff(o,i),u=Gf(e,n,2,r,a);return Kx(e,t,u,ff(o,s)),u.attrs!==null&&l_(u,u.attrs,!1),u.mergedAttrs!==null&&l_(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function H(n,e,t,r){let i=Ge(),s=nr(),o=qt+n,a=i[Ye],u=s.firstCreatePass?e4(o,s,i,e,t,r):s.data[o],l=wM(s,i,u,a,e,n);i[o]=l;let d=O_(u);return Oc(u,!0),Lx(a,l,u),!Uc(u)&&B_()&&nw(s,i,l,u),_2()===0&&ks(l,i),w2(),d&&(Hx(s,i,u),qx(s,u,i)),r!==null&&Gx(i,u),H}function Y(){let n=Bn();HR()?T2():(n=n.parent,Oc(n,!1));let e=n;I2(e)&&D2(),E2();let t=nr();return t.firstCreatePass&&($_(t,n),MR(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&L2(e)&&JS(t,e,Ge(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&j2(e)&&JS(t,e,Ge(),e.stylesWithoutHost,!1),Y}function Ce(n,e,t,r){return H(n,e,t,r),Y(),Ce}var wM=(n,e,t,r,i,s)=>(_r(!0),Bf(r,i,JR()));function t4(n,e,t,r,i,s){let o=e[jn],a=!o||kc()||Uc(t)||jf(o,s);if(_r(a),a)return Bf(r,i,JR());let u=Kf(o,n,e,t);return bx(o,s)&&Lf(o,s,u.nextSibling),o&&(fx(t)||px(u))&&Pc(t)&&(C2(t),Fx(u)),u}function n4(){wM=t4}var r4=(n,e,t,r)=>(_r(!0),ew(e[Ye],""));function i4(n,e,t,r){let i,s=e[jn],o=!s||kc()||Uc(t);if(_r(o),o)return ew(e[Ye],"");let a=Kf(s,n,e,t),u=EU(s,r);return Lf(s,r,a),i=Qf(u,a),i}function s4(){r4=i4}function EM(){return Ge()}var Sf="en-US";var o4=Sf;function a4(n){typeof n=="string"&&(o4=n.toLowerCase().replace(/_/g,"-"))}function IM(n,e,t){let r=n[Ye];switch(t){case Node.COMMENT_NODE:return ew(r,e);case Node.TEXT_NODE:return X_(r,e);case Node.ELEMENT_NODE:return Bf(r,e,null)}}var u4=(n,e,t,r)=>(_r(!0),IM(n,t,r));function c4(n,e,t,r){return _r(!0),IM(n,t,r)}function l4(){u4=c4}function wr(n,e,t,r){let i=Ge(),s=nr(),o=Bn();return h4(s,i,i[Ye],o,n,e,r),wr}function d4(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[_c],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function h4(n,e,t,r,i,s,o){let a=O_(r),l=n.firstCreatePass&&AB(n),d=e[Ut],h=TB(e),g=!0;if(r.type&3||o){let D=Cn(r,e),A=o?o(D):D,P=h.length,U=o?Q=>o(er(Q[r.index])):r.index,F=null;if(!o&&a&&(F=d4(n,e,i,r.index)),F!==null){let Q=F.__ngLastListenerFn__||F;Q.__ngNextListenerFn__=s,F.__ngLastListenerFn__=s,g=!1}else{s=rR(r,e,d,s,!1);let Q=t.listen(A,i,s);h.push(s,Q),l&&l.push(i,U,P,P+1)}}else s=rR(r,e,d,s,!1);let y=r.outputs,_;if(g&&y!==null&&(_=y[i])){let D=_.length;if(D)for(let A=0;A<D;A+=2){let P=_[A],U=_[A+1],re=e[P][U].subscribe(s),X=h.length;h.push(s,re),l&&l.push(i,r.index,X,-(X+1))}}}function nR(n,e,t,r){let i=be(null);try{return gr(6,e,t),t(r)!==!1}catch(s){return Xx(n,s),!1}finally{gr(7,e,t),be(i)}}function rR(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?bi(n.index,e):e;cw(a);let u=nR(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)u=nR(e,t,l,o)&&u,l=l.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function CM(n=1){return k2(n)}function se(n,e=""){let t=Ge(),r=nr(),i=n+qt,s=r.firstCreatePass?Gf(r,i,1,e,null):r.data[i],o=DM(r,t,s,e,n);t[i]=o,B_()&&nw(r,t,o,s),Oc(s,!1)}var DM=(n,e,t,r,i)=>(_r(!0),X_(e[Ye],r));function f4(n,e,t,r,i){let s=e[jn],o=!s||kc()||Uc(t)||jf(s,i);return _r(o),o?X_(e[Ye],r):Kf(s,n,e,t)}function p4(){DM=f4}function gw(n){return tp("",n,""),gw}function tp(n,e,t){let r=Ge(),i=k$(r,n,e,t);return i!==pa&&SB(r,Vs(),i),tp}function g4(n,e,t){let r=nr();if(r.firstCreatePass){let i=Ei(n);D_(t,r.data,r.blueprint,i,!0),D_(e,r.data,r.blueprint,i,!1)}}function D_(n,e,t,r,i){if(n=Zt(n),Array.isArray(n))for(let s=0;s<n.length;s++)D_(n[s],e,t,r,i);else{let s=nr(),o=Ge(),a=Bn(),u=oa(n)?n:Zt(n.provide),l=SR(n),d=a.providerIndexes&1048575,h=a.directiveStart,g=a.providerIndexes>>20;if(oa(n)||!n.multi){let y=new Ps(l,i,Ne),_=Fv(u,e,i?d:d+g,h);_===-1?(Qv(mf(a,o),s,u),Ov(s,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),o.push(y)):(t[_]=y,o[_]=y)}else{let y=Fv(u,e,d+g,h),_=Fv(u,e,d,d+g),D=y>=0&&t[y],A=_>=0&&t[_];if(i&&!A||!i&&!D){Qv(mf(a,o),s,u);let P=v4(i?y4:m4,t.length,i,r,l);!i&&A&&(t[_].providerFactory=P),Ov(s,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(P),o.push(P)}else{let P=bM(t[i?_:y],l,!i&&r);Ov(s,n,y>-1?y:_,P)}!i&&r&&A&&t[_].componentProviders++}}}function Ov(n,e,t,r){let i=oa(e),s=Xj(e);if(i||s){let u=(s?Zt(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function bM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Fv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function m4(n,e,t,r){return b_(this.multi,[])}function y4(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ca(t,t[pe],this.providerFactory.index,r);s=a.slice(0,o),b_(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],b_(i,s);return s}function b_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function v4(n,e,t,r,i){let s=new Ps(n,t,Ne);return s.multi=[],s.index=e,s.componentProviders=0,bM(s,i,r&&!t),s}function np(n,e=[]){return t=>{t.providersResolver=(r,i)=>g4(r,i?i(n):n,e)}}var _4=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=bR(!1,t.type),i=r.length>0?fw([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=te({token:n,providedIn:"environment",factory:()=>new n(L(Ln))})}}return n})();function $n(n){Us("NgStandalone"),n.getStandaloneInjector=e=>e.get(_4).getOrCreateStandaloneInjector(n)}var Qr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},rp=new Qr("17.3.12"),ip=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var TM=new G("");function Bs(n){return!!n&&typeof n.then=="function"}function AM(n){return!!n&&typeof n.subscribe=="function"}var SM=new G(""),RM=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=B(SM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(Bs(s))t.push(s);else if(AM(s)){let o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ma=new G("");function w4(){tS(()=>{throw new ne(600,!1)})}function E4(n){return n.isBoundToModule}function I4(n,e,t){try{let r=t();return Bs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Ri=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=B(dx),this.afterRenderEffectManager=B(dM),this.externalTestViews=new Set,this.beforeRender=new tt,this.afterTick=new tt,this.componentTypes=[],this.components=[],this.isStable=B(jc).hasPendingTasks.pipe(Z(t=>!t)),this._injector=B(Ln)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Cf;if(!this._injector.get(RM).done){let g=!i&&ER(t),y=!1;throw new ne(405,y)}let o;i?o=t:o=this._injector.get(Yf).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=E4(o)?void 0:this._injector.get(Ii),u=r||o.selector,l=o.create(Ht.NULL,[],u,a),d=l.location.nativeElement,h=l.injector.get(TM,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Vv(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new ne(101,!1);let r=be(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(i){this.internalErrorHandler(i)}finally{this.afterTick.next(),this._runningTick=!1,be(r)}}detectChangesInAttachedViews(t){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===rM)throw new ne(103,!1);if(t){let s=r===0;this.beforeRender.next(s);for(let{_lView:o,notifyErrorHandler:a}of this._views)C4(o,s,a)}if(r++,i.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>T_(s))&&(i.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>T_(s))))break}}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Vv(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(ma,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Vv(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ne(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Vv(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var ef;function mw(n){ef??=new WeakMap;let e=ef.get(n);if(e)return e;let t=n.isStable.pipe(vn(r=>r)).toPromise().then(()=>{});return ef.set(n,t),n.onDestroy(()=>ef?.delete(n)),t}function C4(n,e,t){!e&&!T_(n)||D4(n,t,e)}function T_(n){return L_(n)}function D4(n,e,t){let r;t?(r=0,n[oe]|=1024):n[oe]&64?r=0:r=1,iM(n,e,r)}var A_=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},yw=(()=>{class n{compileModuleSync(t){return new p_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=IR(t),s=Mx(i.declarations).reduce((o,a)=>{let u=xs(a);return u&&o.push(new Sc(u)),o},[]);return new A_(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var b4=(()=>{class n{constructor(){this.zone=B(me),this.applicationRef=B(Ri)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function T4(n){return[{provide:me,useFactory:n},{provide:Rs,multi:!0,useFactory:()=>{let e=B(b4,{optional:!0});return()=>e.initialize()}},{provide:Rs,multi:!0,useFactory:()=>{let e=B(x4);return()=>{e.initialize()}}},{provide:dx,useFactory:A4}]}function A4(){let n=B(me),e=B(Wr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function S4(n){let e=T4(()=>new me(R4(n)));return en([[],e])}function R4(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var x4=(()=>{class n{constructor(){this.subscription=new st,this.initialized=!1,this.zone=B(me),this.pendingTasks=B(jc)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{me.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{me.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function M4(){return typeof $localize<"u"&&$localize.locale||Sf}var vw=new G("",{providedIn:"root",factory:()=>B(vw,_e.Optional|_e.SkipSelf)||M4()});var xM=new G("");var of=null;function N4(n=[],e){return Ht.create({name:e,providers:[{provide:Pf,useValue:"platform"},{provide:xM,useValue:new Set([()=>of=null])},...n]})}function P4(n=[]){if(of)return of;let e=N4(n);return of=e,w4(),k4(e),e}function k4(n){n.get(z_,null)?.forEach(t=>t())}function _w(){return!1}var ya=(()=>{class n{static{this.__NG_ELEMENT_ID__=O4}}return n})();function O4(n){return F4(Bn(),Ge(),(n&16)===16)}function F4(n,e,t){if(Pc(n)&&!t){let r=bi(n.index,e);return new la(r,r)}else if(n.type&47){let r=e[En];return new la(r,e)}return null}function MM(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=P4(r),s=[S4(),...t||[]],a=new bf({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(me);return u.run(()=>{a.resolveInjectorInitializers();let l=a.get(Wr,null),d;u.runOutsideAngular(()=>{d=u.onError.subscribe({next:y=>{l.handleError(y)}})});let h=()=>a.destroy(),g=i.get(xM);return g.add(h),a.onDestroy(()=>{d.unsubscribe(),g.delete(h)}),I4(l,u,()=>{let y=a.get(RM);return y.runInitializers(),y.donePromise.then(()=>{let _=a.get(vw,Sf);a4(_||Sf);let D=a.get(Ri);return e!==void 0&&D.bootstrap(e),D})})})}catch(e){return Promise.reject(e)}}var iR=!1,V4=!1;function L4(){iR||(iR=!0,yU(),n4(),p4(),s4(),P$(),D$(),XB(),oB(),l4())}function j4(n,e){return mw(n)}function NM(){return en([{provide:Qh,useFactory:()=>{let n=!0;return Zh()&&(n=!!B(Ls,{optional:!0})?.get(Cx,null)),n&&Us("NgHydration"),n}},{provide:Rs,useValue:()=>{V4=!!B(IU,{optional:!0}),Zh()&&B(Qh)&&(U4(),L4())},multi:!0},{provide:Ax,useFactory:()=>Zh()&&B(Qh)},{provide:ma,useFactory:()=>{if(Zh()&&B(Qh)){let n=B(Ri),e=B(Ht);return()=>{j4(n,e).then(()=>{HB(n)})}}return()=>{}},multi:!0}])}function U4(){let n=Ff(),e;for(let t of n.body.childNodes)if(t.nodeType===Node.COMMENT_NODE&&t.textContent?.trim()===gU){e=t;break}if(!e)throw new ne(-507,!1)}function va(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var OM=null;function Yr(){return OM}function FM(n){OM??=n}var sp=class{};var Dn=new G(""),VM=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(B4),providedIn:"platform"})}}return n})();var B4=(()=>{class n extends VM{constructor(){super(),this._doc=B(Dn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Yr().getBaseHref(this._doc)}onPopState(t){let r=Yr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Yr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function LM(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function PM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function $s(n){return n&&n[0]!=="?"?"?"+n:n}var _a=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(jM),providedIn:"root"})}}return n})(),$4=new G(""),jM=(()=>{class n extends _a{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??B(Dn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return LM(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+$s(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+$s(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+$s(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(L(VM),L($4,8))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Bc=(()=>{class n{constructor(t){this._subject=new jt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=G4(PM(kM(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+$s(r))}normalize(t){return n.stripTrailingSlash(H4(this._basePath,kM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$s(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$s(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=$s}static{this.joinWithSlash=LM}static{this.stripTrailingSlash=PM}static{this.\u0275fac=function(r){return new(r||n)(L(_a))}}static{this.\u0275prov=te({token:n,factory:()=>q4(),providedIn:"root"})}}return n})();function q4(){return new Bc(L(_a))}function H4(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function kM(n){return n.replace(/\/index.html$/,"")}function G4(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function ww(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var $c=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Xt({type:n})}static{this.\u0275inj=Jt({})}}return n})(),UM="browser",z4="server";function Zr(n){return n===z4}var op=class{};var up=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var KM=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(KM||{}),Ew=class{constructor(e,t=QM.Ok,r="OK"){this.headers=e.headers||new up,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var cp=class n extends Ew{constructor(e={}){super(e),this.type=KM.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};var QM=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(QM||{});var Q4=new G("");var BM="b",$M="h",qM="s",HM="st",GM="u",zM="rt",ap=new G(""),Y4=["GET","HEAD"];function Z4(n,e){let h=B(ap),{isCacheActive:t}=h,r=kA(h,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!Y4.includes(s)||i===!1||r.filter?.(n)===!1)return e(n);let o=B(Ls),a=X4(n),u=o.get(a,null),l=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(l=i.includeHeaders),u){let{[BM]:g,[zM]:y,[$M]:_,[qM]:D,[HM]:A,[GM]:P}=u,U=g;switch(y){case"arraybuffer":U=new TextEncoder().encode(g).buffer;break;case"blob":U=new Blob([g]);break}let F=new up(_);return ee(new cp({body:U,headers:F,status:D,statusText:A,url:P}))}let d=Zr(B(ft));return e(n).pipe(ot(g=>{g instanceof cp&&d&&o.set(a,{[BM]:g.body,[$M]:J4(g.headers,l),[qM]:g.status,[HM]:g.statusText,[GM]:g.url||"",[zM]:n.responseType})}))}function J4(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function WM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function X4(n){let{params:e,method:t,responseType:r,url:i}=n,s=WM(e),o=n.serializeBody();o instanceof URLSearchParams?o=WM(o):typeof o!="string"&&(o="");let a=[t,r,i,o,s].join("|"),u=eq(a);return u}function eq(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function YM(n){return[{provide:ap,useFactory:()=>(Us("NgHttpTransferCache"),z({isCacheActive:!0},n))},{provide:Q4,useValue:Z4,multi:!0,deps:[Ls,ap]},{provide:ma,multi:!0,useFactory:()=>{let e=B(Ri),t=B(ap);return()=>{mw(e).then(()=>{t.isCacheActive=!1})}}}]}var Dw=class extends sp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},bw=class n extends Dw{static makeCurrent(){FM(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=tq();return t==null?null:nq(t)}resetBaseElement(){qc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ww(document.cookie,e)}},qc=null;function tq(){return qc=qc||document.querySelector("base"),qc?qc.getAttribute("href"):null}function nq(n){return new URL(n,document.baseURI).pathname}var rq=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})(),Tw=new G(""),eN=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ne(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(L(Tw),L(me))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})(),lp=class{constructor(e){this._doc=e}},Iw="ng-app-id",tN=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Zr(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Iw}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(Iw),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(Iw,this.appId),t.appendChild(o),o}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(L(Dn),L(Vf),L(W_,8),L(ft))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})(),Cw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Rw=/%COMP%/g,nN="%COMP%",iq=`_nghost-${nN}`,sq=`_ngcontent-${nN}`,oq=!0,aq=new G("",{providedIn:"root",factory:()=>oq});function uq(n){return sq.replace(Rw,n)}function cq(n){return iq.replace(Rw,n)}function rN(n,e){return e.map(t=>t.replace(Rw,n))}var ZM=(()=>{class n{constructor(t,r,i,s,o,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Zr(a),this.defaultRenderer=new Hc(t,o,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===yr.ShadowDom&&(r=xe(z({},r),{encapsulation:yr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof dp?i.applyToHost(t):i instanceof Gc&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case yr.Emulated:s=new dp(u,l,r,this.appId,d,o,a,h);break;case yr.ShadowDom:return new Aw(u,l,t,r,o,a,this.nonce,h);default:s=new Gc(u,l,r,d,o,a,h);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(L(eN),L(tN),L(Vf),L(aq),L(Dn),L(ft),L(me),L(W_))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})(),Hc=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Cw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(JM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(JM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ne(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Cw[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Cw[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Kr.DashCase|Kr.Important)?e.style.setProperty(t,r,i&Kr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Kr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Yr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function JM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Aw=class extends Hc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=rN(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Gc=class extends Hc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?rN(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},dp=class extends Gc{constructor(e,t,r,i,s,o,a,u){let l=i+"-"+r.id;super(e,t,r,s,o,a,u,l),this.contentAttr=uq(l),this.hostAttr=cq(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},lq=(()=>{class n extends lp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(L(Dn))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})(),XM=["alt","control","meta","shift"],dq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hq={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},fq=(()=>{class n extends lp{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Yr().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),XM.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=dq[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),XM.forEach(o=>{if(o!==i){let a=hq[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(L(Dn))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac})}}return n})();function iN(n,e){return MM(z({rootComponent:n},pq(e)))}function pq(n){return{appProviders:[..._q,...n?.providers??[]],platformProviders:vq}}function gq(){bw.makeCurrent()}function mq(){return new Wr}function yq(){return _x(document),document}var vq=[{provide:ft,useValue:UM},{provide:z_,useValue:gq,multi:!0},{provide:Dn,useFactory:yq,deps:[]}];var _q=[{provide:Pf,useValue:"root"},{provide:Wr,useFactory:mq,deps:[]},{provide:Tw,useClass:lq,multi:!0,deps:[Dn,me,ft]},{provide:Tw,useClass:fq,multi:!0,deps:[Dn]},ZM,tN,eN,{provide:Ac,useExisting:ZM},{provide:op,useClass:rq,deps:[]},[]];var sN=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(L(Dn))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Sw=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n}(Sw||{});function oN(...n){let e=[],t=new Set,r=t.has(Sw.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);return en([[],NM(),t.has(Sw.NoHttpTransferCache)||r?[]:YM({}),e])}var ge="primary",ol=Symbol("RouteTitle"),kw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Da(n){return new kw(n)}function Eq(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Iq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Er(n[t],e[t]))return!1;return!0}function Er(n,e){let t=n?Ow(n):void 0,r=e?Ow(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!hN(n[i],e[i]))return!1;return!0}function Ow(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function hN(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function fN(n){return n.length>0?n[n.length-1]:null}function Pi(n){return hv(n)?n:Bs(n)?Me(Promise.resolve(n)):ee(n)}var Cq={exact:gN,subset:mN},pN={exact:Dq,subset:bq,ignored:()=>!0};function aN(n,e,t){return Cq[t.paths](n.root,e.root,t.matrixParams)&&pN[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Dq(n,e){return Er(n,e)}function gN(n,e,t){if(!Hs(n.segments,e.segments)||!pp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!gN(n.children[r],e.children[r],t))return!1;return!0}function bq(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>hN(n[t],e[t]))}function mN(n,e,t){return yN(n,e,e.segments,t)}function yN(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Hs(i,t)||e.hasChildren()||!pp(i,t,r))}else if(n.segments.length===t.length){if(!Hs(n.segments,t)||!pp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!mN(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Hs(n.segments,i)||!pp(n.segments,i,r)||!n.children[ge]?!1:yN(n.children[ge],e,s,r)}}function pp(n,e,t){return e.every((r,i)=>pN[t](n[i].parameters,r.parameters))}var xi=class{constructor(e=new Oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Da(this.queryParams),this._queryParamMap}toString(){return Sq.serialize(this)}},Oe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return gp(this)}},qs=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Da(this.parameters),this._parameterMap}toString(){return _N(this)}};function Tq(n,e){return Hs(n,e)&&n.every((t,r)=>Er(t.parameters,e[r].parameters))}function Hs(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Aq(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ge&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ge&&(t=t.concat(e(i,r)))}),t}var aE=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>new yp,providedIn:"root"})}}return n})(),yp=class{parse(e){let t=new Vw(e);return new xi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${zc(e.root,!0)}`,r=Mq(e.queryParams),i=typeof e.fragment=="string"?`#${Rq(e.fragment)}`:"";return`${t}${r}${i}`}},Sq=new yp;function gp(n){return n.segments.map(e=>_N(e)).join("/")}function zc(n,e){if(!n.hasChildren())return gp(n);if(e){let t=n.children[ge]?zc(n.children[ge],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==ge&&r.push(`${i}:${zc(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Aq(n,(r,i)=>i===ge?[zc(n.children[ge],!1)]:[`${i}:${zc(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ge]!=null?`${gp(n)}/${t[0]}`:`${gp(n)}/(${t.join("//")})`}}function vN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function hp(n){return vN(n).replace(/%3B/gi,";")}function Rq(n){return encodeURI(n)}function Fw(n){return vN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function mp(n){return decodeURIComponent(n)}function uN(n){return mp(n.replace(/\+/g,"%20"))}function _N(n){return`${Fw(n.path)}${xq(n.parameters)}`}function xq(n){return Object.entries(n).map(([e,t])=>`;${Fw(e)}=${Fw(t)}`).join("")}function Mq(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${hp(t)}=${hp(i)}`).join("&"):`${hp(t)}=${hp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Nq=/^[^\/()?;#]+/;function xw(n){let e=n.match(Nq);return e?e[0]:""}var Pq=/^[^\/()?;=#]+/;function kq(n){let e=n.match(Pq);return e?e[0]:""}var Oq=/^[^=?&#]+/;function Fq(n){let e=n.match(Oq);return e?e[0]:""}var Vq=/^[^&#]+/;function Lq(n){let e=n.match(Vq);return e?e[0]:""}var Vw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ge]=new Oe(e,t)),r}parseSegment(){let e=xw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ne(4009,!1);return this.capture(e),new qs(mp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=kq(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=xw(this.remaining);i&&(r=i,this.capture(r))}e[mp(t)]=mp(r)}parseQueryParam(e){let t=Fq(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=Lq(this.remaining);o&&(r=o,this.capture(r))}let i=uN(t),s=uN(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=xw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ne(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ge);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[ge]:new Oe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ne(4011,!1)}};function wN(n){return n.segments.length>0?new Oe([],{[ge]:n}):n}function EN(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=EN(i);if(r===ge&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Oe(n.segments,e);return jq(t)}function jq(n){if(n.numberOfChildren===1&&n.children[ge]){let e=n.children[ge];return new Oe(n.segments.concat(e.segments),e.children)}return n}function ba(n){return n instanceof xi}function Uq(n,e,t=null,r=null){let i=IN(n);return CN(i,e,t,r)}function IN(n){let e;function t(s){let o={};for(let u of s.children){let l=t(u);o[u.outlet]=l}let a=new Oe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=wN(r);return e??i}function CN(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Mw(i,i,i,t,r);let s=Bq(e);if(s.toRoot())return Mw(i,i,new Oe([],{}),t,r);let o=$q(s,i,n),a=o.processChildren?Qc(o.segmentGroup,o.index,s.commands):bN(o.segmentGroup,o.index,s.commands);return Mw(i,o.segmentGroup,a,t,r)}function vp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Jc(n){return typeof n=="object"&&n!=null&&n.outlets}function Mw(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=DN(n,e,t);let a=wN(EN(o));return new xi(a,s,i)}function DN(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=DN(s,e,t)}),new Oe(n.segments,r)}var _p=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&vp(r[0]))throw new ne(4003,!1);let i=r.find(Jc);if(i&&i!==fN(r))throw new ne(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Bq(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new _p(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new _p(t,e,r)}var Ia=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function $q(n,e,t){if(n.isAbsolute)return new Ia(e,!0,0);if(!t)return new Ia(e,!1,NaN);if(t.parent===null)return new Ia(t,!0,0);let r=vp(n.commands[0])?0:1,i=t.segments.length-1+r;return qq(t,i,n.numberOfDoubleDots)}function qq(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ne(4005,!1);i=r.segments.length}return new Ia(r,!1,i-s)}function Hq(n){return Jc(n[0])?n[0].outlets:{[ge]:n}}function bN(n,e,t){if(n??=new Oe([],{}),n.segments.length===0&&n.hasChildren())return Qc(n,e,t);let r=Gq(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Oe(n.segments.slice(0,r.pathIndex),{});return s.children[ge]=new Oe(n.segments.slice(r.pathIndex),n.children),Qc(s,0,i)}else return r.match&&i.length===0?new Oe(n.segments,{}):r.match&&!n.hasChildren()?Lw(n,e,t):r.match?Qc(n,0,i):Lw(n,e,t)}function Qc(n,e,t){if(t.length===0)return new Oe(n.segments,{});{let r=Hq(t),i={};if(Object.keys(r).some(s=>s!==ge)&&n.children[ge]&&n.numberOfChildren===1&&n.children[ge].segments.length===0){let s=Qc(n.children[ge],e,t);return new Oe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=bN(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Oe(n.segments,i)}}function Gq(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Jc(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!lN(u,l,o))return s;r+=2}else{if(!lN(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Lw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Jc(s)){let u=zq(s.outlets);return new Oe(r,u)}if(i===0&&vp(t[0])){let u=n.segments[e];r.push(new qs(u.path,cN(t[0]))),i++;continue}let o=Jc(s)?s.outlets[ge]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&vp(a)?(r.push(new qs(o,cN(a))),i+=2):(r.push(new qs(o,{})),i++)}return new Oe(r,{})}function zq(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Lw(new Oe([],{}),0,r))}),e}function cN(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function lN(n,e,t){return n==t.path&&Er(e,t.parameters)}var Yc="imperative",Nt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Nt||{}),qn=class{constructor(e,t){this.id=e,this.url=t}},Xc=class extends qn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Nt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Mi=class extends qn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Nt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Tn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Tn||{}),jw=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(jw||{}),Ni=class extends qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Nt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Gs=class extends qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Nt.NavigationSkipped}},el=class extends qn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Nt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},wp=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Nt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Uw=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Nt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bw=class extends qn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Nt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},$w=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Nt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qw=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Nt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hw=class{constructor(e){this.route=e,this.type=Nt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Gw=class{constructor(e){this.route=e,this.type=Nt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},zw=class{constructor(e){this.snapshot=e,this.type=Nt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ww=class{constructor(e){this.snapshot=e,this.type=Nt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kw=class{constructor(e){this.snapshot=e,this.type=Nt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qw=class{constructor(e){this.snapshot=e,this.type=Nt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var tl=class{},nl=class{constructor(e){this.url=e}};var Yw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Tp,this.attachRef=null}},Tp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Yw,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ep=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Zw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Zw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Jw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Jw(e,this._root).map(t=>t.value)}};function Zw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Zw(n,t);if(r)return r}return null}function Jw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Jw(n,t);if(r.length)return r.unshift(e),r}return[]}var bn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ea(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ip=class extends Ep{constructor(e,t){super(e),this.snapshot=t,cE(this,e)}toString(){return this.snapshot.toString()}};function TN(n){let e=Wq(n),t=new Rt([new qs("",{})]),r=new Rt({}),i=new Rt({}),s=new Rt({}),o=new Rt(""),a=new zs(t,r,s,o,i,ge,n,e.root);return a.snapshot=e.root,new Ip(new bn(a,[]),e)}function Wq(n){let e={},t={},r={},i="",s=new rl([],e,r,i,t,ge,n,null,{});return new Cp("",new bn(s,[]))}var zs=class{constructor(e,t,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Z(l=>l[ol]))??ee(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>Da(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>Da(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function uE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:z(z({},e.params),n.params),data:z(z({},e.data),n.data),resolve:z(z(z(z({},n.data),e.data),i?.data),n._resolvedData)}:r={params:z({},n.params),data:z({},n.data),resolve:z(z({},n.data),n._resolvedData??{})},i&&SN(i)&&(r.resolve[ol]=i.title),r}var rl=class{get title(){return this.data?.[ol]}constructor(e,t,r,i,s,o,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Da(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Da(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Cp=class extends Ep{constructor(e,t){super(t),this.url=e,cE(this,t)}toString(){return AN(this._root)}};function cE(n,e){e.value._routerState=n,e.children.forEach(t=>cE(n,t))}function AN(n){let e=n.children.length>0?` { ${n.children.map(AN).join(", ")} } `:"";return`${n.value}${e}`}function Nw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Er(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Er(e.params,t.params)||n.paramsSubject.next(t.params),Iq(e.url,t.url)||n.urlSubject.next(t.url),Er(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Xw(n,e){let t=Er(n.params,e.params)&&Tq(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Xw(n.parent,e.parent))}function SN(n){return typeof n.title=="string"||n.title===null}var al=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=ge,this.activateEvents=new jt,this.deactivateEvents=new jt,this.attachEvents=new jt,this.detachEvents=new jt,this.parentContexts=B(Tp),this.location=B(Zf),this.changeDetector=B(ya),this.environmentInjector=B(Ln),this.inputBinder=B(lE,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ne(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ne(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ne(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ne(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new eE(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=In({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Di]})}}return n})(),eE=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===zs?this.route:e===Tp?this.childContexts:this.parent.get(e,t)}},lE=new G("");function Kq(n,e,t){let r=il(n,e._root,t?t._root:void 0);return new Ip(r,e)}function il(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Qq(n,e,t);return new bn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>il(n,a)),o}}let r=Yq(e.value),i=e.children.map(s=>il(n,s));return new bn(r,i)}}function Qq(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return il(n,r,i);return il(n,r)})}function Yq(n){return new zs(new Rt(n.url),new Rt(n.params),new Rt(n.queryParams),new Rt(n.fragment),new Rt(n.data),n.outlet,n.component,n)}var RN="ngNavigationCancelingError";function xN(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ba(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=MN(!1,Tn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function MN(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[RN]=!0,t.cancellationCode=e,t}function Zq(n){return NN(n)&&ba(n.url)}function NN(n){return!!n&&n[RN]}var Jq=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["ng-component"]],standalone:!0,features:[$n],decls:1,vars:0,template:function(r,i){r&1&&Ce(0,"router-outlet")},dependencies:[al],encapsulation:2})}}return n})();function Xq(n,e){return n.providers&&!n._injector&&(n._injector=fw(n.providers,e,`Route: ${n.path}`)),n._injector??e}function dE(n){let e=n.children&&n.children.map(dE),t=e?xe(z({},n),{children:e}):z({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ge&&(t.component=Jq),t}function Ir(n){return n.outlet||ge}function eH(n,e){let t=n.filter(r=>Ir(r)===e);return t.push(...n.filter(r=>Ir(r)!==e)),t}function ul(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var tH=(n,e,t,r)=>Z(i=>(new tE(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),tE=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Nw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ea(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ea(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ea(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ea(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Qw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Ww(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Nw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Nw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=ul(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Dp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ca=class{constructor(e,t){this.component=e,this.route=t}};function nH(n,e,t){let r=n._root,i=e?e._root:null;return Wc(r,i,t,[r.value])}function rH(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Aa(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!aR(n)?n:e.get(n):r}function Wc(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ea(e);return n.children.forEach(o=>{iH(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Zc(a,t.getContext(o),i)),i}function iH(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=sH(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Dp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Wc(n,e,a?a.children:null,r,i):Wc(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ca(a.outlet.component,o))}else o&&Zc(e,a,i),i.canActivateChecks.push(new Dp(r)),s.component?Wc(n,null,a?a.children:null,r,i):Wc(n,null,t,r,i);return i}function sH(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Hs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Hs(n.url,e.url)||!Er(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xw(n,e)||!Er(n.queryParams,e.queryParams);case"paramsChange":default:return!Xw(n,e)}}function Zc(n,e,t){let r=Ea(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Zc(o,e.children.getContext(s),t):Zc(o,null,t):Zc(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ca(e.outlet.component,i)):t.canDeactivateChecks.push(new Ca(null,i)):t.canDeactivateChecks.push(new Ca(null,i))}function cl(n){return typeof n=="function"}function oH(n){return typeof n=="boolean"}function aH(n){return n&&cl(n.canLoad)}function uH(n){return n&&cl(n.canActivate)}function cH(n){return n&&cl(n.canActivateChild)}function lH(n){return n&&cl(n.canDeactivate)}function dH(n){return n&&cl(n.canMatch)}function PN(n){return n instanceof qr||n?.name==="EmptyError"}var fp=Symbol("INITIAL_VALUE");function Ta(){return We(n=>qh(n.map(e=>e.pipe(Hr(1),Ts(fp)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===fp)return fp;if(t===!1||t instanceof xi)return t}return!0}),xt(e=>e!==fp),Hr(1)))}function hH(n,e){return wt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ee(xe(z({},t),{guardsResult:!0})):fH(o,r,i,n).pipe(wt(a=>a&&oH(a)?pH(r,s,n,e):ee(a)),Z(a=>xe(z({},t),{guardsResult:a})))})}function fH(n,e,t,r){return Me(n).pipe(wt(i=>_H(i.component,i.route,t,e,r)),vn(i=>i!==!0,!0))}function pH(n,e,t,r){return Me(e).pipe(bs(i=>Qo(mH(i.route.parent,r),gH(i.route,r),vH(n,i.path,t),yH(n,i.route,t))),vn(i=>i!==!0,!0))}function gH(n,e){return n!==null&&e&&e(new Kw(n)),ee(!0)}function mH(n,e){return n!==null&&e&&e(new zw(n)),ee(!0)}function yH(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ee(!0);let i=r.map(s=>Hh(()=>{let o=ul(e)??t,a=Aa(s,o),u=uH(a)?a.canActivate(e,n):Ci(o,()=>a(e,n));return Pi(u).pipe(vn())}));return ee(i).pipe(Ta())}function vH(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>rH(o)).filter(o=>o!==null).map(o=>Hh(()=>{let a=o.guards.map(u=>{let l=ul(o.node)??t,d=Aa(u,l),h=cH(d)?d.canActivateChild(r,n):Ci(l,()=>d(r,n));return Pi(h).pipe(vn())});return ee(a).pipe(Ta())}));return ee(s).pipe(Ta())}function _H(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ee(!0);let o=s.map(a=>{let u=ul(e)??i,l=Aa(a,u),d=lH(l)?l.canDeactivate(n,e,t,r):Ci(u,()=>l(n,e,t,r));return Pi(d).pipe(vn())});return ee(o).pipe(Ta())}function wH(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ee(!0);let s=i.map(o=>{let a=Aa(o,n),u=aH(a)?a.canLoad(e,t):Ci(n,()=>a(e,t));return Pi(u)});return ee(s).pipe(Ta(),kN(r))}function kN(n){return ov(ot(e=>{if(ba(e))throw xN(n,e)}),Z(e=>e===!0))}function EH(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ee(!0);let s=i.map(o=>{let a=Aa(o,n),u=dH(a)?a.canMatch(e,t):Ci(n,()=>a(e,t));return Pi(u)});return ee(s).pipe(Ta(),kN(r))}var sl=class{constructor(e){this.segmentGroup=e||null}},bp=class extends Error{constructor(e){super(),this.urlTree=e}};function wa(n){return Ko(new sl(n))}function IH(n){return Ko(new ne(4e3,!1))}function CH(n){return Ko(MN(!1,Tn.GuardRejected))}var nE=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ee(r);if(i.numberOfChildren>1||!i.children[ge])return IH(e.redirectTo);i=i.children[ge]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new bp(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new xi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Oe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ne(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},rE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function DH(n,e,t,r,i){let s=hE(n,e,t);return s.matched?(r=Xq(e,r),EH(r,e,t,i).pipe(Z(o=>o===!0?s:z({},rE)))):ee(s)}function hE(n,e,t){if(e.path==="**")return bH(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?z({},rE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Eq)(t,n,e);if(!i)return z({},rE);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?z(z({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function bH(n){return{matched:!0,parameters:n.length>0?fN(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function dN(n,e,t,r){return t.length>0&&SH(n,t,r)?{segmentGroup:new Oe(e,AH(r,new Oe(t,n.children))),slicedSegments:[]}:t.length===0&&RH(n,t,r)?{segmentGroup:new Oe(n.segments,TH(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Oe(n.segments,n.children),slicedSegments:t}}function TH(n,e,t,r){let i={};for(let s of t)if(Ap(n,e,s)&&!r[Ir(s)]){let o=new Oe([],{});i[Ir(s)]=o}return z(z({},r),i)}function AH(n,e){let t={};t[ge]=e;for(let r of n)if(r.path===""&&Ir(r)!==ge){let i=new Oe([],{});t[Ir(r)]=i}return t}function SH(n,e,t){return t.some(r=>Ap(n,e,r)&&Ir(r)!==ge)}function RH(n,e,t){return t.some(r=>Ap(n,e,r))}function Ap(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function xH(n,e,t,r){return Ir(n)!==r&&(r===ge||!Ap(e,t,n))?!1:hE(e,n,t).matched}function MH(n,e,t){return e.length===0&&!n.children[t]}var iE=class{};function NH(n,e,t,r,i,s,o="emptyOnly"){return new sE(n,e,t,r,i,o,s).recognize()}var PH=31,sE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new nE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ne(4002,`'${e.segmentGroup}'`)}recognize(){let e=dN(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(t=>{let r=new rl([],Object.freeze({}),Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,{},ge,this.rootComponentType,null,{}),i=new bn(r,t),s=new Cp("",i),o=Uq(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ge).pipe(yi(r=>{if(r instanceof bp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof sl?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=uE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Z(s=>s instanceof bn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Me(i).pipe(bs(s=>{let o=r.children[s],a=eH(t,s);return this.processSegmentGroup(e,a,o,s)}),pr((s,o)=>(s.push(...o),s)),vi(null),gv(),wt(s=>{if(s===null)return wa(r);let o=ON(s);return kH(o),ee(o)}))}processSegment(e,t,r,i,s,o){return Me(t).pipe(bs(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(yi(u=>{if(u instanceof sl)return ee(null);throw u}))),vn(a=>!!a),yi(a=>{if(PN(a))return MH(r,i,s)?ee(new iE):wa(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return xH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):wa(i):wa(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:d}=hE(t,i,s);if(!a)return wa(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>PH&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(wt(g=>this.processSegment(e,r,t,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=DH(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(We(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(We(({routes:u})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:g}=a,y=new rl(d,g,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,FH(r),Ir(r),r.component??r._loadedComponent??null,r,VH(r)),{segmentGroup:_,slicedSegments:D}=dN(t,d,h,u);if(D.length===0&&_.hasChildren())return this.processChildren(l,u,_).pipe(Z(P=>P===null?null:new bn(y,P)));if(u.length===0&&D.length===0)return ee(new bn(y,[]));let A=Ir(r)===s;return this.processSegment(l,u,_,D,A?ge:s,!0).pipe(Z(P=>new bn(y,P instanceof bn?[P]:[])))}))):wa(t)))}getChildConfig(e,t,r){return t.children?ee({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ee({routes:t._loadedRoutes,injector:t._loadedInjector}):wH(e,t,r,this.urlSerializer).pipe(wt(i=>i?this.configLoader.loadChildren(e,t).pipe(ot(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):CH(t))):ee({routes:[],injector:e})}};function kH(n){n.sort((e,t)=>e.value.outlet===ge?-1:t.value.outlet===ge?1:e.value.outlet.localeCompare(t.value.outlet))}function OH(n){let e=n.value.routeConfig;return e&&e.path===""}function ON(n){let e=[],t=new Set;for(let r of n){if(!OH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=ON(r.children);e.push(new bn(r.value,i))}return e.filter(r=>!t.has(r))}function FH(n){return n.data||{}}function VH(n){return n.resolve||{}}function LH(n,e,t,r,i,s){return wt(o=>NH(n,e,t,r,o.extractedUrl,i,s).pipe(Z(({state:a,tree:u})=>xe(z({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function jH(n,e){return wt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ee(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let l of FN(u))o.add(l);let a=0;return Me(o).pipe(bs(u=>s.has(u)?UH(u,r,n,e):(u.data=uE(u,u.parent,n).resolve,ee(void 0))),ot(()=>a++),Jo(1),wt(u=>a===o.size?ee(t):Yt))})}function FN(n){let e=n.children.map(t=>FN(t)).flat();return[n,...e]}function UH(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!SN(i)&&(s[ol]=i.title),BH(s,n,e,r).pipe(Z(o=>(n._resolvedData=o,n.data=uE(n,n.parent,t).resolve,null)))}function BH(n,e,t,r){let i=Ow(n);if(i.length===0)return ee({});let s={};return Me(i).pipe(wt(o=>$H(n[o],e,t,r).pipe(vn(),ot(a=>{s[o]=a}))),Jo(1),pv(s),yi(o=>PN(o)?Yt:Ko(o)))}function $H(n,e,t,r){let i=ul(e)??r,s=Aa(n,i),o=s.resolve?s.resolve(e,t):Ci(i,()=>s(e,t));return Pi(o)}function Pw(n){return We(e=>{let t=n(e);return t?Me(t).pipe(Z(()=>e)):ee(e)})}var VN=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===ge);return r}getResolvedTitleForRoute(t){return t.data[ol]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(qH),providedIn:"root"})}}return n})(),qH=(()=>{class n extends VN{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(L(sN))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),fE=new G("",{providedIn:"root",factory:()=>({})}),pE=new G(""),HH=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=B(yw)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ee(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Pi(t.loadComponent()).pipe(Z(LN),ot(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Zo(()=>{this.componentLoaders.delete(t)})),i=new qo(r,()=>new tt).pipe($o());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ee({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=GH(r,this.compiler,t,this.onLoadEndListener).pipe(Zo(()=>{this.childrenLoaders.delete(r)})),o=new qo(s,()=>new tt).pipe($o());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function GH(n,e,t,r){return Pi(n.loadChildren()).pipe(Z(LN),wt(i=>i instanceof Rc||Array.isArray(i)?ee(i):Me(e.compileModuleAsync(i))),Z(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(pE,[],{optional:!0,self:!0}).flat()),{routes:o.map(dE),injector:s}}))}function zH(n){return n&&typeof n=="object"&&"default"in n}function LN(n){return zH(n)?n.default:n}var gE=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(WH),providedIn:"root"})}}return n})(),WH=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),KH=new G("");var QH=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new tt,this.transitionAbortSubject=new tt,this.configLoader=B(HH),this.environmentInjector=B(Ln),this.urlSerializer=B(aE),this.rootContexts=B(Tp),this.location=B(Bc),this.inputBindingEnabled=B(lE,{optional:!0})!==null,this.titleStrategy=B(VN),this.options=B(fE,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=B(gE),this.createViewTransition=B(KH,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ee(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Hw(i)),r=i=>this.events.next(new Gw(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(xe(z(z({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Rt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Yc,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(xt(s=>s.id!==0),Z(s=>xe(z({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),We(s=>{let o=!1,a=!1;return ee(s).pipe(We(u=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Tn.SupersededByNewNavigation),Yt;this.currentTransition=s,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?xe(z({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Gs(u.id,this.urlSerializer.serialize(u.rawUrl),h,jw.IgnoredSameUrlNavigation)),u.resolve(null),Yt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return ee(u).pipe(We(h=>{let g=this.transitions?.getValue();return this.events.next(new Xc(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),g!==this.transitions?.getValue()?Yt:Promise.resolve(h)}),LH(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ot(h=>{s.targetSnapshot=h.targetSnapshot,s.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=xe(z({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let g=new wp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:g,source:y,restoredState:_,extras:D}=u,A=new Xc(h,this.urlSerializer.serialize(g),y,_);this.events.next(A);let P=TN(this.rootComponentType).snapshot;return this.currentTransition=s=xe(z({},u),{targetSnapshot:P,urlAfterRedirects:g,extras:xe(z({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,ee(s)}else{let h="";return this.events.next(new Gs(u.id,this.urlSerializer.serialize(u.extractedUrl),h,jw.IgnoredByUrlHandlingStrategy)),u.resolve(null),Yt}}),ot(u=>{let l=new Uw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),Z(u=>(this.currentTransition=s=xe(z({},u),{guards:nH(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),s)),hH(this.environmentInjector,u=>this.events.next(u)),ot(u=>{if(s.guardsResult=u.guardsResult,ba(u.guardsResult))throw xN(this.urlSerializer,u.guardsResult);let l=new Bw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),xt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Tn.GuardRejected),!1)),Pw(u=>{if(u.guards.canActivateChecks.length)return ee(u).pipe(ot(l=>{let d=new $w(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),We(l=>{let d=!1;return ee(l).pipe(jH(this.paramsInheritanceStrategy,this.environmentInjector),ot({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Tn.NoDataFromResolver)}}))}),ot(l=>{let d=new qw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Pw(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ot(g=>{d.component=g}),Z(()=>{})));for(let g of d.children)h.push(...l(g));return h};return qh(l(u.targetSnapshot.root)).pipe(vi(null),Hr(1))}),Pw(()=>this.afterPreactivation()),We(()=>{let{currentSnapshot:u,targetSnapshot:l}=s,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?Me(d).pipe(Z(()=>s)):ee(s)}),Z(u=>{let l=Kq(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s=xe(z({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),ot(()=>{this.events.next(new tl)}),tH(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Hr(1),ot({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Mi(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),vv(this.transitionAbortSubject.pipe(ot(u=>{throw u}))),Zo(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",Tn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),yi(u=>{if(a=!0,NN(u))this.events.next(new Ni(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),Zq(u)?this.events.next(new nl(u.url)):s.resolve(!1);else{this.events.next(new el(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(l)}}return Yt}))}))}cancelNavigationTransition(t,r,i){let s=new Ni(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function YH(n){return n!==Yc}var ZH=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(JH),providedIn:"root"})}}return n})(),oE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},JH=(()=>{class n extends oE{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Vc(n)))(i||n)}})()}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),jN=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:()=>B(XH),providedIn:"root"})}}return n})(),XH=(()=>{class n extends jN{constructor(){super(...arguments),this.location=B(Bc),this.urlSerializer=B(aE),this.options=B(fE,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=B(gE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new xi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=TN(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Xc)this.stateMemento=this.createStateMemento();else if(t instanceof Gs)this.rawUrlTree=r.initialUrl;else if(t instanceof wp){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else t instanceof tl?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):t instanceof Ni&&(t.code===Tn.GuardRejected||t.code===Tn.NoDataFromResolver)?this.restoreHistory(r):t instanceof el?this.restoreHistory(r,!0):t instanceof Mi&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=z(z({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=z(z({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Vc(n)))(i||n)}})()}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Kc=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Kc||{});function eG(n,e){n.events.pipe(xt(t=>t instanceof Mi||t instanceof Ni||t instanceof el||t instanceof Gs),Z(t=>t instanceof Mi||t instanceof Gs?Kc.COMPLETE:(t instanceof Ni?t.code===Tn.Redirect||t.code===Tn.SupersededByNewNavigation:!1)?Kc.REDIRECTING:Kc.FAILED),xt(t=>t!==Kc.REDIRECTING),Hr(1)).subscribe(()=>{e()})}function tG(n){throw n}var nG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},rG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ll=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=B(ip),this.stateManager=B(jN),this.options=B(fE,{optional:!0})||{},this.pendingTasks=B(jc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=B(QH),this.urlSerializer=B(aE),this.location=B(Bc),this.urlHandlingStrategy=B(gE),this._events=new tt,this.errorHandler=this.options.errorHandler||tG,this.navigated=!1,this.routeReuseStrategy=B(ZH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=B(pE,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!B(lE,{optional:!0}),this.eventsSubscription=new st,this.isNgZoneEnabled=B(me)instanceof me&&me.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Ni&&r.code!==Tn.Redirect&&r.code!==Tn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Mi)this.navigated=!0;else if(r instanceof nl){let o=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),a={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||YH(i.source)};this.scheduleNavigation(o,Yc,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}sG(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Yc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=z({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(dE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o,d=null;switch(a){case"merge":d=z(z({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let g=i?i.snapshot:this.routerState.snapshot.root;h=IN(g)}catch{(typeof t[0]!="string"||!t[0].startsWith("/"))&&(t=[]),h=this.currentUrlTree.root}return CN(h,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=ba(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Yc,null,r)}navigate(t,r={skipLocationChange:!1}){return iG(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=z({},nG):r===!1?i=z({},rG):i=r,ba(t))return aN(this.currentUrlTree,t,i);let s=this.parseUrl(t);return aN(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((h,g)=>{a=h,u=g});let d=this.pendingTasks.add();return eG(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function iG(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ne(4008,!1)}function sG(n){return!(n instanceof tl)&&!(n instanceof nl)}var Sp=(()=>{class n{constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=t.events.subscribe(l=>{l instanceof Mi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t!=null?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Rx(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||n)(Ne(ll),Ne(zs),H_("tabindex"),Ne(js),Ne(Ti),Ne(_a))}}static{this.\u0275dir=In({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&wr("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Jf("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[$t.HasDecoratorInputTransform,"preserveFragment","preserveFragment",va],skipLocationChange:[$t.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",va],replaceUrl:[$t.HasDecoratorInputTransform,"replaceUrl","replaceUrl",va],routerLink:"routerLink"},standalone:!0,features:[hw,Di]})}}return n})();var oG=new G("");function UN(n,...e){return en([{provide:pE,multi:!0,useValue:n},[],{provide:zs,useFactory:aG,deps:[ll]},{provide:ma,multi:!0,useFactory:uG},e.map(t=>t.\u0275providers)])}function aG(n){return n.routerState.root}function uG(){let n=B(Ht);return e=>{let t=n.get(Ri);if(e!==t.components[0])return;let r=n.get(ll),i=n.get(cG);n.get(lG)===1&&r.initialNavigation(),n.get(dG,null,_e.Optional)?.setUpPreloading(),n.get(oG,null,_e.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var cG=new G("",{factory:()=>new tt}),lG=new G("",{providedIn:"root",factory:()=>1});var dG=new G("");var mE=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-home"]],standalone:!0,features:[$n],decls:81,vars:0,consts:[["id","carouselExample",1,"carousel","slide"],[1,"carousel-inner"],[1,"carousel-item","active"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/product-carousel/iar-concealer/mny-iarcorrectingconcealer-homepage-still-desktop-1440x540-(1).jpg?rev=90d926dfd51d40588d3a8212bb2d76ad&cx=0.45&cy=0.38&cw=1440&ch=540&hash=5FBB2B102A09B06D1FBEF7571C83077E","alt","...",1,"d-block","w-100"],[1,"carousel-item"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/product-carousel/tips-and-trends/hp-banner-desktop-2160x810-v2.jpg?rev=27f54ccbe7474639a516c0a7a9f040ca&cx=0.66&cy=0.42&cw=768&ch=288&hash=60DB5BBB7ABC8B04983B095BFD4FC695","alt","...",1,"d-block","w-100"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/product-carousel/super-stay-teddy-tint/homepagestill-mny-makl-ssteddytint-developed-1440x540.jpg?rev=64a1b0b180b94129a1a7f95e65b562a2&cx=0&cy=0&cw=768&ch=288&hash=1F3219BFE7E72D821DB62DABB756D233","alt","...",1,"d-block","w-100"],["type","button","data-bs-target","#carouselExample","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExample","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"text-center"],[1,"ms-5"],[1,"row","ms-5","mt-5"],[1,"col-3"],[1,"card",2,"width","18rem"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/transporter-module/makeup-studio/maybelline-hp-vrtual-try-on-315x472.jpg?rev=3c085c9c9d1f4cc4b88392f78fa46ba7","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-text"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/transporter-module/makeup-studio/virtualbeautystudio_mny_maky_fitmefinder_developed_315x472v2.jpg?rev=4a58aac2422c47738df140beb2198352","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/transporter-module/makeup-studio/makeupstudio_foundationfinderv2.png?rev=13883497c29e41838e30f4b0383c0ba6","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/transporter-module/makeup-studio/virtualbeautystudiomnymakymascaraquiz315x4722x-1.jpg?rev=2feb4ab8028b482f8888db9fe97d4db7","alt","...",1,"card-img-top"],[1,"ms-5","text-center"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/product-carousel/super-stay-teddy-tint/transporter-mny-makl-ssteddytint-developed-630x944.jpg?rev=efa8788f05c741859c4f1951364245d4","alt","...",1,"card-img-top"],["href","https://www.maybelline.com/lip-makeup/lipstick/superstay-teddy-tint-liquid-lip-tint?variant=Knee+High",1,"btn","btn-danger"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/new-products-module/maybelline-new-arrivals-sky-high-space-diamond-630x944.jpg?rev=8d6307f83c684bbe88a4cc33d55eec75","alt","...",1,"card-img-top"],["href","https://www.maybelline.com/eye-makeup/mascara/lash-sensational-sky-high-space-diamond-glitter-mascara?variant=Space+Diamond",1,"btn","btn-danger"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/new-products-module/mny-iarcorrectingconcealer-transporter-630x944.jpg?rev=ec0c9ffe61c74ed888d1398ed194132b","alt","...",1,"card-img-top"],["href","https://www.maybelline.com/face-makeup/concealer/instant-age-rewind-eraser-color-correcting-concealer?variant=Green",1,"btn","btn-danger"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/homepage/new-products-module/transporter_mny_maky_ttduochrome_developed_630x944.jpg?rev=678855e585914a5c9ec09b5ada28350e","alt","...",1,"card-img-top"],["href","https://www.maybelline.com/eye-makeup/eyeliner/tattoostudio-sharpenable-gel-pencil-longwear-eyeliner-makeup?variant=Stardust+Chrome",1,"btn","btn-danger"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/makeup-tips/modules/hero/makeup-decoded/tips-and-trends-makeup-decoded-hero-desktop.jpg?rev=36e255c18b354d94833e6c5535b55cea&cx=0.46&cy=0.39&cw=1440&ch=540&hash=DDEA25FA1F3C267993DE59B2C326672B","alt",""]],template:function(r,i){r&1&&(H(0,"div",0)(1,"div",1)(2,"div",2),Ce(3,"img",3),Y(),H(4,"div",4),Ce(5,"img",5),Y(),H(6,"div",4),Ce(7,"img",6),Y()(),H(8,"button",7),Ce(9,"span",8),H(10,"span",9),se(11,"Previous"),Y()(),H(12,"button",10),Ce(13,"span",11),H(14,"span",9),se(15,"Next"),Y()()(),Ce(16,"hr"),H(17,"div",12)(18,"h1")(19,"b"),se(20,"BEAUTY-STUDIO"),Y()()(),H(21,"div",13)(22,"div",14)(23,"div",15)(24,"div",16),Ce(25,"img",17),H(26,"div",18)(27,"p",19),se(28," Time to makeup your mind! Experience your perfect makeup shades or try a bold new look with Maybelline\u2019s virtual try-on tool. "),Y()()()(),H(29,"div",15)(30,"div",16),Ce(31,"img",20),H(32,"div",18)(33,"p",19),se(34," Find your perfect fit! Complete the quiz to find your Fit Me foundation and shade from our Fit Me Collection. "),Y()()()(),H(35,"div",15)(36,"div",16),Ce(37,"img",21),H(38,"div",18)(39,"p",19),se(40," An easy-to-use mobile experience that helps you find the right product for your skintone and undertone "),Y()()()(),H(41,"div",15)(42,"div",16),Ce(43,"img",22),H(44,"div",18)(45,"p",19),se(46," Complete the quiz to discover your personalized mascara recommendation! "),Y()()()()()(),Ce(47,"hr"),H(48,"div",12)(49,"h1")(50,"b"),se(51,"NEW ARRIVALS"),Y()()(),H(52,"div",23)(53,"div",14)(54,"div",15)(55,"div",16),Ce(56,"img",24),H(57,"div",18)(58,"a",25),se(59,"LIP TINT->"),Y()()()(),H(60,"div",15)(61,"div",16),Ce(62,"img",26),H(63,"div",18)(64,"a",27),se(65,"GLITTER MASCARA->"),Y()()()(),H(66,"div",15)(67,"div",16),Ce(68,"img",28),H(69,"div",18)(70,"a",29),se(71,"AGE REWIND->"),Y()()()(),H(72,"div",15)(73,"div",16),Ce(74,"img",30),H(75,"div",18)(76,"a",31),se(77,"TATTO EYELINER->"),Y()()()()()(),Ce(78,"hr"),H(79,"div",12),Ce(80,"img",32),Y())},styles:["hr[_ngcontent-%COMP%]{border:0;height:4px;background-color:#000}.carousel[_ngcontent-%COMP%]{width:70%;margin:0 auto}"]})}}return n})();var fG="firebase",pG="10.14.1";it(fG,pG,"app");var Dt=new Qr("ANGULARFIRE2_VERSION");function Ra(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ks=(n,e)=>{let t=e?[e]:_h(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},nn=class{constructor(){return Ks(gG)}},gG="app-check";function Sa(){}var Rp=class{zone;delegate;constructor(e,t=lv){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},yE=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Sa,{},Sa,Sa)),t.pipe(ot({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},fn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Rp(Zone.current)),this.insideAngular=t.run(()=>new Rp(Zone.current,Ds)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(L(me))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xp(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function mG(n){return xp().ngZone.runOutsideAngular(()=>n())}function Ws(n){return xp().ngZone.run(()=>n())}function nt(n){return yG(xp())(n)}function yG(n){return function(t){return t=t.lift(new yE(n.ngZone)),t.pipe(Fn(n.outsideAngular),yn(n.insideAngular))}}var vG=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ws(()=>n.apply(void 0,r))},ki=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Ws(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Sa,{},Sa,Sa))),r[s]=vG(r[s],t));let i=mG(()=>n.apply(this,r));if(!e)if(i instanceof he){let s=xp();return i.pipe(Fn(s.outsideAngular),yn(s.insideAngular))}else return Ws(()=>i);return i instanceof he?i.pipe(nt):i instanceof Promise?Ws(()=>new Promise((s,o)=>i.then(a=>Ws(()=>s(a)),a=>Ws(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Ws(()=>i)};var rr=class{constructor(e){return e}},Jr=class{constructor(){return _h()}};function _G(n){return n&&n.length===1?n[0]:new rr(_s())}var _E=new G("angularfire2._apps"),wG={provide:rr,useFactory:_G,deps:[[new at,_E]]},EG={provide:Jr,deps:[[new at,_E]]};function IG(n){return(e,t)=>{let r=t.get(ft);it("angularfire",Dt.full,"core"),it("angularfire",Dt.full,"app"),it("angular",rp.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new rr(i)}}function BN(n,...e){return en([wG,EG,{provide:_E,useFactory:IG(n),multi:!0,deps:[me,Ht,fn,...e]}])}var $N=ki(KA,!0);var CG=new Map,DG={activated:!1,tokenObservers:[]},bG={initialized:!1,enabled:!1};function ir(n){return CG.get(n)||Object.assign({},DG)}function WN(){return bG}var TG="https://content-firebaseappcheck.googleapis.com/v1";var AG="exchangeDebugToken",qN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},xne=24*60*60*1e3;var EE=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return M(this,null,function*(){this.stop();try{this.pending=new Ct,this.pending.promise.catch(t=>{}),yield SG(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ct,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function SG(n){return new Promise(e=>{setTimeout(e,n)})}var RG={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Oi=new $A("appCheck","AppCheck",RG);function KN(n){if(!ir(n).activated)throw Oi.create("use-before-activation",{appName:n.name})}function QN(r,i){return M(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(n,a)}catch(y){throw Oi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(u.status!==200)throw Oi.create("fetch-status-error",{httpStatus:u.status});let l;try{l=yield u.json()}catch(y){throw Oi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Oi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+h,issuedAtTimeMillis:g}})}function YN(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${TG}/projects/${t}/apps/${r}:${AG}?key=${i}`,body:{debug_token:e}}}var xG="firebase-app-check-database",MG=1,IE="firebase-app-check-store";var Mp=null;function NG(){return Mp||(Mp=new Promise((n,e)=>{try{let t=indexedDB.open(xG,MG);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Oi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(IE,{keyPath:"compositeKey"})}}}catch(t){e(Oi.create("storage-open",{originalErrorMessage:t?.message}))}}),Mp)}function PG(n,e){return kG(OG(n),e)}function kG(n,e){return M(this,null,function*(){let r=(yield NG()).transaction(IE,"readwrite"),s=r.objectStore(IE).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var l;a(Oi.create("storage-set",{originalErrorMessage:(l=u.target.error)===null||l===void 0?void 0:l.message}))}})})}function OG(n){return`${n.options.appId}-${n.name}`}var CE=new mi("@firebase/app-check");function wE(n,e){return ph()?PG(n,e).catch(t=>{CE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function ZN(){return WN().enabled}function JN(){return M(this,null,function*(){let n=WN();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var FG={error:"UNKNOWN_ERROR"};function VG(n){return dh.encodeString(JSON.stringify(n),!1)}function DE(n,e=!1){return M(this,null,function*(){let t=n.app;KN(t);let r=ir(t),i=r.token,s;if(i&&!dl(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(dl(u)?i=u:yield wE(t,void 0))}if(!e&&i&&dl(i))return{token:i.token};let o=!1;if(ZN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=QN(YN(t,yield JN()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield wE(t,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield ir(t).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?CE.warn(u.message):CE.error(u),s=u}let a;return i?s?dl(i)?a={token:i.token,internalError:s}:a=GN(s):(a={token:i.token},r.token=i,yield wE(t,i)):a=GN(s),o&&BG(t,a),a})}function LG(n){return M(this,null,function*(){let e=n.app;KN(e);let{provider:t}=ir(e);if(ZN()){let r=yield JN(),{token:i}=yield QN(YN(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function jG(n,e,t,r){let{app:i}=n,s=ir(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&dl(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),HN(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>HN(n))}function XN(n,e){let t=ir(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function HN(n){let{app:e}=n,t=ir(e),r=t.tokenRefresher;r||(r=UG(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function UG(n){let{app:e}=n;return new EE(()=>M(this,null,function*(){let t=ir(e),r;if(t.token?r=yield DE(n,!0):r=yield DE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=ir(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},qN.RETRIAL_MIN_WAIT,qN.RETRIAL_MAX_WAIT)}function BG(n,e){let t=ir(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function dl(n){return n.expireTimeMillis-Date.now()>0}function GN(n){return{token:VG(FG),error:n}}var bE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ir(this.app);for(let t of e)XN(this.app,t.next);return Promise.resolve()}};function $G(n,e){return new bE(n,e)}function qG(n){return{getToken:e=>DE(n,e),getLimitedUseToken:()=>LG(n),addTokenListener:e=>jG(n,"INTERNAL",e),removeTokenListener:e=>XN(n.app,e)}}var HG="@firebase/app-check",GG="0.8.8";var zG="app-check",zN="app-check-internal";function WG(){vs(new mn(zG,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return $G(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(zN).initialize()})),vs(new mn(zN,n=>{let e=n.getProvider("app-check").getImmediate();return qG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),it(HG,GG)}WG();var KG=["localhost","0.0.0.0","127.0.0.1"],$ne=typeof window<"u"&&KG.includes(window.location.hostname);var QG="firebase",YG="10.14.1";_t.registerVersion(QG,YG,"app-compat");var ZG=["ngOnDestroy"],tP=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(ZG.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{let h=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,h),h})})})});var Np=class{constructor(e){return e}},Fi=new G("angularfire2.app.options"),Vi=new G("angularfire2.app.name");function Qs(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=_t.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>_t.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;JG("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Np(o)}var JG=(n,...e)=>{_w()&&typeof console<"u"&&console[n](...e)},XG={provide:Np,useFactory:Qs,deps:[Fi,me,[new at,Vi]]},nP=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Fi,useValue:t},{provide:Vi,useValue:r}]}}constructor(t){_t.registerVersion("angularfire",Dt.full,"core"),_t.registerVersion("angularfire",Dt.full,"app-compat"),_t.registerVersion("angular",rp.full,t.toString())}static \u0275fac=function(r){return new(r||n)(L(ft))};static \u0275mod=Xt({type:n});static \u0275inj=Jt({providers:[XG]})}return n})();function xa(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return ez(i,o)||(eP("error",`${e} was already initialized on the ${t} Firebase App with different settings.${tz?" You may need to reload as Firebase is not HMR aware.":""}`),eP("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function ez(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var tz=typeof module<"u"&&!!module.hot,eP=(n,...e)=>{_w()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var hl=new G("angularfire2.auth.use-emulator"),fl=new G("angularfire2.auth.settings"),pl=new G("angularfire2.auth.tenant-id"),gl=new G("angularfire2.auth.langugage-code"),ml=new G("angularfire2.auth.use-device-language"),yl=new G("angularfire.auth.persistence"),vl=(n,e,t,r,i,s,o,a)=>xa(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,s,o,a]),_l=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,u,l,d,h,g,y){let _=new tt,D=ee(void 0).pipe(yn(o.outsideAngular),We(()=>s.runOutsideAngular(()=>import("./chunk-EL3S5GG3.js"))),Z(()=>Qs(t,s,r)),Z(A=>vl(A,s,a,l,d,h,u,g)),zh({bufferSize:1,refCount:!1}));if(Zr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ee(null);else{D.pipe(vn()).subscribe();let A=D.pipe(We(F=>F.getRedirectResult().then(Q=>Q,()=>null)),nt,zh({bufferSize:1,refCount:!1})),P=D.pipe(We(F=>new he(Q=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(re=>Q.next(re),re=>Q.error(re),()=>Q.complete()))})))),U=D.pipe(We(F=>new he(Q=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(re=>Q.next(re),re=>Q.error(re),()=>Q.complete()))}))));this.authState=A.pipe(Wh(P),Fn(o.outsideAngular),yn(o.insideAngular)),this.user=A.pipe(Wh(U),Fn(o.outsideAngular),yn(o.insideAngular)),this.idToken=this.user.pipe(We(F=>F?Me(F.getIdToken()):ee(null))),this.idTokenResult=this.user.pipe(We(F=>F?Me(F.getIdTokenResult()):ee(null))),this.credential=Yo(A,_,this.authState.pipe(xt(F=>!F))).pipe(Z(F=>F?.user?F:null),Fn(o.outsideAngular),yn(o.insideAngular))}return tP(this,D,s,{spy:{apply:(A,P,U)=>{(A.startsWith("signIn")||A.startsWith("createUser"))&&U.then(F=>_.next(F))}}})}static \u0275fac=function(r){return new(r||n)(L(Fi),L(Vi,8),L(ft),L(me),L(fn),L(hl,8),L(fl,8),L(pl,8),L(gl,8),L(ml,8),L(yl,8),L(nn,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),rP=(()=>{class n{constructor(){_t.registerVersion("angularfire",Dt.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Xt({type:n});static \u0275inj=Jt({providers:[_l]})}return n})();var sP="@firebase/database",oP="1.0.8";var LI="";function jI(n){LI=n}var kE=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ht(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:gh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var OE=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return kn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var VP=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kE(e)}}catch{}return new OE},Zs=VP("localStorage"),FE=VP("sessionStorage");var ka=new mi("@firebase/database"),LP=function(){let n=1;return function(){return n++}}(),jP=function(n){let e=WA(n),t=new zA;t.update(e);let r=t.digest();return dh.encodeByteArray(r)},ql=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ql.apply(null,r):typeof r=="object"?e+=ht(r):e+=r,e+=" "}return e},Js=null,aP=!0,UP=function(n,e){V(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(ka.logLevel=On.VERBOSE,Js=ka.log.bind(ka),e&&FE.set("logging_enabled",!0)):typeof n=="function"?Js=n:(Js=null,FE.remove("logging_enabled"))},bt=function(...n){if(aP===!0&&(aP=!1,Js===null&&FE.get("logging_enabled")===!0&&UP(!0)),Js){let e=ql.apply(null,n);Js(e)}},Hl=function(n){return function(...e){bt(n,...e)}},VE=function(...n){let e="FIREBASE INTERNAL ERROR: "+ql(...n);ka.error(e)},br=function(...n){let e=`FIREBASE FATAL ERROR: ${ql(...n)}`;throw ka.error(e),new Error(e)},Gt=function(...n){let e="FIREBASE WARNING: "+ql(...n);ka.warn(e)},nz=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Gt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},og=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},rz=function(n){if(hr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Bi="[MIN_NAME]",Xr="[MAX_NAME]",eo=function(n,e){if(n===e)return 0;if(n===Bi||e===Xr)return-1;if(e===Bi||n===Xr)return 1;{let t=uP(n),r=uP(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},iz=function(n,e){return n===e?0:n<e?-1:1},wl=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ht(e))},UI=function(n){if(typeof n!="object"||n===null)return ht(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=ht(e[r]),t+=":",t+=UI(n[e[r]]);return t+="}",t},BP=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Tt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var $P=function(n){V(!og(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,u;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(u=t;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(u=0;u<64;u+=8){let g=parseInt(d.substr(u,8),2).toString(16);g.length===1&&(g="0"+g),h=h+g}return h.toLowerCase()},sz=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},oz=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function az(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var uz=new RegExp("^-?(0*)\\d{1,10}$"),cz=-2147483648,lz=2147483647,uP=function(n){if(uz.test(n)){let e=Number(n);if(e>=cz&&e<=lz)return e}return null},qa=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Gt("Exception was thrown by user callback.",t),e},Math.floor(0))}},dz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Dl=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var LE=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Gt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var jE=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(bt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Gt(e)}},bl=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),kp="5",qP="v",HP="s",GP="r",zP="f",WP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,KP="ls",QP="p",UE="ac",YP="websocket",ZP="long_polling";var Op=class{constructor(e,t,r,i,s=!1,o="",a=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Zs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function hz(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function JP(n,e,t){V(typeof e=="string","typeof type must == string"),V(typeof t=="object","typeof params must == object");let r;if(e===YP)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===ZP)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);hz(n)&&(t.ns=n.namespace);let i=[];return Tt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var BE=class{constructor(){this.counters_={}}incrementCounter(e,t=1){kn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return jA(this.counters_)}};var AE={},SE={};function BI(n){let e=n.toString();return AE[e]||(AE[e]=new BE),AE[e]}function fz(n,e){let t=n.toString();return SE[t]||(SE[t]=e()),SE[t]}var $E=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&qa(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var cP="start",pz="close",gz="pLPCommand",mz="pRTLPCB",XP="id",ek="pw",tk="ser",yz="cb",vz="seg",_z="ts",wz="d",Ez="dframe",nk=1870,rk=30,Iz=nk-rk,Cz=25e3,Dz=3e4,Rl=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Hl(e),this.stats_=BI(t),this.urlFn=u=>(this.appCheckToken&&(u[UE]=this.appCheckToken),JP(t,ZP,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new $E(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Dz)),rz(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qE((...s)=>{let[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===cP)this.id=a,this.password=u;else if(o===pz)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[cP]="t",r[tk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[yz]=this.scriptTagHolder.uniqueCallbackIdentifier),r[qP]=kp,this.transportSessionId&&(r[HP]=this.transportSessionId),this.lastSessionId&&(r[KP]=this.lastSessionId),this.applicationId&&(r[QP]=this.applicationId),this.appCheckToken&&(r[UE]=this.appCheckToken),typeof location<"u"&&location.hostname&&WP.test(location.hostname)&&(r[GP]=zP);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return hr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!sz()&&!oz()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=ht(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=LA(t),i=BP(r,Iz);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(hr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Ez]="t",r[XP]=e,r[ek]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=ht(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},qE=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,hr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=LP(),window[gz+this.uniqueCallbackIdentifier]=e,window[mz+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){bt("frame writing exception"),a.stack&&bt(a.stack),bt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||bt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[XP]=this.myID,e[ek]=this.myPW,e[tk]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+rk+r.length<=nk;){let o=this.pendingSegs.shift();r=r+"&"+vz+i+"="+o.seg+"&"+_z+i+"="+o.ts+"&"+wz+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(Cz)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){hr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{bt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var bz=16384,Tz=45e3,Fp=null;typeof MozWebSocket<"u"?Fp=MozWebSocket:typeof WebSocket<"u"&&(Fp=WebSocket);var Na=(()=>{class n{constructor(t,r,i,s,o,a,u){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Hl(this.connId),this.stats_=BI(r),this.connURL=n.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[qP]=kp,!hr()&&typeof location<"u"&&location.hostname&&WP.test(location.hostname)&&(a[GP]=zP),r&&(a[HP]=r),i&&(a[KP]=i),s&&(a[UE]=s),o&&(a[QP]=o),JP(t,YP,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zs.set("previous_websocket_failure",!0);try{let i;if(hr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${kp}/${LI}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Fp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Fp!==null&&!n.forceDisallow_}static previouslyFailed(){return Zs.isInMemoryStorage||Zs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Zs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=gh(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(V(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=BP(r,bz);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Tz))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),ik=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Rl,Na]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Na&&Na.isAvailable(),i=r&&!Na.previouslyFailed();if(t.webSocketOnly&&(r||Gt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Na];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),Az=6e4,Sz=5e3,Rz=10*1024,xz=100*1024,RE="t",lP="d",Mz="s",dP="r",Nz="e",hP="o",fP="a",pP="n",gP="p",Pz="h",HE=class{constructor(e,t,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Hl("c:"+this.id+":"),this.transportManager_=new ik(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Dl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Rz?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(RE in e){let t=e[RE];t===fP?this.upgradeIfSecondaryHealthy_():t===dP?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===hP&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=wl("t",e),r=wl("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:gP,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fP,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:pP,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=wl("t",e),r=wl("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=wl(RE,e);if(lP in e){let r=e[lP];if(t===Pz){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===pP){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Mz?this.onConnectionShutdown_(r):t===dP?this.onReset_(r):t===Nz?VE("Server Error: "+r):t===hP?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):VE("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),kp!==r&&Gt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Dl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Az))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Dl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Sz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:gP,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Vp=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Lp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},V(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){V(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var jp=class n extends Lp{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Gy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return V(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var mP=32,yP=768,ke=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Pe(){return new ke("")}function ye(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function $i(n){return n.pieces_.length-n.pieceNum_}function Ue(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ke(n.pieces_,e)}function $I(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function kz(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function xl(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function sk(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ke(e,0)}function Ke(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ke)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ke(t,0)}function ve(n){return n.pieceNum_>=n.pieces_.length}function rn(n,e){let t=ye(n),r=ye(e);if(t===null)return e;if(t===r)return rn(Ue(n),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Oz(n,e){let t=xl(n,0),r=xl(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=eo(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function qI(n,e){if($i(n)!==$i(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Hn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if($i(n)>$i(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var GE=class{constructor(e,t){this.errorPrefix_=t,this.parts_=xl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ac(this.parts_[r]);ok(this)}};function Fz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ac(e),ok(n)}function Vz(n){let e=n.parts_.pop();n.byteLength_-=ac(e),n.parts_.length>0&&(n.byteLength_-=1)}function ok(n){if(n.byteLength_>yP)throw new Error(n.errorPrefix_+"has a key path longer than "+yP+" bytes ("+n.byteLength_+").");if(n.parts_.length>mP)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+mP+") or object contains a cycle "+Ys(n))}function Ys(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var zE=class n extends Lp{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return V(e==="visible","Unknown event type: "+e),[this.visible_]}};var El=1e3,Lz=60*5*1e3,vP=30*1e3,jz=1.3,Uz=3e4,Bz="server_kill",_P=3,HI=(()=>{class n extends Vp{constructor(t,r,i,s,o,a,u,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=Hl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=El,this.maxReconnectDelay_=Lz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!hr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zE.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&jp.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(ht(o)),V(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Ct,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),V(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),V(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,u=>{let l=u.d,d=u.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&kn(t,"w")){let i=gi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Gt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||HA(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=vP)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=qA(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),V(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ht(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):VE("Unrecognized action received from server: "+ht(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){V(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=El,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=El,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Uz&&(this.reconnectDelay_=El),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*jz)}this.onConnectStatus_(!1)}establishConnection_(){return M(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,l=function(){u?u.close():(a=!0,i())},d=function(g){V(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,y]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?bt("getToken() completed but was canceled"):(bt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=y&&y.token,u=new HE(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,_=>{Gt(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(Bz)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&Gt(g),l())}}})}interrupt(t){bt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){bt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],mh(this.interruptReasons_)&&(this.reconnectDelay_=El,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>UI(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new ke(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){bt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_P&&(this.reconnectDelay_=vP,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){bt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_P&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";hr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+LI.replace(/\./g,"-")]=1,Gy()?t["framework.cordova"]=1:UA()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=jp.getInstance().currentlyOnline();return mh(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),we=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Oa=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new we(Bi,e),i=new we(Bi,t);return this.compare(r,i)!==0}minPost(){return we.MIN}};var Pp,Up=class extends Oa{static get __EMPTY_NODE(){return Pp}static set __EMPTY_NODE(e){Pp=e}compare(e,t){return eo(e.name,t.name)}isDefinedOn(e){throw Vo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return we.MIN}maxPost(){return new we(Xr,Pp)}makePost(e,t){return V(typeof e=="string","KeyIndex indexValue must always be a string."),new we(e,Pp)}toString(){return".key"}},Dr=new Up;var Pa=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},sr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Gn.EMPTY_NODE,this.right=o??Gn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Gn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Gn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),WE=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new sr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Gn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,sr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Pa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Pa(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Pa(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Pa(this.root_,null,this.comparator_,!0,e)}};Gn.EMPTY_NODE=new WE;function $z(n,e){return eo(n.name,e.name)}function GI(n,e){return eo(n,e)}var KE;function qz(n){KE=n}var ak=function(n){return typeof n=="number"?"number:"+$P(n):"string:"+n},uk=function(n){if(n.isLeafNode()){let e=n.val();V(typeof e=="string"||typeof e=="number"||typeof e=="object"&&kn(e,".sv"),"Priority must be a string or number.")}else V(n===KE||n.isEmpty(),"priority of unexpected type.");V(n===KE||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var wP,Fa=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,V(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),uk(this.priorityNode_)}static set __childrenNodeConstructor(t){wP=t}static get __childrenNodeConstructor(){return wP}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ve(t)?this:ye(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ye(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(V(i!==".priority"||$i(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+ak(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=$P(this.value_):t+=this.value_,this.lazyHash_=jP(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(V(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return V(s>=0,"Unknown leaf type: "+r),V(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),ck,lk;function Hz(n){ck=n}function Gz(n){lk=n}var QE=class extends Oa{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?eo(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return we.MIN}maxPost(){return new we(Xr,new Fa("[PRIORITY-POST]",lk))}makePost(e,t){let r=ck(e);return new we(t,new Fa("[PRIORITY-POST]",r))}toString(){return".priority"}},$e=new QE;var zz=Math.log(2),YE=class{constructor(e){let t=s=>parseInt(Math.log(s)/zz,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Bp=function(n,e,t,r){n.sort(e);let i=function(u,l){let d=l-u,h,g;if(d===0)return null;if(d===1)return h=n[u],g=t?t(h):h,new sr(g,h.node,sr.BLACK,null,null);{let y=parseInt(d/2,10)+u,_=i(u,y),D=i(y+1,l);return h=n[y],g=t?t(h):h,new sr(g,h.node,sr.BLACK,_,D)}},s=function(u){let l=null,d=null,h=n.length,g=function(_,D){let A=h-_,P=h;h-=_;let U=i(A+1,P),F=n[A],Q=t?t(F):F;y(new sr(Q,F.node,D,null,U))},y=function(_){l?(l.left=_,l=_):(d=_,l=_)};for(let _=0;_<u.count;++_){let D=u.nextBitIsOne(),A=Math.pow(2,u.count-(_+1));D?g(A,sr.BLACK):(g(A,sr.BLACK),g(A,sr.RED))}return d},o=new YE(n.length),a=s(o);return new Gn(r||e,a)};var xE,Ma={},Va=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return V(Ma&&$e,"ChildrenNode.ts has not been loaded"),xE=xE||new n({".priority":Ma},{".priority":$e}),xE}get(e){let t=gi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Gn?t:null}hasIndex(e){return kn(this.indexSet_,e.toString())}addIndex(e,t){V(e!==Dr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(we.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Bp(r,e.getCompare()):a=Ma;let u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;let d=Object.assign({},this.indexes_);return d[u]=a,new n(d,l)}addToIndexes(e,t){let r=oc(this.indexes_,(i,s)=>{let o=gi(this.indexSet_,s);if(V(o,"Missing index implementation for "+s),i===Ma)if(o.isDefinedOn(e.node)){let a=[],u=t.getIterator(we.Wrap),l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),Bp(a,o.getCompare())}else return Ma;else{let a=t.get(e.name),u=i;return a&&(u=u.remove(new we(e.name,a))),u.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=oc(this.indexes_,i=>{if(i===Ma)return i;{let s=t.get(e.name);return s?i.remove(new we(e.name,s)):i}});return new n(r,this.indexSet_)}};var Il,de=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&uk(this.priorityNode_),this.children_.isEmpty()&&V(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Il||(Il=new n(new Gn(GI),null,Va.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Il}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Il:r}}getChild(t){let r=ye(t);return r===null?this:this.getImmediateChild(r).getChild(Ue(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(V(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new we(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Il:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ye(t);if(i===null)return r;{V(ye(t)!==".priority"||$i(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ue(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild($e,(a,u)=>{r[a]=u.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+ak(this.getPriority().val())+":"),this.forEachChild($e,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":jP(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new we(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new we(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new we(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Gl?-1:0}withIndex(t){if(t===Dr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Dr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator($e),s=r.getIterator($e),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Dr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),ZE=class extends de{constructor(){super(new Gn(GI),de.EMPTY_NODE,Va.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return de.EMPTY_NODE}isEmpty(){return!1}},Gl=new ZE;Object.defineProperties(we,{MIN:{value:new we(Bi,de.EMPTY_NODE)},MAX:{value:new we(Xr,Gl)}});Up.__EMPTY_NODE=de.EMPTY_NODE;Fa.__childrenNodeConstructor=de;qz(Gl);Gz(Gl);var Wz=!0;function Ze(n,e=null){if(n===null)return de.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),V(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Fa(t,Ze(e))}if(!(n instanceof Array)&&Wz){let t=[],r=!1;if(Tt(n,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ze(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new we(o,u)))}}),t.length===0)return de.EMPTY_NODE;let s=Bp(t,$z,o=>o.name,GI);if(r){let o=Bp(t,$e.getCompare());return new de(s,Ze(e),new Va({".priority":o},{".priority":$e}))}else return new de(s,Ze(e),Va.Default)}else{let t=de.EMPTY_NODE;return Tt(n,(r,i)=>{if(kn(n,r)&&r.substring(0,1)!=="."){let s=Ze(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Ze(e))}}Hz(Ze);var Ml=class extends Oa{constructor(e){super(),this.indexPath_=e,V(!ve(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?eo(e.name,t.name):s}makePost(e,t){let r=Ze(e),i=de.EMPTY_NODE.updateChild(this.indexPath_,r);return new we(t,i)}maxPost(){let e=de.EMPTY_NODE.updateChild(this.indexPath_,Gl);return new we(Xr,e)}toString(){return xl(this.indexPath_,0).join("/")}};var JE=class extends Oa{compare(e,t){let r=e.node.compareTo(t.node);return r===0?eo(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return we.MIN}maxPost(){return we.MAX}makePost(e,t){let r=Ze(e);return new we(t,r)}toString(){return".value"}},zI=new JE;function dk(n){return{type:"value",snapshotNode:n}}function La(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Nl(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Pl(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Kz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var kl=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){V(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Nl(t,a)):V(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(La(t,r)):o.trackChildChange(Pl(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild($e,(i,s)=>{t.hasChild(i)||r.trackChildChange(Nl(i,s))}),t.isLeafNode()||t.forEachChild($e,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Pl(i,s,o))}else r.trackChildChange(La(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?de.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var $p=class n{constructor(e){this.indexedFilter_=new kl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new we(t,r))||(r=de.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=de.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(de.EMPTY_NODE);let s=this;return t.forEachChild($e,(o,a)=>{s.matches(new we(o,a))||(i=i.updateImmediateChild(o,de.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var XE=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new $p(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new we(t,r))||(r=de.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=de.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=de.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(de.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(g,y)=>h(y,g)}else o=this.index_.getCompare();let a=e;V(a.numChildren()===this.limit_,"");let u=new we(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(t)){let h=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,l,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let y=g==null?1:o(g,u);if(d&&!r.isEmpty()&&y>=0)return s?.trackChildChange(Pl(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(Nl(t,h));let D=a.updateImmediateChild(t,de.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(La(g.name,g.node)),D.updateImmediateChild(g.name,g.node)):D}}else return r.isEmpty()?e:d&&o(l,u)>=0?(s!=null&&(s.trackChildChange(Nl(l.name,l.node)),s.trackChildChange(La(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,de.EMPTY_NODE)):e}};var Ol=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return V(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return V(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bi}hasEnd(){return this.endSet_}getIndexEndValue(){return V(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return V(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return V(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Qz(n){return n.loadsAllData()?new kl(n.getIndex()):n.hasLimit()?new XE(n):new $p(n)}function Yz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function Zz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function eI(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function Jz(n,e,t){let r;return n.index_===Dr||t?r=eI(n,e,t):r=eI(n,e,Xr),r.startAfterSet_=!0,r}function tI(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function Xz(n,e,t){let r;return n.index_===Dr||t?r=tI(n,e,t):r=tI(n,e,Bi),r.endBeforeSet_=!0,r}function ag(n,e){let t=n.copy();return t.index_=e,t}function EP(n){let e={};if(n.isDefault())return e;let t;if(n.index_===$e?t="$priority":n.index_===zI?t="$value":n.index_===Dr?t="$key":(V(n.index_ instanceof Ml,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ht(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=ht(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+ht(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=ht(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+ht(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function IP(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==$e&&(e.i=n.index_.toString()),e}var nI=class n extends Vp{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Hl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(V(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let u=EP(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),gi(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=EP(e._queryParams),r=e._path.toString(),i=new Ct;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+GA(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=gh(a.responseText)}catch{Gt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Gt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var rI=class{constructor(){this.rootNode_=de.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function qp(){return{value:null,children:new Map}}function Ha(n,e,t){if(ve(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ye(e);n.children.has(r)||n.children.set(r,qp());let i=n.children.get(r);e=Ue(e),Ha(i,e,t)}}function iI(n,e){if(ve(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild($e,(r,i)=>{Ha(n,new ke(r),i)}),iI(n,e)}}else if(n.children.size>0){let t=ye(e);return e=Ue(e),n.children.has(t)&&iI(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function sI(n,e,t){n.value!==null?t(e,n.value):e3(n,(r,i)=>{let s=new ke(e.toString()+"/"+r);sI(i,s,t)})}function e3(n,e){n.children.forEach((t,r)=>{e(r,t)})}var oI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Tt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var CP=10*1e3,t3=30*1e3,n3=5*60*1e3,aI=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new oI(e);let r=CP+(t3-CP)*Math.random();Dl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Tt(e,(i,s)=>{s>0&&kn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Dl(this.reportStats_.bind(this),Math.floor(Math.random()*2*n3))}};var Cr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Cr||{});function WI(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function KI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function QI(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var uI=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Cr.ACK_USER_WRITE,this.source=WI()}operationForChild(e){if(ve(this.path)){if(this.affectedTree.value!=null)return V(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ke(e));return new n(Pe(),t,this.revert)}}else return V(ye(this.path)===e,"operationForChild called for unrelated child."),new n(Ue(this.path),this.affectedTree,this.revert)}};var Hp=class n{constructor(e,t){this.source=e,this.path=t,this.type=Cr.LISTEN_COMPLETE}operationForChild(e){return ve(this.path)?new n(this.source,Pe()):new n(this.source,Ue(this.path))}};var ja=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Cr.OVERWRITE}operationForChild(e){return ve(this.path)?new n(this.source,Pe(),this.snap.getImmediateChild(e)):new n(this.source,Ue(this.path),this.snap)}};var Fl=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Cr.MERGE}operationForChild(e){if(ve(this.path)){let t=this.children.subtree(new ke(e));return t.isEmpty()?null:t.value?new ja(this.source,Pe(),t.value):new n(this.source,Pe(),t)}else return V(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Tr=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ve(e))return this.isFullyInitialized()&&!this.filtered_;let t=ye(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var cI=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function r3(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Kz(o.childName,o.snapshotNode))}),Cl(n,i,"child_removed",e,r,t),Cl(n,i,"child_added",e,r,t),Cl(n,i,"child_moved",s,r,t),Cl(n,i,"child_changed",e,r,t),Cl(n,i,"value",e,r,t),i}function Cl(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,u)=>s3(n,a,u)),o.forEach(a=>{let u=i3(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,n.query_))})})}function i3(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function s3(n,e,t){if(e.childName==null||t.childName==null)throw Vo("Should only compare child_ events.");let r=new we(e.childName,e.snapshotNode),i=new we(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function ug(n,e){return{eventCache:n,serverCache:e}}function Tl(n,e,t,r){return ug(new Tr(e,t,r),n.serverCache)}function hk(n,e,t,r){return ug(n.eventCache,new Tr(e,t,r))}function Gp(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Xs(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var ME,o3=()=>(ME||(ME=new Gn(iz)),ME),sn=class n{constructor(e,t=o3()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Tt(e,(r,i)=>{t=t.set(new ke(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Pe(),value:this.value};if(ve(e))return null;{let r=ye(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ue(e),t);return s!=null?{path:Ke(new ke(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ve(e))return this;{let t=ye(e),r=this.children.get(t);return r!==null?r.subtree(Ue(e)):new n(null)}}set(e,t){if(ve(e))return new n(t,this.children);{let r=ye(e),s=(this.children.get(r)||new n(null)).set(Ue(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ve(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ye(e),r=this.children.get(t);if(r){let i=r.remove(Ue(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ve(e))return this.value;{let t=ye(e),r=this.children.get(t);return r?r.get(Ue(e)):null}}setTree(e,t){if(ve(e))return t;{let r=ye(e),s=(this.children.get(r)||new n(null)).setTree(Ue(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Pe(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ke(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Pe(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ve(e))return null;{let s=ye(e),o=this.children.get(s);return o?o.findOnPath_(Ue(e),Ke(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Pe(),t)}foreachOnPath_(e,t,r){if(ve(e))return this;{this.value&&r(t,this.value);let i=ye(e),s=this.children.get(i);return s?s.foreachOnPath_(Ue(e),Ke(t,i),r):new n(null)}}foreach(e){this.foreach_(Pe(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ke(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var or=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new sn(null))}};function Al(n,e,t){if(ve(e))return new or(new sn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=rn(i,e);return s=s.updateChild(o,t),new or(n.writeTree_.set(i,s))}else{let i=new sn(t),s=n.writeTree_.setTree(e,i);return new or(s)}}}function lI(n,e,t){let r=n;return Tt(t,(i,s)=>{r=Al(r,Ke(e,i),s)}),r}function DP(n,e){if(ve(e))return or.empty();{let t=n.writeTree_.setTree(e,new sn(null));return new or(t)}}function dI(n,e){return to(n,e)!=null}function to(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(rn(t.path,e)):null}function bP(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild($e,(r,i)=>{e.push(new we(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new we(r,i.value))}),e}function ji(n,e){if(ve(e))return n;{let t=to(n,e);return t!=null?new or(new sn(t)):new or(n.writeTree_.subtree(e))}}function hI(n){return n.writeTree_.isEmpty()}function Ua(n,e){return fk(Pe(),n.writeTree_,e)}function fk(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(V(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=fk(Ke(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Ke(n,".priority"),r)),t}}function cg(n,e){return yk(e,n)}function a3(n,e,t,r,i){V(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Al(n.visibleWrites,e,t)),n.lastWriteId=r}function u3(n,e,t,r){V(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=lI(n.visibleWrites,e,t),n.lastWriteId=r}function c3(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function l3(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);V(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&d3(a,r.path)?i=!1:Hn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return h3(n),!0;if(r.snap)n.visibleWrites=DP(n.visibleWrites,r.path);else{let a=r.children;Tt(a,u=>{n.visibleWrites=DP(n.visibleWrites,Ke(r.path,u))})}return!0}else return!1}function d3(n,e){if(n.snap)return Hn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Hn(Ke(n.path,t),e))return!0;return!1}function h3(n){n.visibleWrites=pk(n.allWrites,f3,Pe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function f3(n){return n.visible}function pk(n,e,t){let r=or.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Hn(t,o)?(a=rn(t,o),r=Al(r,a,s.snap)):Hn(o,t)&&(a=rn(o,t),r=Al(r,Pe(),s.snap.getChild(a)));else if(s.children){if(Hn(t,o))a=rn(t,o),r=lI(r,a,s.children);else if(Hn(o,t))if(a=rn(o,t),ve(a))r=lI(r,Pe(),s.children);else{let u=gi(s.children,ye(a));if(u){let l=u.getChild(Ue(a));r=Al(r,Pe(),l)}}}else throw Vo("WriteRecord should have .snap or .children")}}return r}function gk(n,e,t,r,i){if(!r&&!i){let s=to(n.visibleWrites,e);if(s!=null)return s;{let o=ji(n.visibleWrites,e);if(hI(o))return t;if(t==null&&!dI(o,Pe()))return null;{let a=t||de.EMPTY_NODE;return Ua(o,a)}}}else{let s=ji(n.visibleWrites,e);if(!i&&hI(s))return t;if(!i&&t==null&&!dI(s,Pe()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Hn(l.path,e)||Hn(e,l.path))},a=pk(n.allWrites,o,e),u=t||de.EMPTY_NODE;return Ua(a,u)}}}function p3(n,e,t){let r=de.EMPTY_NODE,i=to(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild($e,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=ji(n.visibleWrites,e);return t.forEachChild($e,(o,a)=>{let u=Ua(ji(s,new ke(o)),a);r=r.updateImmediateChild(o,u)}),bP(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=ji(n.visibleWrites,e);return bP(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function g3(n,e,t,r,i){V(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ke(e,t);if(dI(n.visibleWrites,s))return null;{let o=ji(n.visibleWrites,s);return hI(o)?i.getChild(t):Ua(o,i.getChild(t))}}function m3(n,e,t,r){let i=Ke(e,t),s=to(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=ji(n.visibleWrites,i);return Ua(o,r.getNode().getImmediateChild(t))}else return null}function y3(n,e){return to(n.visibleWrites,e)}function v3(n,e,t,r,i,s,o){let a,u=ji(n.visibleWrites,e),l=to(u,Pe());if(l!=null)a=l;else if(t!=null)a=Ua(u,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=g.getNext();for(;y&&d.length<i;)h(y,r)!==0&&d.push(y),y=g.getNext();return d}else return[]}function _3(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function zp(n,e,t,r){return gk(n.writeTree,n.treePath,e,t,r)}function YI(n,e){return p3(n.writeTree,n.treePath,e)}function TP(n,e,t,r){return g3(n.writeTree,n.treePath,e,t,r)}function Wp(n,e){return y3(n.writeTree,Ke(n.treePath,e))}function w3(n,e,t,r,i,s){return v3(n.writeTree,n.treePath,e,t,r,i,s)}function ZI(n,e,t){return m3(n.writeTree,n.treePath,e,t)}function mk(n,e){return yk(Ke(n.treePath,e),n.writeTree)}function yk(n,e){return{treePath:n,writeTree:e}}var fI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;V(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),V(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Pl(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Nl(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,La(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Pl(r,e.snapshotNode,i.oldSnap));else throw Vo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var pI=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},vk=new pI,Vl=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ZI(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xs(this.viewCache_),s=w3(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function E3(n){return{filter:n}}function I3(n,e){V(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),V(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function C3(n,e,t,r,i){let s=new fI,o,a;if(t.type===Cr.OVERWRITE){let l=t;l.source.fromUser?o=gI(n,e,l.path,l.snap,r,i,s):(V(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ve(l.path),o=Kp(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Cr.MERGE){let l=t;l.source.fromUser?o=b3(n,e,l.path,l.children,r,i,s):(V(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=mI(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Cr.ACK_USER_WRITE){let l=t;l.revert?o=S3(n,e,l.path,r,i,s):o=T3(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Cr.LISTEN_COMPLETE)o=A3(n,e,t.path,r,s);else throw Vo("Unknown operation type: "+t.type);let u=s.getChanges();return D3(e,o,u),{viewCache:o,changes:u}}function D3(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Gp(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(dk(Gp(e)))}}function _k(n,e,t,r,i,s){let o=e.eventCache;if(Wp(r,t)!=null)return e;{let a,u;if(ve(t))if(V(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Xs(e),d=l instanceof de?l:de.EMPTY_NODE,h=YI(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=zp(r,Xs(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ye(t);if(l===".priority"){V($i(t)===1,"Can't have a priority with additional path components");let d=o.getNode();u=e.serverCache.getNode();let h=TP(r,t,d,u);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=Ue(t),h;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();let g=TP(r,t,o.getNode(),u);g!=null?h=o.getNode().getImmediateChild(l).updateChild(d,g):h=o.getNode().getImmediateChild(l)}else h=ZI(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return Tl(e,a,o.isFullyInitialized()||ve(t),n.filter.filtersNodes())}}function Kp(n,e,t,r,i,s,o,a){let u=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(ve(t))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){let y=u.getNode().updateChild(t,r);l=d.updateFullNode(u.getNode(),y,null)}else{let y=ye(t);if(!u.isCompleteForPath(t)&&$i(t)>1)return e;let _=Ue(t),A=u.getNode().getImmediateChild(y).updateChild(_,r);y===".priority"?l=d.updatePriority(u.getNode(),A):l=d.updateChild(u.getNode(),y,A,_,vk,null)}let h=hk(e,l,u.isFullyInitialized()||ve(t),d.filtersNodes()),g=new Vl(i,h,s);return _k(n,h,t,i,g,a)}function gI(n,e,t,r,i,s,o){let a=e.eventCache,u,l,d=new Vl(i,e,s);if(ve(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Tl(e,l,!0,n.filter.filtersNodes());else{let h=ye(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),u=Tl(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=Ue(t),y=a.getNode().getImmediateChild(h),_;if(ve(g))_=r;else{let D=d.getCompleteChild(h);D!=null?$I(g)===".priority"&&D.getChild(sk(g)).isEmpty()?_=D:_=D.updateChild(g,r):_=de.EMPTY_NODE}if(y.equals(_))u=e;else{let D=n.filter.updateChild(a.getNode(),h,_,g,d,o);u=Tl(e,D,a.isFullyInitialized(),n.filter.filtersNodes())}}}return u}function AP(n,e){return n.eventCache.isCompleteForChild(e)}function b3(n,e,t,r,i,s,o){let a=e;return r.foreach((u,l)=>{let d=Ke(t,u);AP(e,ye(d))&&(a=gI(n,a,d,l,i,s,o))}),r.foreach((u,l)=>{let d=Ke(t,u);AP(e,ye(d))||(a=gI(n,a,d,l,i,s,o))}),a}function SP(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function mI(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;ve(t)?l=r:l=new sn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,g)=>{if(d.hasChild(h)){let y=e.serverCache.getNode().getImmediateChild(h),_=SP(n,y,g);u=Kp(n,u,new ke(h),_,i,s,o,a)}}),l.children.inorderTraversal((h,g)=>{let y=!e.serverCache.isCompleteForChild(h)&&g.value===null;if(!d.hasChild(h)&&!y){let _=e.serverCache.getNode().getImmediateChild(h),D=SP(n,_,g);u=Kp(n,u,new ke(h),D,i,s,o,a)}}),u}function T3(n,e,t,r,i,s,o){if(Wp(i,t)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ve(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return Kp(n,e,t,u.getNode().getChild(t),i,s,a,o);if(ve(t)){let l=new sn(null);return u.getNode().forEachChild(Dr,(d,h)=>{l=l.set(new ke(d),h)}),mI(n,e,t,l,i,s,a,o)}else return e}else{let l=new sn(null);return r.foreach((d,h)=>{let g=Ke(t,d);u.isCompleteForPath(g)&&(l=l.set(d,u.getNode().getChild(g)))}),mI(n,e,t,l,i,s,a,o)}}function A3(n,e,t,r,i){let s=e.serverCache,o=hk(e,s.getNode(),s.isFullyInitialized()||ve(t),s.isFiltered());return _k(n,o,t,r,vk,i)}function S3(n,e,t,r,i,s){let o;if(Wp(r,t)!=null)return e;{let a=new Vl(r,e,i),u=e.eventCache.getNode(),l;if(ve(t)||ye(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=zp(r,Xs(e));else{let h=e.serverCache.getNode();V(h instanceof de,"serverChildren would be complete if leaf node"),d=YI(r,h)}d=d,l=n.filter.updateFullNode(u,d,s)}else{let d=ye(t),h=ZI(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=u.getImmediateChild(d)),h!=null?l=n.filter.updateChild(u,d,h,Ue(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(u,d,de.EMPTY_NODE,Ue(t),a,s):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=zp(r,Xs(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Wp(r,Pe())!=null,Tl(e,l,o,n.filter.filtersNodes())}}var yI=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new kl(r.getIndex()),s=Qz(r);this.processor_=E3(s);let o=t.serverCache,a=t.eventCache,u=i.updateFullNode(de.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(de.EMPTY_NODE,a.getNode(),null),d=new Tr(u,o.isFullyInitialized(),i.filtersNodes()),h=new Tr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ug(h,d),this.eventGenerator_=new cI(this.query_)}get query(){return this.query_}};function R3(n){return n.viewCache_.serverCache.getNode()}function x3(n){return Gp(n.viewCache_)}function M3(n,e){let t=Xs(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ve(e)&&!t.getImmediateChild(ye(e)).isEmpty())?t.getChild(e):null}function RP(n){return n.eventRegistrations_.length===0}function N3(n,e){n.eventRegistrations_.push(e)}function xP(n,e,t){let r=[];if(t){V(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function MP(n,e,t,r){e.type===Cr.MERGE&&e.source.queryId!==null&&(V(Xs(n.viewCache_),"We should always have a full cache before handling merges"),V(Gp(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=C3(n.processor_,i,e,t,r);return I3(n.processor_,s.viewCache),V(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,wk(n,s.changes,s.viewCache.eventCache.getNode(),null)}function P3(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild($e,(s,o)=>{r.push(La(s,o))}),t.isFullyInitialized()&&r.push(dk(t.getNode())),wk(n,r,t.getNode(),e)}function wk(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return r3(n.eventGenerator_,e,t,i)}var Qp,Yp=class{constructor(){this.views=new Map}};function k3(n){V(!Qp,"__referenceConstructor has already been defined"),Qp=n}function O3(){return V(Qp,"Reference.ts has not been loaded"),Qp}function F3(n){return n.views.size===0}function JI(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return V(s!=null,"SyncTree gave us an op for an invalid query."),MP(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(MP(o,e,t,r));return s}}function Ek(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=zp(t,i?r:null),u=!1;a?u=!0:r instanceof de?(a=YI(t,r),u=!1):(a=de.EMPTY_NODE,u=!1);let l=ug(new Tr(a,u,!1),new Tr(r,i,!1));return new yI(e,l)}return o}function V3(n,e,t,r,i,s){let o=Ek(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),N3(o,t),P3(o,t)}function L3(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=qi(n);if(i==="default")for(let[u,l]of n.views.entries())o=o.concat(xP(l,t,r)),RP(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{let u=n.views.get(i);u&&(o=o.concat(xP(u,t,r)),RP(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!qi(n)&&s.push(new(O3())(e._repo,e._path)),{removed:s,events:o}}function Ik(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ui(n,e){let t=null;for(let r of n.views.values())t=t||M3(r,e);return t}function Ck(n,e){if(e._queryParams.loadsAllData())return lg(n);{let r=e._queryIdentifier;return n.views.get(r)}}function Dk(n,e){return Ck(n,e)!=null}function qi(n){return lg(n)!=null}function lg(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Zp;function j3(n){V(!Zp,"__referenceConstructor has already been defined"),Zp=n}function U3(){return V(Zp,"Reference.ts has not been loaded"),Zp}var B3=1,Jp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new sn(null),this.pendingWriteTree_=_3(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function XI(n,e,t,r,i){return a3(n.pendingWriteTree_,e,t,r,i),i?Ga(n,new ja(WI(),e,t)):[]}function $3(n,e,t,r){u3(n.pendingWriteTree_,e,t,r);let i=sn.fromObject(t);return Ga(n,new Fl(WI(),e,i))}function Li(n,e,t=!1){let r=c3(n.pendingWriteTree_,e);if(l3(n.pendingWriteTree_,e)){let s=new sn(null);return r.snap!=null?s=s.set(Pe(),!0):Tt(r.children,o=>{s=s.set(new ke(o),!0)}),Ga(n,new uI(r.path,s,t))}else return[]}function zl(n,e,t){return Ga(n,new ja(KI(),e,t))}function q3(n,e,t){let r=sn.fromObject(t);return Ga(n,new Fl(KI(),e,r))}function H3(n,e){return Ga(n,new Hp(KI(),e))}function G3(n,e,t){let r=eC(n,t);if(r){let i=tC(r),s=i.path,o=i.queryId,a=rn(s,e),u=new Hp(QI(o),a);return nC(n,s,u)}else return[]}function Xp(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Dk(o,e))){let u=L3(o,e,t,r);F3(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=u.removed;if(a=u.events,!i){let d=l.findIndex(g=>g._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(g,y)=>qi(y));if(d&&!h){let g=n.syncPointTree_.subtree(s);if(!g.isEmpty()){let y=K3(g);for(let _=0;_<y.length;++_){let D=y[_],A=D.query,P=Sk(n,D);n.listenProvider_.startListening(Sl(A),Ll(n,A),P.hashFn,P.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Sl(e),null):l.forEach(g=>{let y=n.queryToTagMap.get(hg(g));n.listenProvider_.stopListening(Sl(g),y)}))}Q3(n,l)}return a}function bk(n,e,t,r){let i=eC(n,r);if(i!=null){let s=tC(i),o=s.path,a=s.queryId,u=rn(o,e),l=new ja(QI(a),u,t);return nC(n,o,l)}else return[]}function z3(n,e,t,r){let i=eC(n,r);if(i){let s=tC(i),o=s.path,a=s.queryId,u=rn(o,e),l=sn.fromObject(t),d=new Fl(QI(a),u,l);return nC(n,o,d)}else return[]}function vI(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(g,y)=>{let _=rn(g,i);s=s||Ui(y,_),o=o||qi(y)});let a=n.syncPointTree_.get(i);a?(o=o||qi(a),s=s||Ui(a,Pe())):(a=new Yp,n.syncPointTree_=n.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=de.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((y,_)=>{let D=Ui(_,Pe());D&&(s=s.updateImmediateChild(y,D))}));let l=Dk(a,e);if(!l&&!e._queryParams.loadsAllData()){let g=hg(e);V(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let y=Y3();n.queryToTagMap.set(g,y),n.tagToQueryMap.set(y,g)}let d=cg(n.pendingWriteTree_,i),h=V3(a,e,t,d,s,u);if(!l&&!o&&!r){let g=Ck(a,e);h=h.concat(Z3(n,e,g))}return h}function dg(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let u=rn(o,e),l=Ui(a,u);if(l)return l});return gk(i,e,s,t,!0)}function W3(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=rn(l,t);r=r||Ui(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Ui(i,Pe()):(i=new Yp,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Tr(r,!0,!1):null,a=cg(n.pendingWriteTree_,e._path),u=Ek(i,e,a,s?o.getNode():de.EMPTY_NODE,s);return x3(u)}function Ga(n,e){return Tk(e,n.syncPointTree_,null,cg(n.pendingWriteTree_,Pe()))}function Tk(n,e,t,r){if(ve(n.path))return Ak(n,e,t,r);{let i=e.get(Pe());t==null&&i!=null&&(t=Ui(i,Pe()));let s=[],o=ye(n.path),a=n.operationForChild(o),u=e.children.get(o);if(u&&a){let l=t?t.getImmediateChild(o):null,d=mk(r,o);s=s.concat(Tk(a,u,l,d))}return i&&(s=s.concat(JI(i,n,r,t))),s}}function Ak(n,e,t,r){let i=e.get(Pe());t==null&&i!=null&&(t=Ui(i,Pe()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=t?t.getImmediateChild(o):null,l=mk(r,o),d=n.operationForChild(o);d&&(s=s.concat(Ak(d,a,u,l)))}),i&&(s=s.concat(JI(i,n,r,t))),s}function Sk(n,e){let t=e.query,r=Ll(n,t);return{hashFn:()=>(R3(e)||de.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?G3(n,t._path,r):H3(n,t._path);{let s=az(i,t);return Xp(n,t,null,s)}}}}function Ll(n,e){let t=hg(e);return n.queryToTagMap.get(t)}function hg(n){return n._path.toString()+"$"+n._queryIdentifier}function eC(n,e){return n.tagToQueryMap.get(e)}function tC(n){let e=n.indexOf("$");return V(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ke(n.substr(0,e))}}function nC(n,e,t){let r=n.syncPointTree_.get(e);V(r,"Missing sync point for query tag that we're tracking");let i=cg(n.pendingWriteTree_,e);return JI(r,t,i,null)}function K3(n){return n.fold((e,t,r)=>{if(t&&qi(t))return[lg(t)];{let i=[];return t&&(i=Ik(t)),Tt(r,(s,o)=>{i=i.concat(o)}),i}})}function Sl(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(U3())(n._repo,n._path):n}function Q3(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=hg(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function Y3(){return B3++}function Z3(n,e,t){let r=e._path,i=Ll(n,e),s=Sk(n,t),o=n.listenProvider_.startListening(Sl(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)V(!qi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((l,d,h)=>{if(!ve(l)&&d&&qi(d))return[lg(d).query];{let g=[];return d&&(g=g.concat(Ik(d).map(y=>y.query))),Tt(h,(y,_)=>{g=g.concat(_)}),g}});for(let l=0;l<u.length;++l){let d=u[l];n.listenProvider_.stopListening(Sl(d),Ll(n,d))}}return o}var _I=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},wI=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Ke(this.path_,e);return new n(this.syncTree_,t)}node(){return dg(this.syncTree_,this.path_)}},J3=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},NP=function(n,e,t){if(!n||typeof n!="object")return n;if(V(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return X3(n[".sv"],e,t);if(typeof n[".sv"]=="object")return eW(n[".sv"],e);V(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},X3=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:V(!1,"Unexpected server value: "+n)}},eW=function(n,e,t){n.hasOwnProperty("increment")||V(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&V(!1,"Unexpected increment value: "+r);let i=e.node();if(V(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},Rk=function(n,e,t,r){return iC(e,new wI(t,n),r)},rC=function(n,e,t){return iC(n,new _I(e),t)};function iC(n,e,t){let r=n.getPriority().val(),i=NP(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=NP(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Fa(a,Ze(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Fa(i))),o.forEachChild($e,(a,u)=>{let l=iC(u,e.getImmediateChild(a),t);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}var jl=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function fg(n,e){let t=e instanceof ke?e:new ke(e),r=n,i=ye(t);for(;i!==null;){let s=gi(r.node.children,i)||{children:{},childCount:0};r=new jl(i,r,s),t=Ue(t),i=ye(t)}return r}function no(n){return n.node.value}function sC(n,e){n.node.value=e,EI(n)}function xk(n){return n.node.childCount>0}function tW(n){return no(n)===void 0&&!xk(n)}function pg(n,e){Tt(n.node.children,(t,r)=>{e(new jl(t,n,r))})}function Mk(n,e,t,r){t&&!r&&e(n),pg(n,i=>{Mk(i,e,!0,r)}),t&&r&&e(n)}function nW(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Wl(n){return new ke(n.parent===null?n.name:Wl(n.parent)+"/"+n.name)}function EI(n){n.parent!==null&&rW(n.parent,n.name,n)}function rW(n,e,t){let r=tW(t),i=kn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,EI(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,EI(n))}var iW=/[\[\].#$\/\u0000-\u001F\u007F]/,sW=/[\[\].#$\u0000-\u001F\u007F]/,NE=10*1024*1024,gg=function(n){return typeof n=="string"&&n.length!==0&&!iW.test(n)},Nk=function(n){return typeof n=="string"&&n.length!==0&&!sW.test(n)},oW=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Nk(n)},Ul=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!og(n)||n&&typeof n=="object"&&kn(n,".sv")},Ar=function(n,e,t,r){r&&e===void 0||Kl(ln(n,"value"),e,t)},Kl=function(n,e,t){let r=t instanceof ke?new GE(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ys(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ys(r)+" with contents = "+e.toString());if(og(e))throw new Error(n+"contains "+e.toString()+" "+Ys(r));if(typeof e=="string"&&e.length>NE/3&&ac(e)>NE)throw new Error(n+"contains a string greater than "+NE+" utf8 bytes "+Ys(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Tt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!gg(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ys(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Fz(r,o),Kl(n,a,r),Vz(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ys(r)+" in addition to actual children.")}},aW=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=xl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!gg(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Oz);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Hn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},Pk=function(n,e,t,r){if(r&&e===void 0)return;let i=ln(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Tt(e,(o,a)=>{let u=new ke(o);if(Kl(i,a,Ke(t,u)),$I(u)===".priority"&&!Ul(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),aW(i,s)},oC=function(n,e,t){if(!(t&&e===void 0)){if(og(e))throw new Error(ln(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ul(e))throw new Error(ln(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ql=function(n,e,t,r){if(!(r&&t===void 0)&&!gg(t))throw new Error(ln(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},za=function(n,e,t,r){if(!(r&&t===void 0)&&!Nk(t))throw new Error(ln(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},uW=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),za(n,e,t,r)},An=function(n,e){if(ye(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},kk=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!gg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!oW(t))throw new Error(ln(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var II=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function mg(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!qI(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Ok(n,e,t){mg(n,t),Fk(n,r=>qI(r,e))}function Sn(n,e,t){mg(n,t),Fk(n,r=>Hn(r,e)||Hn(e,r))}function Fk(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(cW(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function cW(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Js&&bt("event: "+t.toString()),qa(r)}}}var Vk="repo_interrupt",lW=25,CI=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new II,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=qp(),this.transactionQueueTree_=new jl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function dW(n,e,t){if(n.stats_=BI(n.repoInfo_),n.forceRestClient_||dz())n.server_=new nI(n.repoInfo_,(r,i,s,o)=>{PP(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>kP(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ht(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new HI(n.repoInfo_,e,(r,i,s,o)=>{PP(n,r,i,s,o)},r=>{kP(n,r)},r=>{hW(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=fz(n.repoInfo_,()=>new aI(n.stats_,n.server_)),n.infoData_=new rI,n.infoSyncTree_=new Jp({startListening:(r,i,s,o)=>{let a=[],u=n.infoData_.getNode(r._path);return u.isEmpty()||(a=zl(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),aC(n,"connected",!1),n.serverSyncTree_=new Jp({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,u)=>{let l=o(a,u);Sn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function Lk(n){let t=n.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Yl(n){return J3({timestamp:Lk(n)})}function PP(n,e,t,r,i){n.dataUpdateCount++;let s=new ke(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let u=oc(t,l=>Ze(l));o=z3(n.serverSyncTree_,s,u,i)}else{let u=Ze(t);o=bk(n.serverSyncTree_,s,u,i)}else if(r){let u=oc(t,l=>Ze(l));o=q3(n.serverSyncTree_,s,u)}else{let u=Ze(t);o=zl(n.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Ba(n,s)),Sn(n.eventQueue_,a,o)}function kP(n,e){aC(n,"connected",e),e===!1&&gW(n)}function hW(n,e){Tt(e,(t,r)=>{aC(n,t,r)})}function aC(n,e,t){let r=new ke("/.info/"+e),i=Ze(t);n.infoData_.updateSnapshot(r,i);let s=zl(n.infoSyncTree_,r,i);Sn(n.eventQueue_,r,s)}function yg(n){return n.nextWriteId_++}function fW(n,e,t){let r=W3(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=Ze(i).withIndex(e._queryParams.getIndex());vI(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=zl(n.serverSyncTree_,e._path,s);else{let a=Ll(n.serverSyncTree_,e);o=bk(n.serverSyncTree_,e._path,s,a)}return Sn(n.eventQueue_,e._path,o),Xp(n.serverSyncTree_,e,t,null,!0),s},i=>(Wa(n,"get for query "+ht(e)+" failed: "+i),Promise.reject(new Error(i))))}function uC(n,e,t,r,i){Wa(n,"set",{path:e.toString(),value:t,priority:r});let s=Yl(n),o=Ze(t,r),a=dg(n.serverSyncTree_,e),u=rC(o,a,s),l=yg(n),d=XI(n.serverSyncTree_,e,u,l,!0);mg(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(g,y)=>{let _=g==="ok";_||Gt("set at "+e+" failed: "+g);let D=Li(n.serverSyncTree_,l,!_);Sn(n.eventQueue_,e,D),Hi(n,i,g,y)});let h=lC(n,e);Ba(n,h),Sn(n.eventQueue_,h,[])}function pW(n,e,t,r){Wa(n,"update",{path:e.toString(),value:t});let i=!0,s=Yl(n),o={};if(Tt(t,(a,u)=>{i=!1,o[a]=Rk(Ke(e,a),Ze(u),n.serverSyncTree_,s)}),i)bt("update() called with empty data.  Don't do anything."),Hi(n,r,"ok",void 0);else{let a=yg(n),u=$3(n.serverSyncTree_,e,o,a);mg(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||Gt("update at "+e+" failed: "+l);let g=Li(n.serverSyncTree_,a,!h),y=g.length>0?Ba(n,e):e;Sn(n.eventQueue_,y,g),Hi(n,r,l,d)}),Tt(t,l=>{let d=lC(n,Ke(e,l));Ba(n,d)}),Sn(n.eventQueue_,e,[])}}function gW(n){Wa(n,"onDisconnectEvents");let e=Yl(n),t=qp();sI(n.onDisconnect_,Pe(),(i,s)=>{let o=Rk(i,s,n.serverSyncTree_,e);Ha(t,i,o)});let r=[];sI(t,Pe(),(i,s)=>{r=r.concat(zl(n.serverSyncTree_,i,s));let o=lC(n,i);Ba(n,o)}),n.onDisconnect_=qp(),Sn(n.eventQueue_,Pe(),r)}function mW(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&iI(n.onDisconnect_,e),Hi(n,t,r,i)})}function OP(n,e,t,r){let i=Ze(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Ha(n.onDisconnect_,e,i),Hi(n,r,s,o)})}function yW(n,e,t,r,i){let s=Ze(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Ha(n.onDisconnect_,e,s),Hi(n,i,o,a)})}function vW(n,e,t,r){if(mh(t)){bt("onDisconnect().update() called with empty data.  Don't do anything."),Hi(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Tt(t,(o,a)=>{let u=Ze(a);Ha(n.onDisconnect_,Ke(e,o),u)}),Hi(n,r,i,s)})}function _W(n,e,t){let r;ye(e._path)===".info"?r=vI(n.infoSyncTree_,e,t):r=vI(n.serverSyncTree_,e,t),Ok(n.eventQueue_,e._path,r)}function DI(n,e,t){let r;ye(e._path)===".info"?r=Xp(n.infoSyncTree_,e,t):r=Xp(n.serverSyncTree_,e,t),Ok(n.eventQueue_,e._path,r)}function jk(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Vk)}function wW(n){n.persistentConnection_&&n.persistentConnection_.resume(Vk)}function Wa(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),bt(t,...e)}function Hi(n,e,t,r){e&&qa(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function EW(n,e,t,r,i,s){Wa(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:LP(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=cC(n,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Kl("transaction failed: Data returned ",u,o.path),o.status=0;let l=fg(n.transactionQueueTree_,e),d=no(l)||[];d.push(o),sC(l,d);let h;typeof u=="object"&&u!==null&&kn(u,".priority")?(h=gi(u,".priority"),V(Ul(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(dg(n.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();let g=Yl(n),y=Ze(u,h),_=rC(y,a,g);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=_,o.currentWriteId=yg(n);let D=XI(n.serverSyncTree_,e,_,o.currentWriteId,o.applyLocally);Sn(n.eventQueue_,e,D),vg(n,n.transactionQueueTree_)}}function cC(n,e,t){return dg(n.serverSyncTree_,e,t)||de.EMPTY_NODE}function vg(n,e=n.transactionQueueTree_){if(e||_g(n,e),no(e)){let t=Bk(n,e);V(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&IW(n,Wl(e),t)}else xk(e)&&pg(e,t=>{vg(n,t)})}function IW(n,e,t){let r=t.map(l=>l.currentWriteId),i=cC(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];V(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=rn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;n.server_.put(u.toString(),a,l=>{Wa(n,"transaction put response",{path:u.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Li(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&h.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();_g(n,fg(n.transactionQueueTree_,e)),vg(n,n.transactionQueueTree_),Sn(n.eventQueue_,e,d);for(let g=0;g<h.length;g++)qa(h[g])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{Gt("transaction at "+u.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}Ba(n,e)}},o)}function Ba(n,e){let t=Uk(n,e),r=Wl(t),i=Bk(n,t);return CW(n,i,r),r}function CW(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],l=rn(t,u.path),d=!1,h;if(V(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)d=!0,h=u.abortReason,i=i.concat(Li(n.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=lW)d=!0,h="maxretry",i=i.concat(Li(n.serverSyncTree_,u.currentWriteId,!0));else{let g=cC(n,u.path,o);u.currentInputSnapshot=g;let y=e[a].update(g.val());if(y!==void 0){Kl("transaction failed: Data returned ",y,u.path);let _=Ze(y);typeof y=="object"&&y!=null&&kn(y,".priority")||(_=_.updatePriority(g.getPriority()));let A=u.currentWriteId,P=Yl(n),U=rC(_,g,P);u.currentOutputSnapshotRaw=_,u.currentOutputSnapshotResolved=U,u.currentWriteId=yg(n),o.splice(o.indexOf(A),1),i=i.concat(XI(n.serverSyncTree_,u.path,U,u.currentWriteId,u.applyLocally)),i=i.concat(Li(n.serverSyncTree_,A,!0))}else d=!0,h="nodata",i=i.concat(Li(n.serverSyncTree_,u.currentWriteId,!0))}Sn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}_g(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)qa(r[a]);vg(n,n.transactionQueueTree_)}function Uk(n,e){let t,r=n.transactionQueueTree_;for(t=ye(e);t!==null&&no(r)===void 0;)r=fg(r,t),e=Ue(e),t=ye(e);return r}function Bk(n,e){let t=[];return $k(n,e,t),t.sort((r,i)=>r.order-i.order),t}function $k(n,e,t){let r=no(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);pg(e,i=>{$k(n,i,t)})}function _g(n,e){let t=no(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,sC(e,t.length>0?t:void 0)}pg(e,r=>{_g(n,r)})}function lC(n,e){let t=Wl(Uk(n,e)),r=fg(n.transactionQueueTree_,e);return nW(r,i=>{PE(n,i)}),PE(n,r),Mk(r,i=>{PE(n,i)}),t}function PE(n,e){let t=no(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(V(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(V(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Li(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?sC(e,void 0):t.length=s+1,Sn(n.eventQueue_,Wl(e),i);for(let o=0;o<r.length;o++)qa(r[o])}}function DW(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function bW(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Gt(`Invalid query segment '${t}' in query '${n}'`)}return e}var bI=function(n,e){let t=TW(n),r=t.namespace;t.domain==="firebase.com"&&br(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&br("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||nz();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Op(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ke(t.pathString)}},TW=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",u=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=DW(n.substring(d,h)));let g=bW(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;let y=e.slice(0,l);if(y.toLowerCase()==="localhost")t="localhost";else if(y.split(".").length<=2)t=y;else{let _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),t=e.substring(_+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var FP="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",AW=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=FP.charAt(t%64),t=Math.floor(t/64);V(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=FP.charAt(e[i]);return V(o.length===20,"nextPushId: Length should be 20."),o}}();var eg=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ht(this.snapshot.exportVal())}},tg=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Bl=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return V(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var ng=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Ct;return mW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){An("OnDisconnect.remove",this._path);let e=new Ct;return OP(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){An("OnDisconnect.set",this._path),Ar("OnDisconnect.set",e,this._path,!1);let t=new Ct;return OP(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){An("OnDisconnect.setWithPriority",this._path),Ar("OnDisconnect.setWithPriority",e,this._path,!1),oC("OnDisconnect.setWithPriority",t,!1);let r=new Ct;return yW(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){An("OnDisconnect.update",this._path),Pk("OnDisconnect.update",e,this._path,!1);let t=new Ct;return vW(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var on=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ve(this._path)?null:$I(this._path)}get ref(){return new Rn(this._repo,this._path)}get _queryIdentifier(){let e=IP(this._queryParams),t=UI(e);return t==="{}"?"default":t}get _queryObject(){return IP(this._queryParams)}isEqual(e){if(e=Ee(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=qI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+kz(this._path)}};function wg(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Gi(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Dr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Bi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Xr)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===$e){if(e!=null&&!Ul(e)||t!=null&&!Ul(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(V(n.getIndex()instanceof Ml||n.getIndex()===zI,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Eg(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Rn=class n extends on{constructor(e,t){super(e,t,new Ol,!1)}get parent(){let e=sk(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},$a=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new ke(e),r=ei(this.ref,e);return new n(this._node.getChild(t),r,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,ei(this.ref,r),$e)))}hasChild(e){let t=new ke(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Ig(n,e){return n=Ee(n),n._checkNotDeleted("ref"),e!==void 0?ei(n._root,e):n._root}function Cg(n,e){n=Ee(n),n._checkNotDeleted("refFromURL");let t=bI(e,n._repo.repoInfo_.nodeAdmin);kk("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&br("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Ig(n,t.path.toString())}function ei(n,e){return n=Ee(n),ye(n._path)===null?uW("child","path",e,!1):za("child","path",e,!1),new Rn(n._repo,Ke(n._path,e))}function dC(n,e){n=Ee(n),An("push",n._path),Ar("push",e,n._path,!0);let t=Lk(n._repo),r=AW(t),i=ei(n,r),s=ei(n,r),o;return e!=null?o=Zl(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function hC(n){return An("remove",n._path),Zl(n,null)}function Zl(n,e){n=Ee(n),An("set",n._path),Ar("set",e,n._path,!1);let t=new Ct;return uC(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function fC(n,e){n=Ee(n),An("setPriority",n._path),oC("setPriority",e,!1);let t=new Ct;return uC(n._repo,Ke(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function pC(n,e,t){if(An("setWithPriority",n._path),Ar("setWithPriority",e,n._path,!1),oC("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Ct;return uC(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function gC(n,e){Pk("update",e,n._path,!1);let t=new Ct;return pW(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function mC(n){n=Ee(n);let e=new Bl(()=>{}),t=new $l(e);return fW(n._repo,n,t).then(r=>new $a(r,new Rn(n._repo,n._path),n._queryParams.getIndex()))}var $l=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new eg("value",this,new $a(e.snapshotNode,new Rn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new tg(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},rg=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new tg(this,e,t):null}createEvent(e,t){V(e.childName!=null,"Child events should have a childName.");let r=ei(new Rn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new eg(e.type,this,new $a(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Jl(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=t,l=(d,h)=>{DI(n._repo,n,a),u(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Bl(t,s||void 0),a=e==="value"?new $l(o):new rg(e,o);return _W(n._repo,n,a),()=>DI(n._repo,n,a)}function Xl(n,e,t,r){return Jl(n,"value",e,t,r)}function Dg(n,e,t,r){return Jl(n,"child_added",e,t,r)}function bg(n,e,t,r){return Jl(n,"child_changed",e,t,r)}function Tg(n,e,t,r){return Jl(n,"child_moved",e,t,r)}function Ag(n,e,t,r){return Jl(n,"child_removed",e,t,r)}function Sg(n,e,t){let r=null,i=t?new Bl(t):null;e==="value"?r=new $l(i):e&&(r=new rg(e,i)),DI(n._repo,n,r)}var xn=class{},ig=class extends xn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Ar("endAt",this._value,e._path,!0);let t=tI(e._queryParams,this._value,this._key);if(Eg(t),Gi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function yC(n,e){return Ql("endAt","key",e,!0),new ig(n,e)}var TI=class extends xn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Ar("endBefore",this._value,e._path,!1);let t=Xz(e._queryParams,this._value,this._key);if(Eg(t),Gi(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function vC(n,e){return Ql("endBefore","key",e,!0),new TI(n,e)}var sg=class extends xn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Ar("startAt",this._value,e._path,!0);let t=eI(e._queryParams,this._value,this._key);if(Eg(t),Gi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function _C(n=null,e){return Ql("startAt","key",e,!0),new sg(n,e)}var AI=class extends xn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Ar("startAfter",this._value,e._path,!1);let t=Jz(e._queryParams,this._value,this._key);if(Eg(t),Gi(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function wC(n,e){return Ql("startAfter","key",e,!0),new AI(n,e)}var SI=class extends xn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new on(e._repo,e._path,Yz(e._queryParams,this._limit),e._orderByCalled)}};function EC(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new SI(n)}var RI=class extends xn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new on(e._repo,e._path,Zz(e._queryParams,this._limit),e._orderByCalled)}};function IC(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new RI(n)}var xI=class extends xn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){wg(e,"orderByChild");let t=new ke(this._path);if(ve(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Ml(t),i=ag(e._queryParams,r);return Gi(i),new on(e._repo,e._path,i,!0)}};function CC(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return za("orderByChild","path",n,!1),new xI(n)}var MI=class extends xn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){wg(e,"orderByKey");let t=ag(e._queryParams,Dr);return Gi(t),new on(e._repo,e._path,t,!0)}};function DC(){return new MI}var NI=class extends xn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){wg(e,"orderByPriority");let t=ag(e._queryParams,$e);return Gi(t),new on(e._repo,e._path,t,!0)}};function bC(){return new NI}var PI=class extends xn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){wg(e,"orderByValue");let t=ag(e._queryParams,zI);return Gi(t),new on(e._repo,e._path,t,!0)}};function TC(){return new PI}var kI=class extends xn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Ar("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ig(this._value,this._key)._apply(new sg(this._value,this._key)._apply(e))}};function AC(n,e){return Ql("equalTo","key",e,!0),new kI(n,e)}function Mn(n,...e){let t=Ee(n);for(let r of e)t=r._apply(t);return t}k3(Rn);j3(Rn);var SW="FIREBASE_DATABASE_EMULATOR_HOST",OI={},RW=!1;function xW(n,e,t,r){n.repoInfo_=new Op(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function SC(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||br("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),bt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=bI(s,i),a=o.repoInfo,u,l;typeof process<"u"&&process.env&&(l=process.env[SW]),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=bI(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let d=i&&u?new bl(bl.OWNER):new jE(n.name,n.options,e);kk("Invalid Firebase Database URL",o),ve(o.path)||br("Database URL must point to the root of a Firebase Database (not including a child path).");let h=NW(a,n,d,new LE(n.name,t));return new FI(h,n)}function MW(n,e){let t=OI[e];(!t||t[n.key]!==n)&&br(`Database ${e}(${n.repoInfo_}) has already been deleted.`),jk(n),delete t[n.key]}function NW(n,e,t,r){let i=OI[e.name];i||(i={},OI[e.name]=i);let s=i[n.toURLString()];return s&&br("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new CI(n,RW,t,r),i[n.toURLString()]=s,s}var FI=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(dW(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Rn(this._repo,Pe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(MW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&br("Cannot call "+e+" on a deleted database.")}};function qk(){ik.IS_TRANSPORT_INITIALIZED&&Gt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function RC(){qk(),Rl.forceDisallow()}function xC(){qk(),Na.forceDisallow(),Rl.forceAllow()}function Hk(n=_s(),e){let t=uc(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=hh("database");r&&Rg(t,...r)}return t}function Rg(n,e,t,r={}){n=Ee(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&br("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&br('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new bl(bl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:fh(r.mockUserToken,n.app.options.projectId);s=new bl(o)}xW(i,e,t,s)}function MC(n){n=Ee(n),n._checkNotDeleted("goOffline"),jk(n._repo)}function NC(n){n=Ee(n),n._checkNotDeleted("goOnline"),wW(n._repo)}function PC(n,e){UP(n,e)}function PW(n){jI(vh),vs(new mn("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return SC(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),it(sP,oP,n),it(sP,oP,"esm2017")}var kW={".sv":"timestamp"};function kC(){return kW}function OC(n){return{".sv":{increment:n}}}var VI=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function FC(n,e,t){var r;if(n=Ee(n),An("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Ct,o=(u,l,d)=>{let h=null;u?s.reject(u):(h=new $a(d,new Rn(n._repo,n._path),$e),s.resolve(new VI(l,h)))},a=Xl(n,()=>{});return EW(n._repo,n._path,e,o,a,i),s.promise}HI.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};HI.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};PW();var OW="@firebase/database-compat",FW="1.0.8";var VW=new mi("@firebase/database-compat"),Gk=function(n){let e="FIREBASE WARNING: "+n;VW.warn(e)};var LW=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(ln(n,e)+"must be a boolean.")},jW=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ln(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var VC=class{constructor(e){this._delegate=e}cancel(e){ie("OnDisconnect.cancel",0,1,arguments.length),vt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ie("OnDisconnect.remove",0,1,arguments.length),vt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ie("OnDisconnect.set",1,2,arguments.length),vt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ie("OnDisconnect.setWithPriority",2,3,arguments.length),vt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ie("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Gk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var LC=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ie("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var ro=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ie("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ie("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ie("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ie("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ie("DataSnapshot.child",0,1,arguments.length),e=String(e),za("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ie("DataSnapshot.hasChild",1,1,arguments.length),za("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ie("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ie("DataSnapshot.forEach",1,1,arguments.length),vt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ie("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ie("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ie("DataSnapshot.ref",0,0,arguments.length),new ti(this._database,this._delegate.ref)}get ref(){return this.getRef()}},xg=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ie("Query.on",2,4,arguments.length),vt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new ro(this.database,l),d)};a.userCallback=t,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Xl(this._delegate,a,u),t;case"child_added":return Dg(this._delegate,a,u),t;case"child_removed":return Ag(this._delegate,a,u),t;case"child_changed":return bg(this._delegate,a,u),t;case"child_moved":return Tg(this._delegate,a,u),t;default:throw new Error(ln("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ie("Query.off",0,3,arguments.length),jW("Query.off",e,!0),vt("Query.off","callback",t,!0),Ky("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,Sg(this._delegate,e,i)}else Sg(this._delegate,e)}get(){return mC(this._delegate).then(e=>new ro(this.database,e))}once(e,t,r,i){ie("Query.once",1,4,arguments.length),vt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Ct,a=(l,d)=>{let h=new ro(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Xl(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":Dg(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":Ag(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":bg(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":Tg(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(ln("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ie("Query.limitToFirst",1,1,arguments.length),new n(this.database,Mn(this._delegate,EC(e)))}limitToLast(e){return ie("Query.limitToLast",1,1,arguments.length),new n(this.database,Mn(this._delegate,IC(e)))}orderByChild(e){return ie("Query.orderByChild",1,1,arguments.length),new n(this.database,Mn(this._delegate,CC(e)))}orderByKey(){return ie("Query.orderByKey",0,0,arguments.length),new n(this.database,Mn(this._delegate,DC()))}orderByPriority(){return ie("Query.orderByPriority",0,0,arguments.length),new n(this.database,Mn(this._delegate,bC()))}orderByValue(){return ie("Query.orderByValue",0,0,arguments.length),new n(this.database,Mn(this._delegate,TC()))}startAt(e=null,t){return ie("Query.startAt",0,2,arguments.length),new n(this.database,Mn(this._delegate,_C(e,t)))}startAfter(e=null,t){return ie("Query.startAfter",0,2,arguments.length),new n(this.database,Mn(this._delegate,wC(e,t)))}endAt(e=null,t){return ie("Query.endAt",0,2,arguments.length),new n(this.database,Mn(this._delegate,yC(e,t)))}endBefore(e=null,t){return ie("Query.endBefore",0,2,arguments.length),new n(this.database,Mn(this._delegate,vC(e,t)))}equalTo(e,t){return ie("Query.equalTo",1,2,arguments.length),new n(this.database,Mn(this._delegate,AC(e,t)))}toString(){return ie("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ie("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ie("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,vt(e,"cancel",i.cancel,!0),i.context=r,Ky(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(ln(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ti(this.database,new Rn(this._delegate._repo,this._delegate._path))}},ti=class n extends xg{constructor(e,t){super(e,new on(t._repo,t._path,new Ol,!1)),this.database=e,this._delegate=t}getKey(){return ie("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ie("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,ei(this._delegate,e))}getParent(){ie("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ie("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ie("Reference.set",1,2,arguments.length),vt("Reference.set","onComplete",t,!0);let r=Zl(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ie("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Gk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}An("Reference.update",this._delegate._path),vt("Reference.update","onComplete",t,!0);let r=gC(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ie("Reference.setWithPriority",2,3,arguments.length),vt("Reference.setWithPriority","onComplete",r,!0);let i=pC(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ie("Reference.remove",0,1,arguments.length),vt("Reference.remove","onComplete",e,!0);let t=hC(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ie("Reference.transaction",1,3,arguments.length),vt("Reference.transaction","transactionUpdate",e,!1),vt("Reference.transaction","onComplete",t,!0),LW("Reference.transaction","applyLocally",r,!0);let i=FC(this._delegate,e,{applyLocally:r}).then(s=>new LC(s.committed,new ro(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ie("Reference.setPriority",1,2,arguments.length),vt("Reference.setPriority","onComplete",t,!0);let r=fC(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ie("Reference.push",0,2,arguments.length),vt("Reference.push","onComplete",t,!0);let r=dC(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return An("Reference.onDisconnect",this._delegate._path),new VC(new ng(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var io=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:RC,forceLongPolling:xC}}useEmulator(e,t,r={}){Rg(this._delegate,e,t,r)}ref(e){if(ie("database.ref",0,1,arguments.length),e instanceof ti){let t=Cg(this._delegate,e.toString());return new ti(this,t)}else{let t=Ig(this._delegate,e);return new ti(this,t)}}refFromURL(e){ie("database.refFromURL",1,1,arguments.length);let r=Cg(this._delegate,e);return new ti(this,r)}goOffline(){return ie("database.goOffline",0,0,arguments.length),MC(this._delegate)}goOnline(){return ie("database.goOnline",0,0,arguments.length),NC(this._delegate)}};io.ServerValue={TIMESTAMP:kC(),increment:n=>OC(n)};function UW({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){jI(t);let a=new Qy("database-standalone"),u=new yh("auth-internal",a);u.setComponent(new mn("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new yh("app-check-internal",a),l.setComponent(new mn("app-check-internal",()=>i,"PRIVATE"))),{instance:new io(SC(n,u,l,e,o),n),namespace:s}}var BW=Object.freeze({__proto__:null,initStandalone:UW});var $W=io.ServerValue;function qW(n){n.INTERNAL.registerComponent(new mn("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new io(i,r)},"PUBLIC").setServiceProps({Reference:ti,Query:xg,Database:io,DataSnapshot:ro,enableLogging:PC,INTERNAL:BW,ServerValue:$W}).setMultipleInstances(!0)),n.registerVersion(OW,FW)}qW(_t);function ed(n,e,t="on",r=Ds){return new he(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),t==="on"?{unsubscribe(){s!=null&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(Z(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),pc())}function HW(n){return typeof n=="string"}function GW(n){return typeof n.exportVal=="function"}function Yk(n){return n==null}function Zk(n){return typeof n.set=="function"}function zk(n,e){return Zk(e)?e:n.ref(e)}function Jk(n,e){if(HW(n))return e.stringCase();if(Zk(n))return e.firebaseCase();if(GW(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function Xk(n){return(Yk(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function e1(n,e,t){e=Xk(e);let r=e.map(i=>ed(n,i,"on",t));return Yo(...r)}function zW(n,e,t){let r=e1(n,e).pipe(pr((i,s)=>[...i,s],[]));return KW(n,r,t)}function WW(n,e){return ed(n,"value","on",e).pipe(Z(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function KW(n,e,t){return WW(n,t).pipe(_v(e),Z(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),yv(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),Z(i=>i.actions))}function Wk(n,e){return function(r,i){return Jk(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function QW(n){return function(t){return t?Jk(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function YW(n,e,t){return ed(n,"value","once",t).pipe(We(r=>{let i=[ee(r)];return e.forEach(s=>i.push(ed(n,s,"on",t))),Yo(...i).pipe(pr(JW,[]))}),hc())}function t1(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function ZW(n,e){if(Yk(e))return 0;{let t=t1(n,e);return t===-1?n.length:t+1}}function JW(n,e){let{payload:t,prevKey:r,key:i}=e,s=t1(n,i),o=ZW(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(u=>u.payload.key!==t.key),n.splice(o,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=n.splice(s,1)[0];return n=n.slice(),n.splice(o,0,a),n}return n;default:return n}}function Kk(n,e,t){return e=Xk(e),YW(n,e,t)}function XW(n,e){let t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:Wk(r,"update"),set:Wk(r,"set"),push:i=>r.push(i),remove:QW(r),snapshotChanges(i){return Kk(n,i,t).pipe(nt)},stateChanges(i){return e1(n,i,t).pipe(nt)},auditTrail(i){return zW(n,i,t).pipe(nt)},valueChanges(i,s){return Kk(n,i,t).pipe(Z(a=>a.map(u=>s&&s.idField?xe(z({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),nt)}}}function Qk(n,e){return function(){return ed(n,"value","on",e)}}function e9(n,e){return{query:n,snapshotChanges(){return Qk(n,e.schedulers.outsideAngular)().pipe(nt)},update(t){return n.ref.update(t)},set(t){return n.ref.set(t)},remove(){return n.ref.remove()},valueChanges(){return Qk(n,e.schedulers.outsideAngular)().pipe(nt,Z(r=>r.payload.exists()?r.payload.val():null))}}}var t9=new G("angularfire2.realtimeDatabaseURL"),n9=new G("angularfire2.database.use-emulator"),jC=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,u,l,d,h,g,y,_,D,A){this.schedulers=a;let P=u,U=Qs(t,o,r);l&&vl(U,o,d,g,y,_,h,D),this.database=xa(`${U.name}.database.${i}`,"AngularFireDatabase",U.name,()=>{let F=o.runOutsideAngular(()=>U.database(i||void 0));return P&&F.useEmulator(...P),F},[P])}list(t,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>zk(this.database,t)),s=i;return r&&(s=r(i)),XW(s,this)}object(t){let r=this.schedulers.ngZone.runOutsideAngular(()=>zk(this.database,t));return e9(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(L(Fi),L(Vi,8),L(t9,8),L(ft),L(me),L(fn),L(n9,8),L(_l,8),L(hl,8),L(fl,8),L(pl,8),L(gl,8),L(ml,8),L(yl,8),L(nn,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),n1=(()=>{class n{constructor(){_t.registerVersion("angularfire",Dt.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Xt({type:n});static \u0275inj=Jt({providers:[jC]})}return n})();var Mg=(()=>{class n{constructor(t){this.db=t,this.dbPath="/products",this.productsRef=t.list(this.dbPath)}getAllProducts(){return this.productsRef}getProduct(t){return this.db.object(`${this.dbPath}/${t}`)}addProduct(t){this.productsRef.push(t)}updateProduct(t,r){this.productsRef.update(t,r)}deleteProduct(t){return this.productsRef.remove(t)}static{this.\u0275fac=function(r){return new(r||n)(L(jC))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function i9(n,e){if(n&1){let t=EM();H(0,"div",16)(1,"div",6)(2,"h5",7),se(3),Y(),H(4,"p",8),se(5),Y(),H(6,"button",18),wr("click",function(){let i=BR(t).$implicit,s=CM();return $R(s.removeProduct(i.key))}),se(7," remove "),Y()()()}if(n&2){let t=e.$implicit;Ai(3),gw(t.name),Ai(2),tp(" ",t.description," ")}}var i1=(()=>{class n{constructor(t,r){this.productService=t,this.router=r,this.products=[],this.totalProducts=0}ngOnInit(){this.getAllProducts()}getAllProducts(){this.productService.getAllProducts().snapshotChanges().subscribe({next:t=>{this.products=[],t.forEach(r=>{let i=r.payload.toJSON();this.totalProducts++,this.products.push({key:r.key||"",id:i.id,name:i.name,description:i.description})})}})}editProduct(t){this.router.navigate(["/addmakeup/"+t])}removeProduct(t){window.confirm("Are You Sure ??")&&this.productService.deleteProduct(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(Mg),Ne(ll))}}static{this.\u0275cmp=Un({type:n,selectors:[["app-makeupproducts"]],standalone:!0,features:[$n],decls:74,vars:0,consts:[[1,"text-center","heading","mt-3","text-danger"],[1,"text-center","mt-5",2,"margin-left","10%"],[1,"row"],[1,"col-4"],[1,"card",2,"width","18rem"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/products/lip-makeup/lip-color/super-stay-teddy-tint/alt-pics/maybelline-superstay-teddy-tint-55-kneehigh-041554089059-primary_760x1138.jpg?rev=d6a639391b62404bac9261c3837784a1&cx=0.52&cy=0.48&cw=315&ch=472&hash=0AA5FBA4B28B6B2119D345E9104A3BEB","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["href","#",1,"btn","btn-danger"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/eye-makeup/mascara/lash-sensational-sky-high-space-diamond-glitter-mascara/atf/maybelline-sky-high-lash-sensational-mascara-eye-791-space-diamond-041554094374-open-p.jpg?rev=eee43192b4dd4c2da7034d32a068c9d7&cx=0&cy=0&cw=315&ch=472&hash=563205AE02C29BA0C317E9A649B3DAD4","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/face-makeup/foundation/super-stay-24hr-skin-tint-with-vitamin-c/maybelline-super-stay-24h-skin-tint-129-041554083804-o.jpg?rev=7e248d490a57476dac1074307594bc37&cx=0.64&cy=0.52&cw=315&ch=472&hash=D195ACF2108871376E67BD61DA14A6CF","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/lips-makeup/lip-stick/color-sensational-the-mattes-matte-finish-lipstick-makeup/maybelline-lipstick-color-sensational-mattes-660-touch-of-spice-041554429893-o.jpg?rev=ff75b0a5d3394bf38839adeea7e6d637&cx=0&cy=0&cw=315&ch=472&hash=F670F1B9EB8952CB2DB851F183ACF2C3","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/eye-makeup/mascara/lash-sensational-sky-high-tinted-primer-mascara-makeup/maybelline-sky-high-tinted-primer-041554081336-o.jpg?rev=e1bbd86d826843c0b082cde4d36e82b5&cx=0&cy=0&cw=315&ch=472&hash=394BA53AEF95BAB0776F3BF3F4C5FE5E","alt","...",1,"card-img-top"],["src","https://www.maybelline.com/-/media/project/loreal/brand-sites/mny/americas/us/face-makeup/concealer/instant-age-rewind-eraser-dark-circles-concealer-treatment/maybelline-face-instant-age-rewind-eraser-concealer-packshot-sand.jpg?rev=3c118fabf9374ae7a9ebd1aa2bfbac84&cx=0&cy=0&cw=315&ch=472&hash=14E85B1D25BDFA8F79CF85DBE6C82B64","alt","...",1,"card-img-top"],[1,"container","my-4"],[1,"card","ms-5","mt-5",2,"width","70rem"],["type","button","routerLink","/makeupproducts/addmakeup",1,"btn","btn-primary","mt-5"],[1,"btn","btn-danger","ms-3",3,"click"]],template:function(r,i){r&1&&(H(0,"div",0)(1,"h1")(2,"b"),se(3,"PRODUCTS"),Y()()(),H(4,"div",1)(5,"div",2)(6,"div",3)(7,"div",4),Ce(8,"img",5),H(9,"div",6)(10,"h5",7),se(11,"Super Stay Teddy Tint"),Y(),H(12,"p",8),se(13," A teddy-soft tint that lasts. Plush, light feel. Super Stay Teddy Tint lasts for up to 12 hours. "),Y(),H(14,"a",9),se(15,"VIEW PRODUCT"),Y()()()(),H(16,"div",3)(17,"div",4),Ce(18,"img",10),H(19,"div",6)(20,"h5",7),se(21,"Space Glitter Mascara"),Y(),H(22,"p",8),se(23," Use on lashes and brows to instantly elevate your look . Formulated suitable for sensitive "),Y(),H(24,"a",9),se(25,"VIEW PRODUCT"),Y()()()(),H(26,"div",3)(27,"div",4),Ce(28,"img",11),H(29,"div",6)(30,"h5",7),se(31,"24HR Skin Tint"),Y(),H(32,"p",8),se(33," Resists sweat, humidity and fading. Suitable for all skin types, including sensitive skin. "),Y(),H(34,"a",9),se(35,"VIEW PRODUCT"),Y()()()()()(),H(36,"div",1)(37,"div",2)(38,"div",3)(39,"div",4),Ce(40,"img",12),H(41,"div",6)(42,"h5",7),se(43,"Matte Finish Lipstick"),Y(),H(44,"p",8),se(45," Lipstick Makeup delivers crisp, vibrant lip color and smooth, supple lips. Infused with a caring oil "),Y(),H(46,"a",9),se(47,"VIEW PRODUCT"),Y()()()(),H(48,"div",3)(49,"div",4),Ce(50,"img",13),H(51,"div",6)(52,"h5",7),se(53,"Mascara Makeup"),Y(),H(54,"p",8),se(55," The Lash Sensational Sky High Tinted Primer is Maybelline New York's 1st tinted primer for extreme "),Y(),H(56,"a",9),se(57,"VIEW PRODUCT"),Y()()()(),H(58,"div",3)(59,"div",4),Ce(60,"img",14),H(61,"div",6)(62,"h5",7),se(63,"Multi-Use Concealer"),Y(),H(64,"p",8),se(65," Get up to 12 hours of moisturizing wear for crease-resistant coverage and a sponge tip applicator. "),Y(),H(66,"a",9),se(67,"VIEW PRODUCT"),Y()()()()()(),H(68,"div",15),vM(69,i9,8,2,"div",16,yM),H(71,"button",17),se(72," Add makeup "),Y(),Ce(73,"router-outlet"),Y()),r&2&&(Ai(69),_M(i.products))},dependencies:[$c,al,Sp],styles:[".heading[_ngcontent-%COMP%]{background-color:#000;color:#fff}"]})}}return n})();var f1=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(js),Ne(Ti))}}static{this.\u0275dir=In({type:n})}}return n})(),s9=(()=>{class n extends f1{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Vc(n)))(i||n)}})()}static{this.\u0275dir=In({type:n,features:[Si]})}}return n})(),p1=new G("");var o9={provide:p1,useExisting:ha(()=>jg),multi:!0};function a9(){let n=Yr()?Yr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var u9=new G(""),jg=(()=>{class n extends f1{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!a9())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(js),Ne(Ti),Ne(u9,8))}}static{this.\u0275dir=In({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&wr("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[np([o9]),Si]})}}return n})();function Wi(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function g1(n){return n!=null&&typeof n.length=="number"}var m1=new G(""),y1=new G(""),c9=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Qa=class{static min(e){return l9(e)}static max(e){return d9(e)}static required(e){return h9(e)}static requiredTrue(e){return f9(e)}static email(e){return p9(e)}static minLength(e){return g9(e)}static maxLength(e){return m9(e)}static pattern(e){return y9(e)}static nullValidator(e){return v1(e)}static compose(e){return D1(e)}static composeAsync(e){return T1(e)}};function l9(n){return e=>{if(Wi(e.value)||Wi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function d9(n){return e=>{if(Wi(e.value)||Wi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function h9(n){return Wi(n.value)?{required:!0}:null}function f9(n){return n.value===!0?null:{required:!0}}function p9(n){return Wi(n.value)||c9.test(n.value)?null:{email:!0}}function g9(n){return e=>Wi(e.value)||!g1(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function m9(n){return e=>g1(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function y9(n){if(!n)return v1;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Wi(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function v1(n){return null}function _1(n){return n!=null}function w1(n){return Bs(n)?Me(n):n}function E1(n){let e={};return n.forEach(t=>{e=t!=null?z(z({},e),t):e}),Object.keys(e).length===0?null:e}function I1(n,e){return e.map(t=>t(n))}function v9(n){return!n.validate}function C1(n){return n.map(e=>v9(e)?e:t=>e.validate(t))}function D1(n){if(!n)return null;let e=n.filter(_1);return e.length==0?null:function(t){return E1(I1(t,e))}}function b1(n){return n!=null?D1(C1(n)):null}function T1(n){if(!n)return null;let e=n.filter(_1);return e.length==0?null:function(t){let r=I1(t,e).map(w1);return fv(r).pipe(Z(E1))}}function A1(n){return n!=null?T1(C1(n)):null}function s1(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function S1(n){return n._rawValidators}function R1(n){return n._rawAsyncValidators}function UC(n){return n?Array.isArray(n)?n:[n]:[]}function Pg(n,e){return Array.isArray(n)?n.includes(e):n===e}function o1(n,e){let t=UC(e);return UC(n).forEach(i=>{Pg(t,i)||t.push(i)}),t}function a1(n,e){return UC(e).filter(t=>!Pg(n,t))}var kg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=b1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=A1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ya=class extends kg{get formDirective(){return null}get path(){return null}},rd=class extends kg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Og=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},_9={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},iie=xe(z({},_9),{"[class.ng-submitted]":"isSubmitted"}),x1=(()=>{class n extends Og{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(rd,2))}}static{this.\u0275dir=In({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Xf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Si]})}}return n})(),M1=(()=>{class n extends Og{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(Ya,10))}}static{this.\u0275dir=In({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Xf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Si]})}}return n})();var td="VALID",Ng="INVALID",Ka="PENDING",nd="DISABLED";function qC(n){return(Ug(n)?n.validators:n)||null}function w9(n){return Array.isArray(n)?b1(n):n||null}function HC(n,e){return(Ug(e)?e.asyncValidators:n)||null}function E9(n){return Array.isArray(n)?A1(n):n||null}function Ug(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function N1(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ne(1e3,"");if(!r[t])throw new ne(1001,"")}function P1(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ne(1002,"")})}var Za=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===td}get invalid(){return this.status===Ng}get pending(){return this.status==Ka}get disabled(){return this.status===nd}get enabled(){return this.status!==nd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(o1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(o1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(a1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(a1(e,this._rawAsyncValidators))}hasValidator(e){return Pg(this._rawValidators,e)}hasAsyncValidator(e){return Pg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ka,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=nd,this.errors=null,this._forEachChild(r=>{r.disable(xe(z({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(xe(z({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=td,this._forEachChild(r=>{r.enable(xe(z({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(xe(z({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===td||this.status===Ka)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?nd:td}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ka,this._hasOwnPendingAsyncValidator=!0;let t=w1(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new jt,this.statusChanges=new jt}_calculateStatus(){return this._allControlsDisabled()?nd:this.errors?Ng:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ka)?Ka:this._anyControlsHaveStatus(Ng)?Ng:td}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ug(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=w9(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=E9(this._rawAsyncValidators)}},Fg=class extends Za{constructor(e,t,r){super(qC(t),HC(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){P1(this,!0,e),Object.keys(e).forEach(r=>{N1(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var BC=class extends Fg{};var k1=new G("CallSetDisabledState",{providedIn:"root",factory:()=>GC}),GC="always";function I9(n,e){return[...e.path,n]}function u1(n,e,t=GC){zC(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),D9(n,e),T9(n,e),b9(n,e),C9(n,e)}function c1(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Lg(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Vg(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function C9(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function zC(n,e){let t=S1(n);e.validator!==null?n.setValidators(s1(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=R1(n);e.asyncValidator!==null?n.setAsyncValidators(s1(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Vg(e._rawValidators,i),Vg(e._rawAsyncValidators,i)}function Lg(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=S1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=R1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return Vg(e._rawValidators,r),Vg(e._rawAsyncValidators,r),t}function D9(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&O1(n,e)})}function b9(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&O1(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function O1(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function T9(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function A9(n,e){n==null,zC(n,e)}function S9(n,e){return Lg(n,e)}function R9(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function x9(n){return Object.getPrototypeOf(n.constructor)===s9}function M9(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function N9(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===jg?t=s:x9(s)?r=s:i=s}),i||r||t||null}function P9(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function l1(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function d1(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var zi=class extends Za{constructor(e=null,t,r){super(qC(t),HC(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ug(t)&&(t.nonNullable||t.initialValueIsDefault)&&(d1(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){l1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){l1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){d1(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var k9=n=>n instanceof zi;var F1=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=In({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var V1=new G("");var O9={provide:Ya,useExisting:ha(()=>WC)},WC=(()=>{class n extends Ya{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new jt,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Lg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return u1(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){c1(t.control||null,t,!1),P9(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,M9(this.form,this.directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(c1(r||null,t),k9(i)&&(u1(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);A9(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&S9(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){zC(this.form,this),this._oldForm&&Lg(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||n)(Ne(m1,10),Ne(y1,10),Ne(k1,8))}}static{this.\u0275dir=In({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&wr("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[$t.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[np([O9]),Si,Di]})}}return n})();var F9={provide:rd,useExisting:ha(()=>KC)},KC=(()=>{class n extends rd{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new jt,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=N9(this,s)}ngOnChanges(t){this._added||this._setUpControl(),R9(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return I9(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||n)(Ne(Ya,13),Ne(m1,10),Ne(y1,10),Ne(p1,10),Ne(V1,8))}}static{this.\u0275dir=In({type:n,selectors:[["","formControlName",""]],inputs:{name:[$t.None,"formControlName","name"],isDisabled:[$t.None,"disabled","isDisabled"],model:[$t.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[np([F9]),Si,Di]})}}return n})();var V9=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Xt({type:n})}static{this.\u0275inj=Jt({})}}return n})(),$C=class extends Za{constructor(e,t,r){super(qC(t),HC(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){P1(this,!1,e),e.forEach((r,i)=>{N1(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function h1(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var L1=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return h1(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Fg(i,s)}record(t,r=null){let i=this._reduceControls(t);return new BC(i,r)}control(t,r,i){let s={};return this.useNonNullable?(h1(r)?s=r:(s.validators=r,s.asyncValidators=i),new zi(t,xe(z({},s),{nonNullable:!0}))):new zi(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new $C(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof zi)return t;if(t instanceof Za)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var j1=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:V1,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:k1,useValue:t.callSetDisabledState??GC}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Xt({type:n})}static{this.\u0275inj=Jt({imports:[V9]})}}return n})();function j9(n,e){n&1&&(H(0,"div",4),se(1,"Id is required"),Y())}function U9(n,e){n&1&&(H(0,"div",4),se(1,"name is required"),Y())}function B9(n,e){n&1&&(H(0,"div",4),se(1,"description is required"),Y())}var U1=(()=>{class n{constructor(t,r){this.fb=t,this.productService=r,this.makeupForm=this.fb.group({id:new zi("",[Qa.required]),name:new zi("",[Qa.required]),description:new zi("",[Qa.required])})}ngOnInit(){}onSubmit(){this.makeupForm.valid?this.productService.addProduct(this.makeupForm.value):this.makeupForm.markAllAsTouched()}static{this.\u0275fac=function(r){return new(r||n)(Ne(L1),Ne(Mg))}}static{this.\u0275cmp=Un({type:n,selectors:[["app-addmakeup"]],standalone:!0,features:[$n],decls:18,vars:4,consts:[[1,"ms-4",3,"submit","formGroup"],[1,"mb-3","mt-4"],["for","id",1,"form-label"],["type","text","formControlName","id","id","id",1,"form-control"],[1,"form-text","text-danger"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","formControlName","name","id","name",1,"form-control"],["for","description",1,"form-label"],["formControlName","description","id","description","rows","3",1,"form-control"],["type","submit",1,"btn","btn-primary"]],template:function(r,i){if(r&1&&(H(0,"form",0),wr("submit",function(){return i.onSubmit()}),H(1,"div",1)(2,"label",2),se(3,"Product Id"),Y(),Ce(4,"input",3),Os(5,j9,2,0,"div",4),Y(),H(6,"div",5)(7,"label",6),se(8,"Product Name"),Y(),Ce(9,"input",7),Os(10,U9,2,0,"div",4),Y(),H(11,"div",5)(12,"label",8),se(13,"Description"),Y(),Ce(14,"textarea",9),Os(15,B9,2,0,"div",4),Y(),H(16,"button",10),se(17,"SAVE"),Y()()),r&2){let s,o,a;pw("formGroup",i.makeupForm),Ai(5),ep(5,(s=i.makeupForm.get("id"))!=null&&s.hasError("required")&&((s=i.makeupForm.get("id"))!=null&&s.touched)?5:-1),Ai(5),ep(10,(o=i.makeupForm.get("name"))!=null&&o.hasError("required")&&((o=i.makeupForm.get("name"))!=null&&o.touched)?10:-1),Ai(5),ep(15,(a=i.makeupForm.get("description"))!=null&&a.hasError("required")&&((a=i.makeupForm.get("description"))!=null&&a.touched)?15:-1)}},dependencies:[$c,j1,F1,jg,x1,M1,WC,KC]})}}return n})();var B1=[{path:"",component:mE},{path:"home",component:mE},{path:"makeupproducts",component:i1,children:[{path:"addmakeup",component:U1}]}];var $1="auth",id=class{constructor(e){return e}},so=class{constructor(){return Ks($1)}};var QC=new G("angularfire2.auth-instances");function B5(n,e){let t=Ra($1,n,e);return t&&new id(t)}function $5(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new id(r)}}var q5={provide:so,deps:[[new at,QC]]},H5={provide:id,useFactory:B5,deps:[[new at,QC],rr]};function q1(n,...e){return it("angularfire",Dt.full,"auth"),en([H5,q5,{provide:QC,useFactory:$5(n),multi:!0,deps:[me,Ht,fn,Jr,[new at,nn],...e]}])}var H1=ki(Yy,!0);var G1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z1={};var Ki,YC;(function(){var n;function e(I,v){function E(){}E.prototype=v.prototype,I.D=v.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(C,b,S){for(var w=Array(arguments.length-2),jr=2;jr<arguments.length;jr++)w[jr-2]=arguments[jr];return v.prototype[b].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,E){E||(E=0);var C=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)C[b]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(b=0;16>b;++b)C[b]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=I.g[0],E=I.g[1],b=I.g[2];var S=I.g[3],w=v+(S^E&(b^S))+C[0]+3614090360&4294967295;v=E+(w<<7&4294967295|w>>>25),w=S+(b^v&(E^b))+C[1]+3905402710&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(E^S&(v^E))+C[2]+606105819&4294967295,b=S+(w<<17&4294967295|w>>>15),w=E+(v^b&(S^v))+C[3]+3250441966&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(S^E&(b^S))+C[4]+4118548399&4294967295,v=E+(w<<7&4294967295|w>>>25),w=S+(b^v&(E^b))+C[5]+1200080426&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(E^S&(v^E))+C[6]+2821735955&4294967295,b=S+(w<<17&4294967295|w>>>15),w=E+(v^b&(S^v))+C[7]+4249261313&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(S^E&(b^S))+C[8]+1770035416&4294967295,v=E+(w<<7&4294967295|w>>>25),w=S+(b^v&(E^b))+C[9]+2336552879&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(E^S&(v^E))+C[10]+4294925233&4294967295,b=S+(w<<17&4294967295|w>>>15),w=E+(v^b&(S^v))+C[11]+2304563134&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(S^E&(b^S))+C[12]+1804603682&4294967295,v=E+(w<<7&4294967295|w>>>25),w=S+(b^v&(E^b))+C[13]+4254626195&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(E^S&(v^E))+C[14]+2792965006&4294967295,b=S+(w<<17&4294967295|w>>>15),w=E+(v^b&(S^v))+C[15]+1236535329&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(b^S&(E^b))+C[1]+4129170786&4294967295,v=E+(w<<5&4294967295|w>>>27),w=S+(E^b&(v^E))+C[6]+3225465664&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(S^v))+C[11]+643717713&4294967295,b=S+(w<<14&4294967295|w>>>18),w=E+(S^v&(b^S))+C[0]+3921069994&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(E^b))+C[5]+3593408605&4294967295,v=E+(w<<5&4294967295|w>>>27),w=S+(E^b&(v^E))+C[10]+38016083&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(S^v))+C[15]+3634488961&4294967295,b=S+(w<<14&4294967295|w>>>18),w=E+(S^v&(b^S))+C[4]+3889429448&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(E^b))+C[9]+568446438&4294967295,v=E+(w<<5&4294967295|w>>>27),w=S+(E^b&(v^E))+C[14]+3275163606&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(S^v))+C[3]+4107603335&4294967295,b=S+(w<<14&4294967295|w>>>18),w=E+(S^v&(b^S))+C[8]+1163531501&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(E^b))+C[13]+2850285829&4294967295,v=E+(w<<5&4294967295|w>>>27),w=S+(E^b&(v^E))+C[2]+4243563512&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(S^v))+C[7]+1735328473&4294967295,b=S+(w<<14&4294967295|w>>>18),w=E+(S^v&(b^S))+C[12]+2368359562&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(E^b^S)+C[5]+4294588738&4294967295,v=E+(w<<4&4294967295|w>>>28),w=S+(v^E^b)+C[8]+2272392833&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^E)+C[11]+1839030562&4294967295,b=S+(w<<16&4294967295|w>>>16),w=E+(b^S^v)+C[14]+4259657740&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^S)+C[1]+2763975236&4294967295,v=E+(w<<4&4294967295|w>>>28),w=S+(v^E^b)+C[4]+1272893353&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^E)+C[7]+4139469664&4294967295,b=S+(w<<16&4294967295|w>>>16),w=E+(b^S^v)+C[10]+3200236656&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^S)+C[13]+681279174&4294967295,v=E+(w<<4&4294967295|w>>>28),w=S+(v^E^b)+C[0]+3936430074&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^E)+C[3]+3572445317&4294967295,b=S+(w<<16&4294967295|w>>>16),w=E+(b^S^v)+C[6]+76029189&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^S)+C[9]+3654602809&4294967295,v=E+(w<<4&4294967295|w>>>28),w=S+(v^E^b)+C[12]+3873151461&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^E)+C[15]+530742520&4294967295,b=S+(w<<16&4294967295|w>>>16),w=E+(b^S^v)+C[2]+3299628645&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(b^(E|~S))+C[0]+4096336452&4294967295,v=E+(w<<6&4294967295|w>>>26),w=S+(E^(v|~b))+C[7]+1126891415&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~E))+C[14]+2878612391&4294967295,b=S+(w<<15&4294967295|w>>>17),w=E+(S^(b|~v))+C[5]+4237533241&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~S))+C[12]+1700485571&4294967295,v=E+(w<<6&4294967295|w>>>26),w=S+(E^(v|~b))+C[3]+2399980690&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~E))+C[10]+4293915773&4294967295,b=S+(w<<15&4294967295|w>>>17),w=E+(S^(b|~v))+C[1]+2240044497&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~S))+C[8]+1873313359&4294967295,v=E+(w<<6&4294967295|w>>>26),w=S+(E^(v|~b))+C[15]+4264355552&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~E))+C[6]+2734768916&4294967295,b=S+(w<<15&4294967295|w>>>17),w=E+(S^(b|~v))+C[13]+1309151649&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~S))+C[4]+4149444226&4294967295,v=E+(w<<6&4294967295|w>>>26),w=S+(E^(v|~b))+C[11]+3174756917&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~E))+C[2]+718787259&4294967295,b=S+(w<<15&4294967295|w>>>17),w=E+(S^(b|~v))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+b&4294967295,I.g[3]=I.g[3]+S&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var E=v-this.blockSize,C=this.B,b=this.h,S=0;S<v;){if(b==0)for(;S<=E;)i(this,I,S),S+=this.blockSize;if(typeof I=="string"){for(;S<v;)if(C[b++]=I.charCodeAt(S++),b==this.blockSize){i(this,C),b=0;break}}else for(;S<v;)if(C[b++]=I[S++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var E=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=E&255,E/=256;for(this.u(I),I=Array(16),v=E=0;4>v;++v)for(var C=0;32>C;C+=8)I[E++]=this.g[v]>>>C&255;return I};function s(I,v){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=v(I)}function o(I,v){this.h=v;for(var E=[],C=!0,b=I.length-1;0<=b;b--){var S=I[b]|0;C&&S==v||(E[b]=S,C=!1)}this.g=E}var a={};function u(I){return-128<=I&&128>I?s(I,function(v){return new o([v|0],0>v?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return A(l(-I));for(var v=[],E=1,C=0;I>=E;C++)v[C]=I/E|0,E*=4294967296;return new o(v,0)}function d(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return A(d(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(v,8)),C=h,b=0;b<I.length;b+=8){var S=Math.min(8,I.length-b),w=parseInt(I.substring(b,b+S),v);8>S?(S=l(Math.pow(v,S)),C=C.j(S).add(l(w))):(C=C.j(E),C=C.add(l(w)))}return C}var h=u(0),g=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-A(this).m();for(var I=0,v=1,E=0;E<this.g.length;E++){var C=this.i(E);I+=(0<=C?C:4294967296+C)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(D(this))return"-"+A(this).toString(I);for(var v=l(Math.pow(I,6)),E=this,C="";;){var b=Q(E,v).g;E=P(E,b.j(v));var S=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=b,_(E))return S+C;for(;6>S.length;)S="0"+S;C=S+C}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=P(this,I),D(I)?-1:_(I)?0:1};function A(I){for(var v=I.g.length,E=[],C=0;C<v;C++)E[C]=~I.g[C];return new o(E,~I.h).add(g)}n.abs=function(){return D(this)?A(this):this},n.add=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0,b=0;b<=v;b++){var S=C+(this.i(b)&65535)+(I.i(b)&65535),w=(S>>>16)+(this.i(b)>>>16)+(I.i(b)>>>16);C=w>>>16,S&=65535,w&=65535,E[b]=w<<16|S}return new o(E,E[E.length-1]&-2147483648?-1:0)};function P(I,v){return I.add(A(v))}n.j=function(I){if(_(this)||_(I))return h;if(D(this))return D(I)?A(this).j(A(I)):A(A(this).j(I));if(D(I))return A(this.j(A(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var v=this.g.length+I.g.length,E=[],C=0;C<2*v;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<I.g.length;b++){var S=this.i(C)>>>16,w=this.i(C)&65535,jr=I.i(b)>>>16,Uu=I.i(b)&65535;E[2*C+2*b]+=w*Uu,U(E,2*C+2*b),E[2*C+2*b+1]+=S*Uu,U(E,2*C+2*b+1),E[2*C+2*b+1]+=w*jr,U(E,2*C+2*b+1),E[2*C+2*b+2]+=S*jr,U(E,2*C+2*b+2)}for(C=0;C<v;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=v;C<2*v;C++)E[C]=0;return new o(E,0)};function U(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function Q(I,v){if(_(v))throw Error("division by zero");if(_(I))return new F(h,h);if(D(I))return v=Q(A(I),v),new F(A(v.g),A(v.h));if(D(v))return v=Q(I,A(v)),new F(A(v.g),v.h);if(30<I.g.length){if(D(I)||D(v))throw Error("slowDivide_ only works with positive integers.");for(var E=g,C=v;0>=C.l(I);)E=re(E),C=re(C);var b=X(E,1),S=X(C,1);for(C=X(C,2),E=X(E,2);!_(C);){var w=S.add(C);0>=w.l(I)&&(b=b.add(E),S=w),C=X(C,1),E=X(E,1)}return v=P(I,b.j(v)),new F(b,v)}for(b=h;0<=I.l(v);){for(E=Math.max(1,Math.floor(I.m()/v.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),S=l(E),w=S.j(v);D(w)||0<w.l(I);)E-=C,S=l(E),w=S.j(v);_(S)&&(S=g),b=b.add(S),I=P(I,w)}return new F(b,I)}n.A=function(I){return Q(this,I).h},n.and=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)&I.i(C);return new o(E,this.h&I.h)},n.or=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)|I.i(C);return new o(E,this.h|I.h)},n.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)^I.i(C);return new o(E,this.h^I.h)};function re(I){for(var v=I.g.length+1,E=[],C=0;C<v;C++)E[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(E,I.h)}function X(I,v){var E=v>>5;v%=32;for(var C=I.g.length-E,b=[],S=0;S<C;S++)b[S]=0<v?I.i(S+E)>>>v|I.i(S+E+1)<<32-v:I.i(S+E);return new o(b,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,YC=z1.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Ki=z1.Integer=o}).apply(typeof G1<"u"?G1:typeof self<"u"?self:typeof window<"u"?window:{});var Bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ni={};var ZC,G5,Ja,JC,sd,$g,XC,eD,tD;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,p){return c==Array.prototype||c==Object.prototype||(c[f]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bg=="object"&&Bg];for(var f=0;f<c.length;++f){var p=c[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(c,f){if(f)e:{var p=r;c=c.split(".");for(var m=0;m<c.length-1;m++){var T=c[m];if(!(T in p))break e;p=p[T]}c=c[c.length-1],m=p[c],f=f(m),f!=m&&f!=null&&e(p,c,{configurable:!0,writable:!0,value:f})}}function s(c,f){c instanceof String&&(c+="");var p=0,m=!1,T={next:function(){if(!m&&p<c.length){var x=p++;return{value:f(x,c[x]),done:!1}}return m=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(c){return c||function(){return s(this,function(f,p){return p})}});var o=o||{},a=this||self;function u(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function l(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function d(c,f,p){return c.call.apply(c.bind,arguments)}function h(c,f,p){if(!c)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,m),c.apply(f,T)}}return function(){return c.apply(f,arguments)}}function g(c,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function y(c,f){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),c.apply(this,m)}}function _(c,f){function p(){}p.prototype=f.prototype,c.aa=f.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(m,T,x){for(var j=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)j[Ve-2]=arguments[Ve];return f.prototype[T].apply(m,j)}}function D(c){let f=c.length;if(0<f){let p=Array(f);for(let m=0;m<f;m++)p[m]=c[m];return p}return[]}function A(c,f){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(u(m)){let T=c.length||0,x=m.length||0;c.length=T+x;for(let j=0;j<x;j++)c[T+j]=m[j]}else c.push(m)}}class P{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function U(c){return/^[\s\xa0]*$/.test(c)}function F(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function Q(c){return Q[" "](c),c}Q[" "]=function(){};var re=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function X(c,f,p){for(let m in c)f.call(p,c[m],m,c)}function I(c,f){for(let p in c)f.call(void 0,c[p],p,c)}function v(c){let f={};for(let p in c)f[p]=c[p];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(c,f){let p,m;for(let T=1;T<arguments.length;T++){m=arguments[T];for(p in m)c[p]=m[p];for(let x=0;x<E.length;x++)p=E[x],Object.prototype.hasOwnProperty.call(m,p)&&(c[p]=m[p])}}function b(c){var f=1;c=c.split(":");let p=[];for(;0<f&&c.length;)p.push(c.shift()),f--;return c.length&&p.push(c.join(":")),p}function S(c){a.setTimeout(()=>{throw c},0)}function w(){var c=_y;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class jr{constructor(){this.h=this.g=null}add(f,p){let m=Uu.get();m.set(f,p),this.h?this.h.next=m:this.g=m,this.h=m}}var Uu=new P(()=>new iL,c=>c.reset());class iL{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Bu,$u=!1,_y=new jr,PT=()=>{let c=a.Promise.resolve(void 0);Bu=()=>{c.then(sL)}};var sL=()=>{for(var c;c=w();){try{c.h.call(c.g)}catch(p){S(p)}var f=Uu;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}$u=!1};function di(){this.s=this.s,this.C=this.C}di.prototype.s=!1,di.prototype.ma=function(){this.s||(this.s=!0,this.N())},di.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ot(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}Ot.prototype.h=function(){this.defaultPrevented=!0};var oL=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return c}();function qu(c,f){if(Ot.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,m=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(re){e:{try{Q(f.nodeName);var T=!0;break e}catch{}T=!1}T||(f=null)}}else p=="mouseover"?f=c.fromElement:p=="mouseout"&&(f=c.toElement);this.relatedTarget=f,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:aL[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&qu.aa.h.call(this)}}_(qu,Ot);var aL={2:"touch",3:"pen",4:"mouse"};qu.prototype.h=function(){qu.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Hu="closure_listenable_"+(1e6*Math.random()|0),uL=0;function cL(c,f,p,m,T){this.listener=c,this.proxy=null,this.src=f,this.type=p,this.capture=!!m,this.ha=T,this.key=++uL,this.da=this.fa=!1}function Wd(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Kd(c){this.src=c,this.g={},this.h=0}Kd.prototype.add=function(c,f,p,m,T){var x=c.toString();c=this.g[x],c||(c=this.g[x]=[],this.h++);var j=Ey(c,f,m,T);return-1<j?(f=c[j],p||(f.fa=!1)):(f=new cL(f,this.src,x,!!m,T),f.fa=p,c.push(f)),f};function wy(c,f){var p=f.type;if(p in c.g){var m=c.g[p],T=Array.prototype.indexOf.call(m,f,void 0),x;(x=0<=T)&&Array.prototype.splice.call(m,T,1),x&&(Wd(f),c.g[p].length==0&&(delete c.g[p],c.h--))}}function Ey(c,f,p,m){for(var T=0;T<c.length;++T){var x=c[T];if(!x.da&&x.listener==f&&x.capture==!!p&&x.ha==m)return T}return-1}var Iy="closure_lm_"+(1e6*Math.random()|0),Cy={};function kT(c,f,p,m,T){if(m&&m.once)return FT(c,f,p,m,T);if(Array.isArray(f)){for(var x=0;x<f.length;x++)kT(c,f[x],p,m,T);return null}return p=Ay(p),c&&c[Hu]?c.K(f,p,l(m)?!!m.capture:!!m,T):OT(c,f,p,!1,m,T)}function OT(c,f,p,m,T,x){if(!f)throw Error("Invalid event type");var j=l(T)?!!T.capture:!!T,Ve=by(c);if(Ve||(c[Iy]=Ve=new Kd(c)),p=Ve.add(f,p,m,j,x),p.proxy)return p;if(m=lL(),p.proxy=m,m.src=c,m.listener=p,c.addEventListener)oL||(T=j),T===void 0&&(T=!1),c.addEventListener(f.toString(),m,T);else if(c.attachEvent)c.attachEvent(LT(f.toString()),m);else if(c.addListener&&c.removeListener)c.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function lL(){function c(p){return f.call(c.src,c.listener,p)}let f=dL;return c}function FT(c,f,p,m,T){if(Array.isArray(f)){for(var x=0;x<f.length;x++)FT(c,f[x],p,m,T);return null}return p=Ay(p),c&&c[Hu]?c.L(f,p,l(m)?!!m.capture:!!m,T):OT(c,f,p,!0,m,T)}function VT(c,f,p,m,T){if(Array.isArray(f))for(var x=0;x<f.length;x++)VT(c,f[x],p,m,T);else m=l(m)?!!m.capture:!!m,p=Ay(p),c&&c[Hu]?(c=c.i,f=String(f).toString(),f in c.g&&(x=c.g[f],p=Ey(x,p,m,T),-1<p&&(Wd(x[p]),Array.prototype.splice.call(x,p,1),x.length==0&&(delete c.g[f],c.h--)))):c&&(c=by(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Ey(f,p,m,T)),(p=-1<c?f[c]:null)&&Dy(p))}function Dy(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[Hu])wy(f.i,c);else{var p=c.type,m=c.proxy;f.removeEventListener?f.removeEventListener(p,m,c.capture):f.detachEvent?f.detachEvent(LT(p),m):f.addListener&&f.removeListener&&f.removeListener(m),(p=by(f))?(wy(p,c),p.h==0&&(p.src=null,f[Iy]=null)):Wd(c)}}}function LT(c){return c in Cy?Cy[c]:Cy[c]="on"+c}function dL(c,f){if(c.da)c=!0;else{f=new qu(f,this);var p=c.listener,m=c.ha||c.src;c.fa&&Dy(c),c=p.call(m,f)}return c}function by(c){return c=c[Iy],c instanceof Kd?c:null}var Ty="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ay(c){return typeof c=="function"?c:(c[Ty]||(c[Ty]=function(f){return c.handleEvent(f)}),c[Ty])}function Ft(){di.call(this),this.i=new Kd(this),this.M=this,this.F=null}_(Ft,di),Ft.prototype[Hu]=!0,Ft.prototype.removeEventListener=function(c,f,p,m){VT(this,c,f,p,m)};function Kt(c,f){var p,m=c.F;if(m)for(p=[];m;m=m.F)p.push(m);if(c=c.M,m=f.type||f,typeof f=="string")f=new Ot(f,c);else if(f instanceof Ot)f.target=f.target||c;else{var T=f;f=new Ot(m,c),C(f,T)}if(T=!0,p)for(var x=p.length-1;0<=x;x--){var j=f.g=p[x];T=Qd(j,m,!0,f)&&T}if(j=f.g=c,T=Qd(j,m,!0,f)&&T,T=Qd(j,m,!1,f)&&T,p)for(x=0;x<p.length;x++)j=f.g=p[x],T=Qd(j,m,!1,f)&&T}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var p=c.g[f],m=0;m<p.length;m++)Wd(p[m]);delete c.g[f],c.h--}}this.F=null},Ft.prototype.K=function(c,f,p,m){return this.i.add(String(c),f,!1,p,m)},Ft.prototype.L=function(c,f,p,m){return this.i.add(String(c),f,!0,p,m)};function Qd(c,f,p,m){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var T=!0,x=0;x<f.length;++x){var j=f[x];if(j&&!j.da&&j.capture==p){var Ve=j.listener,At=j.ha||j.src;j.fa&&wy(c.i,j),T=Ve.call(At,m)!==!1&&T}}return T&&!m.defaultPrevented}function jT(c,f,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function UT(c){c.g=jT(()=>{c.g=null,c.i&&(c.i=!1,UT(c))},c.l);let f=c.h;c.h=null,c.m.apply(null,f)}class hL extends di{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:UT(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gu(c){di.call(this),this.h=c,this.g={}}_(Gu,di);var BT=[];function $T(c){X(c.g,function(f,p){this.g.hasOwnProperty(p)&&Dy(f)},c),c.g={}}Gu.prototype.N=function(){Gu.aa.N.call(this),$T(this)},Gu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Sy=a.JSON.stringify,fL=a.JSON.parse,pL=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Ry(){}Ry.prototype.h=null;function qT(c){return c.h||(c.h=c.i())}function HT(){}var zu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xy(){Ot.call(this,"d")}_(xy,Ot);function My(){Ot.call(this,"c")}_(My,Ot);var ps={},GT=null;function Yd(){return GT=GT||new Ft}ps.La="serverreachability";function zT(c){Ot.call(this,ps.La,c)}_(zT,Ot);function Wu(c){let f=Yd();Kt(f,new zT(f))}ps.STAT_EVENT="statevent";function WT(c,f){Ot.call(this,ps.STAT_EVENT,c),this.stat=f}_(WT,Ot);function Qt(c){let f=Yd();Kt(f,new WT(f,c))}ps.Ma="timingevent";function KT(c,f){Ot.call(this,ps.Ma,c),this.size=f}_(KT,Ot);function Ku(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function Qu(){this.g=!0}Qu.prototype.xa=function(){this.g=!1};function gL(c,f,p,m,T,x){c.info(function(){if(c.g)if(x)for(var j="",Ve=x.split("&"),At=0;At<Ve.length;At++){var Re=Ve[At].split("=");if(1<Re.length){var Vt=Re[0];Re=Re[1];var Lt=Vt.split("_");j=2<=Lt.length&&Lt[1]=="type"?j+(Vt+"="+Re+"&"):j+(Vt+"=redacted&")}}else j=null;else j=x;return"XMLHTTP REQ ("+m+") [attempt "+T+"]: "+f+`
`+p+`
`+j})}function mL(c,f,p,m,T,x,j){c.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+T+"]: "+f+`
`+p+`
`+x+" "+j})}function Po(c,f,p,m){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+vL(c,p)+(m?" "+m:"")})}function yL(c,f){c.info(function(){return"TIMEOUT: "+f})}Qu.prototype.info=function(){};function vL(c,f){if(!c.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var m=p[c];if(!(2>m.length)){var T=m[1];if(Array.isArray(T)&&!(1>T.length)){var x=T[0];if(x!="noop"&&x!="stop"&&x!="close")for(var j=1;j<T.length;j++)T[j]=""}}}}return Sy(p)}catch{return f}}var Zd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},QT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ny;function Jd(){}_(Jd,Ry),Jd.prototype.g=function(){return new XMLHttpRequest},Jd.prototype.i=function(){return{}},Ny=new Jd;function hi(c,f,p,m){this.j=c,this.i=f,this.l=p,this.R=m||1,this.U=new Gu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new YT}function YT(){this.i=null,this.g="",this.h=!1}var ZT={},Py={};function ky(c,f,p){c.L=1,c.v=nh(Ur(f)),c.m=p,c.P=!0,JT(c,null)}function JT(c,f){c.F=Date.now(),Xd(c),c.A=Ur(c.v);var p=c.A,m=c.R;Array.isArray(m)||(m=[String(m)]),hA(p.i,"t",m),c.C=0,p=c.j.J,c.h=new YT,c.g=xA(c.j,p?f:null,!c.m),0<c.O&&(c.M=new hL(g(c.Y,c,c.g),c.O)),f=c.U,p=c.g,m=c.ca;var T="readystatechange";Array.isArray(T)||(T&&(BT[0]=T.toString()),T=BT);for(var x=0;x<T.length;x++){var j=kT(p,T[x],m||f.handleEvent,!1,f.h||f);if(!j)break;f.g[j.key]=j}f=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Wu(),gL(c.i,c.u,c.A,c.l,c.R,c.m)}hi.prototype.ca=function(c){c=c.target;let f=this.M;f&&Br(c)==3?f.j():this.Y(c)},hi.prototype.Y=function(c){try{if(c==this.g)e:{let Lt=Br(this.g);var f=this.g.Ba();let Fo=this.g.Z();if(!(3>Lt)&&(Lt!=3||this.g&&(this.h.h||this.g.oa()||_A(this.g)))){this.J||Lt!=4||f==7||(f==8||0>=Fo?Wu(3):Wu(2)),Oy(this);var p=this.g.Z();this.X=p;t:if(XT(this)){var m=_A(this.g);c="";var T=m.length,x=Br(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gs(this),Yu(this);var j="";break t}this.h.i=new a.TextDecoder}for(f=0;f<T;f++)this.h.h=!0,c+=this.h.i.decode(m[f],{stream:!(x&&f==T-1)});m.length=0,this.h.g+=c,this.C=0,j=this.h.g}else j=this.g.oa();if(this.o=p==200,mL(this.i,this.u,this.A,this.l,this.R,Lt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ve,At=this.g;if((Ve=At.g?At.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Ve)){var Re=Ve;break t}}Re=null}if(p=Re)Po(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fy(this,p);else{this.o=!1,this.s=3,Qt(12),gs(this),Yu(this);break e}}if(this.P){p=!0;let Qn;for(;!this.J&&this.C<j.length;)if(Qn=_L(this,j),Qn==Py){Lt==4&&(this.s=4,Qt(14),p=!1),Po(this.i,this.l,null,"[Incomplete Response]");break}else if(Qn==ZT){this.s=4,Qt(15),Po(this.i,this.l,j,"[Invalid Chunk]"),p=!1;break}else Po(this.i,this.l,Qn,null),Fy(this,Qn);if(XT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Lt!=4||j.length!=0||this.h.h||(this.s=1,Qt(16),p=!1),this.o=this.o&&p,!p)Po(this.i,this.l,j,"[Invalid Chunked Response]"),gs(this),Yu(this);else if(0<j.length&&!this.W){this.W=!0;var Vt=this.j;Vt.g==this&&Vt.ba&&!Vt.M&&(Vt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),$y(Vt),Vt.M=!0,Qt(11))}}else Po(this.i,this.l,j,null),Fy(this,j);Lt==4&&gs(this),this.o&&!this.J&&(Lt==4?TA(this.j,this):(this.o=!1,Xd(this)))}else FL(this.g),p==400&&0<j.indexOf("Unknown SID")?(this.s=3,Qt(12)):(this.s=0,Qt(13)),gs(this),Yu(this)}}}catch{}finally{}};function XT(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function _L(c,f){var p=c.C,m=f.indexOf(`
`,p);return m==-1?Py:(p=Number(f.substring(p,m)),isNaN(p)?ZT:(m+=1,m+p>f.length?Py:(f=f.slice(m,m+p),c.C=m+p,f)))}hi.prototype.cancel=function(){this.J=!0,gs(this)};function Xd(c){c.S=Date.now()+c.I,eA(c,c.I)}function eA(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Ku(g(c.ba,c),f)}function Oy(c){c.B&&(a.clearTimeout(c.B),c.B=null)}hi.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(yL(this.i,this.A),this.L!=2&&(Wu(),Qt(17)),gs(this),this.s=2,Yu(this)):eA(this,this.S-c)};function Yu(c){c.j.G==0||c.J||TA(c.j,c)}function gs(c){Oy(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,$T(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Fy(c,f){try{var p=c.j;if(p.G!=0&&(p.g==c||Vy(p.h,c))){if(!c.K&&Vy(p.h,c)&&p.G==3){try{var m=p.Da.g.parse(f)}catch{m=null}if(Array.isArray(m)&&m.length==3){var T=m;if(T[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)ah(p),sh(p);else break e;By(p),Qt(18)}}else p.za=T[1],0<p.za-p.T&&37500>T[2]&&p.F&&p.v==0&&!p.C&&(p.C=Ku(g(p.Za,p),6e3));if(1>=rA(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else ys(p,11)}else if((c.K||p.g==c)&&ah(p),!U(f))for(T=p.Da.g.parse(f),f=0;f<T.length;f++){let Re=T[f];if(p.T=Re[0],Re=Re[1],p.G==2)if(Re[0]=="c"){p.K=Re[1],p.ia=Re[2];let Vt=Re[3];Vt!=null&&(p.la=Vt,p.j.info("VER="+p.la));let Lt=Re[4];Lt!=null&&(p.Aa=Lt,p.j.info("SVER="+p.Aa));let Fo=Re[5];Fo!=null&&typeof Fo=="number"&&0<Fo&&(m=1.5*Fo,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let Qn=c.g;if(Qn){let ch=Qn.g?Qn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ch){var x=m.h;x.g||ch.indexOf("spdy")==-1&&ch.indexOf("quic")==-1&&ch.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(Ly(x,x.h),x.h=null))}if(m.D){let qy=Qn.g?Qn.g.getResponseHeader("X-HTTP-Session-Id"):null;qy&&(m.ya=qy,He(m.I,m.D,qy))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var j=c;if(m.qa=RA(m,m.J?m.ia:null,m.W),j.K){iA(m.h,j);var Ve=j,At=m.L;At&&(Ve.I=At),Ve.B&&(Oy(Ve),Xd(Ve)),m.g=j}else DA(m);0<p.i.length&&oh(p)}else Re[0]!="stop"&&Re[0]!="close"||ys(p,7);else p.G==3&&(Re[0]=="stop"||Re[0]=="close"?Re[0]=="stop"?ys(p,7):Uy(p):Re[0]!="noop"&&p.l&&p.l.ta(Re),p.v=0)}}Wu(4)}catch{}}var wL=class{constructor(c,f){this.g=c,this.map=f}};function tA(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function nA(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function rA(c){return c.h?1:c.g?c.g.size:0}function Vy(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Ly(c,f){c.g?c.g.add(f):c.h=f}function iA(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}tA.prototype.cancel=function(){if(this.i=sA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function sA(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(let p of c.g.values())f=f.concat(p.D);return f}return D(c.i)}function EL(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var f=[],p=c.length,m=0;m<p;m++)f.push(c[m]);return f}f=[],p=0;for(m in c)f[p++]=c[m];return f}function IL(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var f=[];c=c.length;for(var p=0;p<c;p++)f.push(p);return f}f=[],p=0;for(let m in c)f[p++]=m;return f}}}function oA(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var p=IL(c),m=EL(c),T=m.length,x=0;x<T;x++)f.call(void 0,m[x],p&&p[x],c)}var aA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function CL(c,f){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var m=c[p].indexOf("="),T=null;if(0<=m){var x=c[p].substring(0,m);T=c[p].substring(m+1)}else x=c[p];f(x,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function ms(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof ms){this.h=c.h,eh(this,c.j),this.o=c.o,this.g=c.g,th(this,c.s),this.l=c.l;var f=c.i,p=new Xu;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),uA(this,p),this.m=c.m}else c&&(f=String(c).match(aA))?(this.h=!1,eh(this,f[1]||"",!0),this.o=Zu(f[2]||""),this.g=Zu(f[3]||"",!0),th(this,f[4]),this.l=Zu(f[5]||"",!0),uA(this,f[6]||"",!0),this.m=Zu(f[7]||"")):(this.h=!1,this.i=new Xu(null,this.h))}ms.prototype.toString=function(){var c=[],f=this.j;f&&c.push(Ju(f,cA,!0),":");var p=this.g;return(p||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Ju(f,cA,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Ju(p,p.charAt(0)=="/"?TL:bL,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Ju(p,SL)),c.join("")};function Ur(c){return new ms(c)}function eh(c,f,p){c.j=p?Zu(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function th(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function uA(c,f,p){f instanceof Xu?(c.i=f,RL(c.i,c.h)):(p||(f=Ju(f,AL)),c.i=new Xu(f,c.h))}function He(c,f,p){c.i.set(f,p)}function nh(c){return He(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Zu(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ju(c,f,p){return typeof c=="string"?(c=encodeURI(c).replace(f,DL),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function DL(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var cA=/[#\/\?@]/g,bL=/[#\?:]/g,TL=/[#\?]/g,AL=/[#\?@]/g,SL=/#/g;function Xu(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function fi(c){c.g||(c.g=new Map,c.h=0,c.i&&CL(c.i,function(f,p){c.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=Xu.prototype,n.add=function(c,f){fi(this),this.i=null,c=ko(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(f),this.h+=1,this};function lA(c,f){fi(c),f=ko(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function dA(c,f){return fi(c),f=ko(c,f),c.g.has(f)}n.forEach=function(c,f){fi(this),this.g.forEach(function(p,m){p.forEach(function(T){c.call(f,T,m,this)},this)},this)},n.na=function(){fi(this);let c=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let m=0;m<f.length;m++){let T=c[m];for(let x=0;x<T.length;x++)p.push(f[m])}return p},n.V=function(c){fi(this);let f=[];if(typeof c=="string")dA(this,c)&&(f=f.concat(this.g.get(ko(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)f=f.concat(c[p])}return f},n.set=function(c,f){return fi(this),this.i=null,c=ko(this,c),dA(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},n.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function hA(c,f,p){lA(c,f),0<p.length&&(c.i=null,c.g.set(ko(c,f),D(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var m=f[p];let x=encodeURIComponent(String(m)),j=this.V(m);for(m=0;m<j.length;m++){var T=x;j[m]!==""&&(T+="="+encodeURIComponent(String(j[m]))),c.push(T)}}return this.i=c.join("&")};function ko(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function RL(c,f){f&&!c.j&&(fi(c),c.i=null,c.g.forEach(function(p,m){var T=m.toLowerCase();m!=T&&(lA(this,m),hA(this,T,p))},c)),c.j=f}function xL(c,f){let p=new Qu;if(a.Image){let m=new Image;m.onload=y(pi,p,"TestLoadImage: loaded",!0,f,m),m.onerror=y(pi,p,"TestLoadImage: error",!1,f,m),m.onabort=y(pi,p,"TestLoadImage: abort",!1,f,m),m.ontimeout=y(pi,p,"TestLoadImage: timeout",!1,f,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=c}else f(!1)}function ML(c,f){let p=new Qu,m=new AbortController,T=setTimeout(()=>{m.abort(),pi(p,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:m.signal}).then(x=>{clearTimeout(T),x.ok?pi(p,"TestPingServer: ok",!0,f):pi(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(T),pi(p,"TestPingServer: error",!1,f)})}function pi(c,f,p,m,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),m(p)}catch{}}function NL(){this.g=new pL}function PL(c,f,p){let m=p||"";try{oA(c,function(T,x){let j=T;l(T)&&(j=Sy(T)),f.push(m+x+"="+encodeURIComponent(j))})}catch(T){throw f.push(m+"type="+encodeURIComponent("_badmap")),T}}function ec(c){this.l=c.Ub||null,this.j=c.eb||!1}_(ec,Ry),ec.prototype.g=function(){return new rh(this.l,this.j)},ec.prototype.i=function(c){return function(){return c}}({});function rh(c,f){Ft.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(rh,Ft),n=rh.prototype,n.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,nc(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,tc(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,nc(this)),this.g&&(this.readyState=3,nc(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fA(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function fA(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?tc(this):nc(this),this.readyState==3&&fA(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,tc(this))},n.Qa=function(c){this.g&&(this.response=c,tc(this))},n.ga=function(){this.g&&tc(this)};function tc(c){c.readyState=4,c.l=null,c.j=null,c.v=null,nc(c)}n.setRequestHeader=function(c,f){this.u.append(c,f)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=f.next();return c.join(`\r
`)};function nc(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(rh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function pA(c){let f="";return X(c,function(p,m){f+=m,f+=":",f+=p,f+=`\r
`}),f}function jy(c,f,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=pA(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):He(c,f,p))}function et(c){Ft.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(et,Ft);var kL=/^https?$/i,OL=["POST","PUT"];n=et.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,f,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ny.g(),this.v=this.o?qT(this.o):qT(Ny),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(x){gA(this,x);return}if(c=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var T in m)p.set(T,m[T]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let x of m.keys())p.set(x,m.get(x));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(x=>x.toLowerCase()=="content-type"),T=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(OL,f,void 0))||m||T||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[x,j]of p)this.g.setRequestHeader(x,j);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vA(this),this.u=!0,this.g.send(c),this.u=!1}catch(x){gA(this,x)}};function gA(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,mA(c),ih(c)}function mA(c){c.A||(c.A=!0,Kt(c,"complete"),Kt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Kt(this,"complete"),Kt(this,"abort"),ih(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ih(this,!0)),et.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?yA(this):this.bb())},n.bb=function(){yA(this)};function yA(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Br(c)!=4||c.Z()!=2)){if(c.u&&Br(c)==4)jT(c.Ea,0,c);else if(Kt(c,"readystatechange"),Br(c)==4){c.h=!1;try{let j=c.Z();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var m;if(m=j===0){var T=String(c.D).match(aA)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),m=!kL.test(T?T.toLowerCase():"")}p=m}if(p)Kt(c,"complete"),Kt(c,"success");else{c.m=6;try{var x=2<Br(c)?c.g.statusText:""}catch{x=""}c.l=x+" ["+c.Z()+"]",mA(c)}}finally{ih(c)}}}}function ih(c,f){if(c.g){vA(c);let p=c.g,m=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||Kt(c,"ready");try{p.onreadystatechange=m}catch{}}}function vA(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Br(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Br(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),fL(f)}};function _A(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function FL(c){let f={};c=(c.g&&2<=Br(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<c.length;m++){if(U(c[m]))continue;var p=b(c[m]);let T=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let x=f[T]||[];f[T]=x,x.push(p)}I(f,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function rc(c,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||f}function wA(c){this.Aa=0,this.i=[],this.j=new Qu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rc("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rc("baseRetryDelayMs",5e3,c),this.cb=rc("retryDelaySeedMs",1e4,c),this.Wa=rc("forwardChannelMaxRetries",2,c),this.wa=rc("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new tA(c&&c.concurrentRequestLimit),this.Da=new NL,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=wA.prototype,n.la=8,n.G=1,n.connect=function(c,f,p,m){Qt(0),this.W=c,this.H=f||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=RA(this,null,this.W),oh(this)};function Uy(c){if(EA(c),c.G==3){var f=c.U++,p=Ur(c.I);if(He(p,"SID",c.K),He(p,"RID",f),He(p,"TYPE","terminate"),ic(c,p),f=new hi(c,c.j,f),f.L=2,f.v=nh(Ur(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=xA(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Xd(f)}SA(c)}function sh(c){c.g&&($y(c),c.g.cancel(),c.g=null)}function EA(c){sh(c),c.u&&(a.clearTimeout(c.u),c.u=null),ah(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function oh(c){if(!nA(c.h)&&!c.s){c.s=!0;var f=c.Ga;Bu||PT(),$u||(Bu(),$u=!0),_y.add(f,c),c.B=0}}function VL(c,f){return rA(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Ku(g(c.Ga,c,f),AA(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let T=new hi(this,this.j,c),x=this.o;if(this.S&&(x?(x=v(x),C(x,this.S)):x=this.S),this.m!==null||this.O||(T.H=x,x=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(f+=m,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=CA(this,T,f),p=Ur(this.I),He(p,"RID",c),He(p,"CVER",22),this.D&&He(p,"X-HTTP-Session-Id",this.D),ic(this,p),x&&(this.O?f="headers="+encodeURIComponent(String(pA(x)))+"&"+f:this.m&&jy(p,this.m,x)),Ly(this.h,T),this.Ua&&He(p,"TYPE","init"),this.P?(He(p,"$req",f),He(p,"SID","null"),T.T=!0,ky(T,p,null)):ky(T,p,f),this.G=2}}else this.G==3&&(c?IA(this,c):this.i.length==0||nA(this.h)||IA(this))};function IA(c,f){var p;f?p=f.l:p=c.U++;let m=Ur(c.I);He(m,"SID",c.K),He(m,"RID",p),He(m,"AID",c.T),ic(c,m),c.m&&c.o&&jy(m,c.m,c.o),p=new hi(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),f&&(c.i=f.D.concat(c.i)),f=CA(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Ly(c.h,p),ky(p,m,f)}function ic(c,f){c.H&&X(c.H,function(p,m){He(f,m,p)}),c.l&&oA({},function(p,m){He(f,m,p)})}function CA(c,f,p){p=Math.min(c.i.length,p);var m=c.l?g(c.l.Na,c.l,c):null;e:{var T=c.i;let x=-1;for(;;){let j=["count="+p];x==-1?0<p?(x=T[0].g,j.push("ofs="+x)):x=0:j.push("ofs="+x);let Ve=!0;for(let At=0;At<p;At++){let Re=T[At].g,Vt=T[At].map;if(Re-=x,0>Re)x=Math.max(0,T[At].g-100),Ve=!1;else try{PL(Vt,j,"req"+Re+"_")}catch{m&&m(Vt)}}if(Ve){m=j.join("&");break e}}}return c=c.i.splice(0,p),f.D=c,m}function DA(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;Bu||PT(),$u||(Bu(),$u=!0),_y.add(f,c),c.v=0}}function By(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Ku(g(c.Fa,c),AA(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,bA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Ku(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qt(10),sh(this),bA(this))};function $y(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function bA(c){c.g=new hi(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=Ur(c.qa);He(f,"RID","rpc"),He(f,"SID",c.K),He(f,"AID",c.T),He(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&He(f,"TO",c.ja),He(f,"TYPE","xmlhttp"),ic(c,f),c.m&&c.o&&jy(f,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=nh(Ur(f)),p.m=null,p.P=!0,JT(p,c)}n.Za=function(){this.C!=null&&(this.C=null,sh(this),By(this),Qt(19))};function ah(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function TA(c,f){var p=null;if(c.g==f){ah(c),$y(c),c.g=null;var m=2}else if(Vy(c.h,f))p=f.D,iA(c.h,f),m=1;else return;if(c.G!=0){if(f.o)if(m==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var T=c.B;m=Yd(),Kt(m,new KT(m,p)),oh(c)}else DA(c);else if(T=f.s,T==3||T==0&&0<f.X||!(m==1&&VL(c,f)||m==2&&By(c)))switch(p&&0<p.length&&(f=c.h,f.i=f.i.concat(p)),T){case 1:ys(c,5);break;case 4:ys(c,10);break;case 3:ys(c,6);break;default:ys(c,2)}}}function AA(c,f){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*f}function ys(c,f){if(c.j.info("Error code "+f),f==2){var p=g(c.fb,c),m=c.Xa;let T=!m;m=new ms(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||eh(m,"https"),nh(m),T?xL(m.toString(),p):ML(m.toString(),p)}else Qt(2);c.G=0,c.l&&c.l.sa(f),SA(c),EA(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function SA(c){if(c.G=0,c.ka=[],c.l){let f=sA(c.h);(f.length!=0||c.i.length!=0)&&(A(c.ka,f),A(c.ka,c.i),c.h.i.length=0,D(c.i),c.i.length=0),c.l.ra()}}function RA(c,f,p){var m=p instanceof ms?Ur(p):new ms(p);if(m.g!="")f&&(m.g=f+"."+m.g),th(m,m.s);else{var T=a.location;m=T.protocol,f=f?f+"."+T.hostname:T.hostname,T=+T.port;var x=new ms(null);m&&eh(x,m),f&&(x.g=f),T&&th(x,T),p&&(x.l=p),m=x}return p=c.D,f=c.ya,p&&f&&He(m,p,f),He(m,"VER",c.la),ic(c,m),m}function xA(c,f,p){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new et(new ec({eb:p})):new et(c.pa),f.Ha(c.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function MA(){}n=MA.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function uh(){}uh.prototype.g=function(c,f){return new gn(c,f)};function gn(c,f){Ft.call(this),this.g=new wA(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!U(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!U(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Oo(this)}_(gn,Ft),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Uy(this.g)},gn.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=Sy(c),c=p);f.i.push(new wL(f.Ya++,c)),f.G==3&&oh(f)},gn.prototype.N=function(){this.g.l=null,delete this.j,Uy(this.g),delete this.g,gn.aa.N.call(this)};function NA(c){xy.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(let p in f){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}_(NA,xy);function PA(){My.call(this),this.status=1}_(PA,My);function Oo(c){this.g=c}_(Oo,MA),Oo.prototype.ua=function(){Kt(this.g,"a")},Oo.prototype.ta=function(c){Kt(this.g,new NA(c))},Oo.prototype.sa=function(c){Kt(this.g,new PA)},Oo.prototype.ra=function(){Kt(this.g,"b")},uh.prototype.createWebChannel=uh.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,tD=ni.createWebChannelTransport=function(){return new uh},eD=ni.getStatEventTarget=function(){return Yd()},XC=ni.Event=ps,$g=ni.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zd.NO_ERROR=0,Zd.TIMEOUT=8,Zd.HTTP_ERROR=6,sd=ni.ErrorCode=Zd,QT.COMPLETE="complete",JC=ni.EventType=QT,HT.EventType=zu,zu.OPEN="a",zu.CLOSE="b",zu.ERROR="c",zu.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,Ja=ni.WebChannel=HT,G5=ni.FetchXmlHttpFactory=ec,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,ZC=ni.XhrIo=et}).apply(typeof Bg<"u"?Bg:typeof self<"u"?self:typeof window<"u"?window:{});var W1="@firebase/firestore";var mt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");var Ru="10.14.0";var ts=new mi("@firebase/firestore");function ru(){return ts.logLevel}function o0(n){ts.setLogLevel(n)}function O(n,...e){if(ts.logLevel<=On.DEBUG){let t=e.map(a0);ts.debug(`Firestore (${Ru}): ${n}`,...t)}}function ut(n,...e){if(ts.logLevel<=On.ERROR){let t=e.map(a0);ts.error(`Firestore (${Ru}): ${n}`,...t)}}function ar(n,...e){if(ts.logLevel<=On.WARN){let t=e.map(a0);ts.warn(`Firestore (${Ru}): ${n}`,...t)}}function a0(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function W(n="Unexpected state"){let e=`FIRESTORE (${Ru}) INTERNAL ASSERTION FAILED: `+n;throw ut(e),new Error(e)}function K(n,e){n||W()}function YO(n,e){n||W()}function $(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends BA{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Jg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},aD=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mt.UNAUTHENTICATED))}shutdown(){}},uD=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},cD=class{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){K(this.o===void 0);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new Et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>M(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Et)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new Jg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new mt(e)}},lD=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},dD=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new lD(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},hD=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},fD=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){K(this.o===void 0);let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(K(typeof t.token=="string"),this.R=t.token,new hD(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function z5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Xg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=z5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function le(n,e){return n<e?-1:n>e?1:0}function hu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function ZO(n){return n+"\0"}var Je=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Je(0,0))}static max(){return new n(new Je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var em=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(),r===void 0?r=e.length-t:r>e.length-t&&W(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ae=class n extends em{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},W5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ct=class n extends em{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return W5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new k(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new k(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ae.fromString(e))}static fromName(e){return new n(Ae.fromString(e).popFirst(5))}static empty(){return new n(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ae(e.slice()))}};var fu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function pD(n){return n.fields.find(e=>e.kind===2)}function ao(n){return n.fields.filter(e=>e.kind!==2)}fu.UNKNOWN_ID=-1;var cu=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var yd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Wn.min())}};function JO(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=J.fromTimestamp(r===1e9?new Je(t+1,0):new Je(t,r));return new Wn(i,q.empty(),e)}function XO(n){return new Wn(n.readTime,n.key,-1)}var Wn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(J.min(),q.empty(),-1)}static max(){return new n(J.max(),q.empty(),-1)}};function u0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}var eF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",tm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ds(n){return M(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==eF)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let l=u;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var nm=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new po(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=c0(r.target.error);this.V.reject(new po(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new po(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new mD(t)}},ns=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(sc())===12.2&&ut("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),uo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ph())return!1;if(n.v())return!0;let e=sc(),t=n.S(e),r=0<t&&t<10,i=tF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return M(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new po(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new k(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new k(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new po(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return M(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=nm.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),R.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function tF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var gD=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return uo(this.B.delete())}},po=class extends k{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function hs(n){return n.name==="IndexedDbTransactionError"}var mD=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(O("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),uo(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),uo(this.store.add(e))}get(e){return uo(this.store.get(e)).next(t=>(t===void 0&&(t=null),O("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),uo(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),uo(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new R((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){O("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{let o=c0(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new R((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new gD(a),l=t(a.primaryKey,a.value,u);if(l instanceof R){let d=l.catch(h=>(u.done(),R.reject(h)));r.push(d)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function uo(n){return new R((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=c0(r.target.error);t(i)}})}var K1=!1;function c0(n){let e=ns.S(sc());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return K1||(K1=!0,setTimeout(()=>{throw r},0)),r}}return n}var yD=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>M(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){hs(t)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield ds(t)}yield this.X(6e4)}))}},vD=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return M(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(O("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=XO(s);u0(o,r)>0&&(r=o)}),new Wn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Nn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ld(n){return n==null}function vd(n){return n===0&&1/n==-1/0}function nF(n){return typeof n=="number"&&Number.isInteger(n)&&!vd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function an(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Q1(e)),e=K5(n.get(t),e);return Q1(e)}function K5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Q1(n){return n+""}function Sr(n){let e=n.length;if(K(e>=2),e===2)return K(n.charAt(0)===""&&n.charAt(1)===""),Ae.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&W(),n.charAt(o+1)){case"":let a=n.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:W()}s=o+2}return new Ae(r)}var Y1=["userId","batchId"];function Wg(n,e){return[n,an(e)]}function rF(n,e,t){return[n,an(e),t]}var Q5={},Y5=["prefixPath","collectionGroup","readTime","documentId"],Z5=["prefixPath","collectionGroup","documentId"],J5=["collectionGroup","readTime","prefixPath","documentId"],X5=["canonicalId","targetId"],e6=["targetId","path"],t6=["path","targetId"],n6=["collectionId","parent"],r6=["indexId","uid"],i6=["uid","sequenceNumber"],s6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],o6=["indexId","uid","orderedDocumentKey"],a6=["userId","collectionPath","documentId"],u6=["userId","collectionPath","largestBatchId"],c6=["userId","collectionGroup","largestBatchId"],iF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],l6=[...iF,"documentOverlays"],sF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],oF=sF,l0=[...oF,"indexConfiguration","indexState","indexEntries"],d6=l0,h6=[...l0,"globals"];var _d=class extends tm{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function It(n,e){let t=$(n);return ns.F(t._e,e)}function Z1(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function To(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ze=class n{constructor(e,t){this.comparator=e,this.root=t||xr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uu(this.root,e,this.comparator,!1)}getReverseIterator(){return new uu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uu(this.root,e,this.comparator,!0)}},uu=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},xr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};xr.EMPTY=null,xr.RED=!0,xr.BLACK=!1;xr.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,r,i,s){return this}insert(e,t,r){return new xr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Be=class n{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rm(this.data.getIterator())}getIteratorFrom(e){return new rm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},rm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Xa(n){return n.hasNext()?n.getNext():void 0}var Pn=class n{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new n([])}unionWith(e){let t=new Be(ct.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hu(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var im=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function uF(){return typeof atob<"u"}var dt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new im("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};dt.EMPTY_BYTE_STRING=new dt("");var f6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function si(n){if(K(!!n),typeof n=="string"){let e=0,t=f6.exec(n);if(K(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function rs(n){return typeof n=="string"?dt.fromBase64String(n):dt.fromUint8Array(n)}function Qm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function d0(n){let e=n.mapValue.fields.__previous_value__;return Qm(e)?d0(e):e}function wd(n){let e=si(n.mapValue.fields.__local_write_time__.timestampValue);return new Je(e.seconds,e.nanos)}var _D=class{constructor(e,t,r,i,s,o,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},is=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kg={nullValue:"NULL_VALUE"};function go(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Qm(n)?4:cF(n)?9007199254740991:Ym(n)?10:11:W()}function Pr(n,e){if(n===e)return!0;let t=go(n);if(t!==go(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wd(n).isEqual(wd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=si(i.timestampValue),a=si(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return rs(i.bytesValue).isEqual(rs(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Qe(i.geoPointValue.latitude)===Qe(s.geoPointValue.latitude)&&Qe(i.geoPointValue.longitude)===Qe(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Qe(i.integerValue)===Qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Qe(i.doubleValue),a=Qe(s.doubleValue);return o===a?vd(o)===vd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return hu(n.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Z1(o)!==Z1(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Pr(o[u],a[u])))return!1;return!0}(n,e);default:return W()}}function Ed(n,e){return(n.values||[]).find(t=>Pr(t,e))!==void 0}function ss(n,e){if(n===e)return 0;let t=go(n),r=go(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Qe(s.integerValue||s.doubleValue),u=Qe(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return J1(n.timestampValue,e.timestampValue);case 4:return J1(wd(n),wd(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(s,o){let a=rs(s),u=rs(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){let d=le(a[l],u[l]);if(d!==0)return d}return le(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=le(Qe(s.latitude),Qe(o.latitude));return a!==0?a:le(Qe(s.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return X1(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,u,l,d;let h=s.fields||{},g=o.fields||{},y=(a=h.value)===null||a===void 0?void 0:a.arrayValue,_=(u=g.value)===null||u===void 0?void 0:u.arrayValue,D=le(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((d=_?.values)===null||d===void 0?void 0:d.length)||0);return D!==0?D:X1(y,_)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Xi.mapValue&&o===Xi.mapValue)return 0;if(s===Xi.mapValue)return 1;if(o===Xi.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let h=0;h<u.length&&h<d.length;++h){let g=le(u[h],d[h]);if(g!==0)return g;let y=ss(a[u[h]],l[d[h]]);if(y!==0)return y}return le(u.length,d.length)}(n.mapValue,e.mapValue);default:throw W()}}function J1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);let t=si(n),r=si(e),i=le(t.seconds,r.seconds);return i!==0?i:le(t.nanos,r.nanos)}function X1(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ss(t[i],r[i]);if(s)return s}return le(t.length,r.length)}function pu(n){return wD(n)}function wD(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=si(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return rs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=wD(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${wD(t.fields[o])}`;return i+"}"}(n.mapValue):W()}function mo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ED(n){return!!n&&"integerValue"in n}function Id(n){return!!n&&"arrayValue"in n}function eO(n){return!!n&&"nullValue"in n}function tO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Qg(n){return!!n&&"mapValue"in n}function Ym(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function hd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return To(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=hd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var lF={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function p6(n){return"nullValue"in n?Kg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?mo(is.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ym(n)?lF:{mapValue:{}}:W()}function g6(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?mo(is.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?lF:"mapValue"in n?Ym(n)?{mapValue:{}}:Xi:W()}function nO(n,e){let t=ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function rO(n,e){let t=ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Wt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Qg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=ct.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=hd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Qg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Qg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){To(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(hd(this.value))}};function dF(n){let e=[];return To(n.fields,(t,r)=>{let i=new ct([t]);if(Qg(r)){let s=dF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Pn(e)}var yt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,J.min(),J.min(),J.min(),Wt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,J.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,J.min(),J.min(),Wt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,J.min(),J.min(),Wt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var kr=class{constructor(e,t){this.position=e,this.inclusive=t}};function iO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),t.key):r=ss(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function sO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Pr(n.position[t],e.position[t]))return!1;return!0}var yo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function m6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var sm=class{},De=class n extends sm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new DD(e,t,r):t==="array-contains"?new AD(e,r):t==="in"?new om(e,r):t==="not-in"?new SD(e,r):t==="array-contains-any"?new RD(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bD(e,r):new TD(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ss(t,this.value)):t!==null&&go(this.value)===go(t)&&this.matchesComparison(ss(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fe=class n extends sm{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return gu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function gu(n){return n.op==="and"}function ID(n){return n.op==="or"}function h0(n){return hF(n)&&gu(n)}function hF(n){for(let e of n.filters)if(e instanceof Fe)return!1;return!0}function CD(n){if(n instanceof De)return n.field.canonicalString()+n.op.toString()+pu(n.value);if(h0(n))return n.filters.map(e=>CD(e)).join(",");{let e=n.filters.map(t=>CD(t)).join(",");return`${n.op}(${e})`}}function fF(n,e){return n instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.field.isEqual(i.field)&&Pr(r.value,i.value)}(n,e):n instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&fF(o,i.filters[a]),!0):!1}(n,e):void W()}function pF(n,e){let t=n.filters.concat(e);return Fe.create(t,n.op)}function gF(n){return n instanceof De?function(t){return`${t.field.canonicalString()} ${t.op} ${pu(t.value)}`}(n):n instanceof Fe?function(t){return t.op.toString()+" {"+t.getFilters().map(gF).join(" ,")+"}"}(n):"Filter"}var DD=class extends De{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},bD=class extends De{constructor(e,t){super(e,"in",t),this.keys=mF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},TD=class extends De{constructor(e,t){super(e,"not-in",t),this.keys=mF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function mF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var AD=class extends De{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Id(t)&&Ed(t.arrayValue,this.value)}},om=class extends De{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ed(this.value.arrayValue,t)}},SD=class extends De{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ed(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ed(this.value.arrayValue,t)}},RD=class extends De{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Id(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ed(this.value.arrayValue,r))}};var xD=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function MD(n,e=null,t=[],r=[],i=null,s=null,o=null){return new xD(n,e,t,r,i,s,o)}function vo(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>CD(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ld(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>pu(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>pu(r)).join(",")),e.ue=t}return e.ue}function jd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!m6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!sO(n.startAt,e.startAt)&&sO(n.endAt,e.endAt)}function am(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function um(n,e){return n.filters.filter(t=>t instanceof De&&t.field.isEqual(e))}function oO(n,e,t){let r=Kg,i=!0;for(let s of um(n,e)){let o=Kg,a=!0;switch(s.op){case"<":case"<=":o=p6(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Kg}nO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];nO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function aO(n,e,t){let r=Xi,i=!0;for(let s of um(n,e)){let o=Xi,a=!0;switch(s.op){case">=":case">":o=g6(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xi}rO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];rO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var ur=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function yF(n,e,t,r,i,s,o,a){return new ur(n,e,t,r,i,s,o,a)}function xu(n){return new ur(n)}function uO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function f0(n){return n.collectionGroup!==null}function lu(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Be(ct.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new yo(s,r))}),t.has(ct.keyField().canonicalString())||e.ce.push(new yo(ct.keyField(),r))}return e.ce}function un(n){let e=$(n);return e.le||(e.le=y6(e,lu(n))),e.le}function y6(n,e){if(n.limitType==="F")return MD(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new yo(i.field,s)});let t=n.endAt?new kr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new kr(n.startAt.position,n.startAt.inclusive):null;return MD(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ND(n,e){let t=n.filters.concat([e]);return new ur(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function cm(n,e,t){return new ur(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ud(n,e){return jd(un(n),un(e))&&n.limitType===e.limitType}function vF(n){return`${vo(un(n))}|lt:${n.limitType}`}function iu(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>gF(i)).join(", ")}]`),Ld(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>pu(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>pu(i)).join(",")),`Target(${r})`}(un(n))}; limitType=${n.limitType})`}function Bd(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of lu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let l=iO(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,lu(r),i)||r.endAt&&!function(o,a,u){let l=iO(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,lu(r),i))}(n,e)}function _F(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wF(n){return(e,t)=>{let r=!1;for(let i of lu(n)){let s=v6(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function v6(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,a){let u=o.data.field(s),l=a.data.field(s);return u!==null&&l!==null?ss(u,l):W()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}var Or=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){To(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return aF(this.inner)}size(){return this.innerSize}};var _6=new ze(q.comparator);function pn(){return _6}var EF=new ze(q.comparator);function ld(...n){let e=EF;for(let t of n)e=e.insert(t.key,t);return e}function IF(n){let e=EF;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Rr(){return fd()}function CF(){return fd()}function fd(){return new Or(n=>n.toString(),(n,e)=>n.isEqual(e))}var w6=new ze(q.comparator),E6=new Be(q.comparator);function fe(...n){let e=E6;for(let t of n)e=e.add(t);return e}var I6=new Be(le);function p0(){return I6}function g0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vd(e)?"-0":e}}function DF(n){return{integerValue:""+n}}function bF(n,e){return nF(e)?DF(e):g0(n,e)}var mu=class{constructor(){this._=void 0}};function C6(n,e,t){return n instanceof os?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Qm(s)&&(s=d0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof oi?AF(n,e):n instanceof ai?SF(n,e):function(i,s){let o=TF(i,s),a=cO(o)+cO(i.Pe);return ED(o)&&ED(i.Pe)?DF(a):g0(i.serializer,a)}(n,e)}function D6(n,e,t){return n instanceof oi?AF(n,e):n instanceof ai?SF(n,e):t}function TF(n,e){return n instanceof as?function(r){return ED(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var os=class extends mu{},oi=class extends mu{constructor(e){super(),this.elements=e}};function AF(n,e){let t=RF(e);for(let r of n.elements)t.some(i=>Pr(i,r))||t.push(r);return{arrayValue:{values:t}}}var ai=class extends mu{constructor(e){super(),this.elements=e}};function SF(n,e){let t=RF(e);for(let r of n.elements)t=t.filter(i=>!Pr(i,r));return{arrayValue:{values:t}}}var as=class extends mu{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function cO(n){return Qe(n.integerValue||n.doubleValue)}function RF(n){return Id(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var _o=class{constructor(e,t){this.field=e,this.transform=t}};function b6(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof oi&&i instanceof oi||r instanceof ai&&i instanceof ai?hu(r.elements,i.elements,Pr):r instanceof as&&i instanceof as?Pr(r.Pe,i.Pe):r instanceof os&&i instanceof os}(n.transform,e.transform)}var PD=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Yg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var yu=class{};function xF(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cs(n.key,rt.none()):new us(n.key,n.data,rt.none());{let t=n.data,r=Wt.empty(),i=new Be(ct.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new cr(n.key,r,new Pn(i.toArray()),rt.none())}}function T6(n,e,t){n instanceof us?function(i,s,o){let a=i.value.clone(),u=dO(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof cr?function(i,s,o){if(!Yg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=dO(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(MF(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pd(n,e,t,r){return n instanceof us?function(s,o,a,u){if(!Yg(s.precondition,o))return a;let l=s.value.clone(),d=hO(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof cr?function(s,o,a,u){if(!Yg(s.precondition,o))return a;let l=hO(s.fieldTransforms,u,o),d=o.data;return d.setAll(MF(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Yg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function A6(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=TF(r.transform,i||null);s!=null&&(t===null&&(t=Wt.empty()),t.set(r.field,s))}return t||null}function lO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&hu(r,i,(s,o)=>b6(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var us=class extends yu{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},cr=class extends yu{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function MF(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function dO(n,e,t){let r=new Map;K(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,D6(o,a,t[i]))}return r}function hO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,C6(s,o,e))}return r}var cs=class extends yu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Cd=class extends yu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Dd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&T6(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=pd(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=pd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=CF();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let u=xF(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&hu(this.mutations,e.mutations,(t,r)=>lO(t,r))&&hu(this.baseMutations,e.baseMutations,(t,r)=>lO(t,r))}},kD=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){K(e.mutations.length===r.length);let i=function(){return w6}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var bd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var OD=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var pt,Te;function NF(n){switch(n){default:return W();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function PF(n){if(n===void 0)return ut("GRPC error has no .code"),N.UNKNOWN;switch(n){case pt.OK:return N.OK;case pt.CANCELLED:return N.CANCELLED;case pt.UNKNOWN:return N.UNKNOWN;case pt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case pt.INTERNAL:return N.INTERNAL;case pt.UNAVAILABLE:return N.UNAVAILABLE;case pt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case pt.NOT_FOUND:return N.NOT_FOUND;case pt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case pt.ABORTED:return N.ABORTED;case pt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case pt.DATA_LOSS:return N.DATA_LOSS;default:return W()}}(Te=pt||(pt={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var fO=null;function kF(){return new TextEncoder}var S6=new Ki([4294967295,4294967295],0);function pO(n){let e=kF().encode(n),t=new YC;return t.update(e),new Uint8Array(t.digest())}function gO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ki([t,r],0),new Ki([i,s],0)]}var FD=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new fo(`Invalid padding: ${t}`);if(r<0)throw new fo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new fo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ki.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ki.fromNumber(r)));return i.compare(S6)===1&&(i=new Ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=pO(e),[r,i]=gO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=pO(e),[r,i]=gO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},fo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Td=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ad.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(J.min(),i,new ze(le),pn(),fe())}},Ad=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,fe(),fe(),fe())}};var du=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},lm=class{constructor(e,t){this.targetId=e,this.me=t}},dm=class{constructor(e,t,r=dt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},hm=class{constructor(){this.fe=0,this.ge=yO(),this.pe=dt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),t=fe(),r=fe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:W()}}),new Ad(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=yO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,K(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},VD=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=pn(),this.qe=mO(),this.Qe=new ze(le)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(am(s))if(r===0){let o=new q(s.path);this.Ue(t,o,yt.newNoDocument(o,J.min()))}else K(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}fO?.et(function(d,h,g,y,_){var D,A,P,U,F,Q;let re={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},X=h.unchangedNames;return X&&(re.bloomFilter={applied:_===0,hashCount:(D=X?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(U=(P=(A=X?.bits)===null||A===void 0?void 0:A.bitmap)===null||P===void 0?void 0:P.length)!==null&&U!==void 0?U:0,padding:(Q=(F=X?.bits)===null||F===void 0?void 0:F.padding)!==null&&Q!==void 0?Q:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),re}(o,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=rs(r).toUint8Array()}catch(u){if(u instanceof im)return ar("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new FD(o,i,s)}catch(u){return ar(u instanceof fo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&am(a.target)){let u=new q(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,yt.newNoDocument(u,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=fe();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Td(e,t,this.Qe,this.ke,r);return this.ke=pn(),this.qe=mO(),this.Qe=new ze(le),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new hm,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Be(le),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new hm),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function mO(){return new ze(q.comparator)}function yO(){return new ze(q.comparator)}var R6={asc:"ASCENDING",desc:"DESCENDING"},x6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M6={and:"AND",or:"OR"},LD=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function jD(n,e){return n.useProto3Json||Ld(e)?e:{value:e}}function vu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OF(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function N6(n,e){return vu(n,e.toTimestamp())}function lt(n){return K(!!n),J.fromTimestamp(function(t){let r=si(t);return new Je(r.seconds,r.nanos)}(n))}function m0(n,e){return UD(n,e).canonicalString()}function UD(n,e){let t=function(i){return new Ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function FF(n){let e=Ae.fromString(n);return K(zF(e)),e}function Sd(n,e){return m0(n.databaseId,e.path)}function Mr(n,e){let t=FF(e);if(t.get(1)!==n.databaseId.projectId)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(jF(t))}function VF(n,e){return m0(n.databaseId,e)}function LF(n){let e=FF(n);return e.length===4?Ae.emptyPath():jF(e)}function BD(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jF(n){return K(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function vO(n,e,t){return{name:Sd(n,e),fields:t.value.mapValue.fields}}function UF(n,e,t){let r=Mr(n,e.name),i=lt(e.updateTime),s=e.createTime?lt(e.createTime):J.min(),o=new Wt({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function P6(n,e){return"found"in e?function(r,i){K(!!i.found),i.found.name,i.found.updateTime;let s=Mr(r,i.found.name),o=lt(i.found.updateTime),a=i.found.createTime?lt(i.found.createTime):J.min(),u=new Wt({mapValue:{fields:i.found.fields}});return yt.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){K(!!i.missing),K(!!i.readTime);let s=Mr(r,i.missing),o=lt(i.readTime);return yt.newNoDocument(s,o)}(n,e):W()}function k6(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(K(d===void 0||typeof d=="string"),dt.fromBase64String(d||"")):(K(d===void 0||d instanceof Buffer||d instanceof Uint8Array),dt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?N.UNKNOWN:PF(l.code);return new k(d,l.message||"")}(o);t=new dm(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Mr(n,r.document.name),s=lt(r.document.updateTime),o=r.document.createTime?lt(r.document.createTime):J.min(),a=new Wt({mapValue:{fields:r.document.fields}}),u=yt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new du(l,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Mr(n,r.document),s=r.readTime?lt(r.readTime):J.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new du([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Mr(n,r.document),s=r.removedTargetIds||[];t=new du([],s,i,null)}else{if(!("filter"in e))return W();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new OD(i,s),a=r.targetId;t=new lm(a,o)}}return t}function Rd(n,e){let t;if(e instanceof us)t={update:vO(n,e.key,e.value)};else if(e instanceof cs)t={delete:Sd(n,e.key)};else if(e instanceof cr)t={update:vO(n,e.key,e.data),updateMask:U6(e.fieldMask)};else{if(!(e instanceof Cd))return W();t={verify:Sd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof os)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof oi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof as)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw W()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:N6(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(n,e.precondition)),t}function $D(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?rt.updateTime(lt(s.updateTime)):s.exists!==void 0?rt.exists(s.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)K(a.setToServerValue==="REQUEST_TIME"),u=new os;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];u=new oi(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];u=new ai(d)}else"increment"in a?u=new as(o,a.increment):W();let l=ct.fromServerFormat(a.fieldPath);return new _o(l,u)}(n,i)):[];if(e.update){e.update.name;let i=Mr(n,e.update.name),s=new Wt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let l=u.fieldPaths||[];return new Pn(l.map(d=>ct.fromServerFormat(d)))}(e.updateMask);return new cr(i,s,o,t,r)}return new us(i,s,t,r)}if(e.delete){let i=Mr(n,e.delete);return new cs(i,t)}if(e.verify){let i=Mr(n,e.verify);return new Cd(i,t)}return W()}function O6(n,e){return n&&n.length>0?(K(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?lt(i.updateTime):lt(s);return o.isEqual(J.min())&&(o=lt(s)),new PD(o,i.transformResults||[])}(t,e))):[]}function BF(n,e){return{documents:[VF(n,e.path)]}}function $F(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=VF(n,i);let s=function(l){if(l.length!==0)return GF(Fe.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:su(g.field),direction:V6(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=jD(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function qF(n){let e=LF(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){K(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let g=HF(h);return g instanceof Fe&&h0(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(g=>function(_){return new yo(ou(_.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(h){let g;return g=typeof h=="object"?h.value:h,Ld(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(h){let g=!!h.before,y=h.values||[];return new kr(y,g)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let g=!h.before,y=h.values||[];return new kr(y,g)}(t.endAt)),yF(e,i,o,s,a,"F",u,l)}function F6(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HF(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ou(t.unaryFilter.field);return De.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ou(t.unaryFilter.field);return De.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ou(t.unaryFilter.field);return De.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ou(t.unaryFilter.field);return De.create(o,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return De.create(ou(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Fe.create(t.compositeFilter.filters.map(r=>HF(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function V6(n){return R6[n]}function L6(n){return x6[n]}function j6(n){return M6[n]}function su(n){return{fieldPath:n.canonicalString()}}function ou(n){return ct.fromServerFormat(n.fieldPath)}function GF(n){return n instanceof De?function(t){if(t.op==="=="){if(tO(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NAN"}};if(eO(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(tO(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NAN"}};if(eO(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:su(t.field),op:L6(t.op),value:t.value}}}(n):n instanceof Fe?function(t){let r=t.getFilters().map(i=>GF(i));return r.length===1?r[0]:{compositeFilter:{op:j6(t.op),filters:r}}}(n):W()}function U6(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function zF(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var _u=class n{constructor(e,t,r,i,s=J.min(),o=J.min(),a=dt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var fm=class{constructor(e){this.ct=e}};function B6(n,e){let t;if(e.document)t=UF(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=q.fromSegments(e.noDocument.path),i=Eo(e.noDocument.readTime);t=yt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{let r=q.fromSegments(e.unknownDocument.path),i=Eo(e.unknownDocument.version);t=yt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Je(i[0],i[1]);return J.fromTimestamp(s)}(e.readTime)),t}function _O(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:pm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Sd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:vu(s,o.version.toTimestamp()),createTime:vu(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:wo(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:t.path.toArray(),version:wo(e.version)}}return r}function pm(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function wo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Eo(n){let e=new Je(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function co(n,e){let t=(e.baseMutations||[]).map(s=>$D(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>$D(n.ct,s)),i=Je.fromMillis(e.localWriteTimeMs);return new Dd(e.batchId,i,t,r)}function dd(n){let e=Eo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Eo(n.lastLimboFreeSnapshotVersion):J.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return K(s.documents.length===1),un(xu(LF(s.documents[0])))}(n.query):function(s){return un(qF(s))}(n.query),new _u(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,dt.fromBase64String(n.resumeToken))}function WF(n,e){let t=wo(e.snapshotVersion),r=wo(e.lastLimboFreeSnapshotVersion),i;i=am(e.target)?BF(n.ct,e.target):$F(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function y0(n){let e=qF({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cm(e,e.limit,"L"):e}function nD(n,e){return new bd(e.largestBatchId,$D(n.ct,e.overlayMutation))}function wO(n,e){let t=e.path.lastSegment();return[n,an(e.path.popLast()),t]}function EO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:wo(r.readTime),documentKey:an(r.documentKey.path),largestBatchId:r.largestBatchId}}var qD=class{getBundleMetadata(e,t){return IO(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Eo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return IO(e).put(function(i){return{bundleId:i.id,createTime:wo(lt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return CO(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:y0(s.bundledQuery),readTime:Eo(s.readTime)}}(r)})}saveNamedQuery(e,t){return CO(e).put(function(i){return{name:i.name,readTime:wo(lt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function IO(n){return It(n,"bundles")}function CO(n){return It(n,"namedQueries")}var gm=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return od(e).get(wO(this.userId,t)).next(r=>r?nD(this.serializer,r):null)}getOverlays(e,t){let r=Rr();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new bd(t,o);i.push(this.ht(e,a))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(an(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(od(e).j("collectionPathOverlayIndex",a))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Rr(),s=an(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return od(e).U("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let l=nD(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Rr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return od(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{let h=nD(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return od(e).put(function(i,s,o){let[a,u,l]=wO(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Rd(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function od(n){return It(n,"documentOverlays")}var HD=class{Pt(e){return It(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?dt.fromUint8Array(r):dt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var ri=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Qe(e.integerValue));else if("doubleValue"in e){let r=Qe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),vd(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=si(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(rs(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?cF(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Ym(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):W()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Qe(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),q.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};ri.vt=new ri;function $6(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function DO(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=$6(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var GD=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=DO(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=DO(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},zD=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},WD=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},lo=class{constructor(){this.jt=new GD,this.Ht=new zD(this.jt),this.Jt=new WD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var ho=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Qi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=bO(n.arrayValue,e.arrayValue),t!==0?t:(t=bO(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function bO(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var mm=class{constructor(e){this.Xt=new Be((t,r)=>ct.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(K(e.collectionGroup===this.collectionId),this.nn)return!1;let t=pD(e);if(t!==void 0&&!this.sn(t))return!1;let r=ao(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Be(ct.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new cu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new cu(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new cu(r.field,r.dir==="asc"?0:1)));return new fu(fu.UNKNOWN_ID,this.collectionId,t,yd.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function KF(n){var e,t;if(K(n instanceof De||n instanceof Fe),n instanceof De){if(n instanceof om){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>De.create(n.field,"==",s)))||[];return Fe.create(i,"or")}return n}let r=n.filters.map(i=>KF(i));return Fe.create(r,n.op)}function q6(n){if(n.getFilters().length===0)return[];let e=YD(KF(n));return K(QF(e)),KD(e)||QD(e)?[e]:e.getFilters()}function KD(n){return n instanceof De}function QD(n){return n instanceof Fe&&h0(n)}function QF(n){return KD(n)||QD(n)||function(t){if(t instanceof Fe&&ID(t)){for(let r of t.getFilters())if(!KD(r)&&!QD(r))return!1;return!0}return!1}(n)}function YD(n){if(K(n instanceof De||n instanceof Fe),n instanceof De)return n;if(n.filters.length===1)return YD(n.filters[0]);let e=n.filters.map(r=>YD(r)),t=Fe.create(e,n.op);return t=ym(t),QF(t)?t:(K(t instanceof Fe),K(gu(t)),K(t.filters.length>1),t.filters.reduce((r,i)=>v0(r,i)))}function v0(n,e){let t;return K(n instanceof De||n instanceof Fe),K(e instanceof De||e instanceof Fe),t=n instanceof De?e instanceof De?function(i,s){return Fe.create([i,s],"and")}(n,e):TO(n,e):e instanceof De?TO(e,n):function(i,s){if(K(i.filters.length>0&&s.filters.length>0),gu(i)&&gu(s))return pF(i,s.getFilters());let o=ID(i)?i:s,a=ID(i)?s:i,u=o.filters.map(l=>v0(l,a));return Fe.create(u,"or")}(n,e),ym(t)}function TO(n,e){if(gu(e))return pF(e,n.getFilters());{let t=e.filters.map(r=>v0(n,r));return Fe.create(t,"or")}}function ym(n){if(K(n instanceof De||n instanceof Fe),n instanceof De)return n;let e=n.getFilters();if(e.length===1)return ym(e[0]);if(hF(n))return n;let t=e.map(i=>ym(i)),r=[];return t.forEach(i=>{i instanceof De?r.push(i):i instanceof Fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,n.op)}var ZD=class{constructor(){this.un=new xd}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Wn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Wn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},xd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Be(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Be(Ae.comparator)).toArray()}};var qg=new Uint8Array(0),JD=class{constructor(e,t){this.databaseId=t,this.cn=new xd,this.ln=new Or(r=>vo(r),(r,i)=>jd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:an(i)};return AO(e).put(s)}return R.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[ZO(t),""],!1,!0);return AO(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,t){let r=ad(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=tu(e);return s.next(a=>{o.put(EO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=ad(e),i=tu(e),s=eu(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ad(e),r=eu(e),i=tu(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return R.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new mm(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=eu(e),i=!0,s=new Map;return R.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=fe(),a=[];return R.forEach(s,(u,l)=>{O("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(u)} to execute ${vo(t)}`);let d=function(F,Q){let re=pD(Q);if(re===void 0)return null;for(let X of um(F,re.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(l,u),h=function(F,Q){let re=new Map;for(let X of ao(Q))for(let I of um(F,X.fieldPath))switch(I.op){case"==":case"in":re.set(X.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return re.set(X.fieldPath.canonicalString(),I.value),Array.from(re.values())}return null}(l,u),g=function(F,Q){let re=[],X=!0;for(let I of ao(Q)){let v=I.kind===0?oO(F,I.fieldPath,F.startAt):aO(F,I.fieldPath,F.startAt);re.push(v.value),X&&(X=v.inclusive)}return new kr(re,X)}(l,u),y=function(F,Q){let re=[],X=!0;for(let I of ao(Q)){let v=I.kind===0?aO(F,I.fieldPath,F.endAt):oO(F,I.fieldPath,F.endAt);re.push(v.value),X&&(X=v.inclusive)}return new kr(re,X)}(l,u),_=this.In(u,l,g),D=this.In(u,l,y),A=this.Tn(u,l,h),P=this.En(u.indexId,d,_,g.inclusive,D,y.inclusive,A);return R.forEach(P,U=>r.G(U,t.limit).next(F=>{F.forEach(Q=>{let re=q.fromSegments(Q.documentKey);o.has(re)||(o=o.add(re),a.push(re))})}))}).next(()=>a)}return R.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=q6(Fe.create(e.filters,"and")).map(r=>MD(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let u=(t!=null?t.length:1)*Math.max(r.length,s.length),l=u/(t!=null?t.length:1),d=[];for(let h=0;h<u;++h){let g=t?this.dn(t[h/l]):qg,y=this.An(e,g,r[h%l],i),_=this.Rn(e,g,s[h%l],o),D=a.map(A=>this.An(e,g,A,!0));d.push(...this.createRange(y,_,D))}return d}An(e,t,r,i){let s=new ho(e,q.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new ho(e,q.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new mm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return R.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let l=new Be(ct.comparator),d=!1;for(let h of u.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let h of u.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new lo;for(let i of ao(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);ri.vt.It(s,o)}return r.zt()}dn(e){let t=new lo;return ri.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new lo;return ri.vt.It(mo(this.databaseId,t),r.Yt(function(s){let o=ao(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new lo);let s=0;for(let o of ao(e)){let a=r[s++];for(let u of i)if(this.fn(t,o.fieldPath)&&Id(a))i=this.gn(i,o,a);else{let l=u.Yt(o.kind);ri.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new lo;u.seed(a.zt()),ri.vt.It(o,u.Yt(t.kind)),s.push(u)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof De&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=ad(e),i=tu(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return R.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,h){let g=h?new yd(h.sequenceNumber,new Wn(Eo(h.readTime),new q(Sr(h.documentKey)),h.largestBatchId)):yd.empty(),y=d.fields.map(([_,D])=>new cu(ct.fromServerFormat(_),D));return new fu(d.indexId,d.collectionGroup,y,g)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:le(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=ad(e),s=tu(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>R.forEach(a,u=>s.put(EO(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return R.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?R.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),R.forEach(a,u=>this.wn(e,i,u).next(l=>{let d=this.Sn(s,u);return l.isEqual(d)?R.resolve():this.bn(e,s,u,l,d)}))))})}Dn(e,t,r,i){return eu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return eu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=eu(e),s=new Be(Qi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new ho(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new Be(Qi),i=this.Vn(t,e);if(i==null)return r;let s=pD(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Id(o))for(let a of o.arrayValue.values||[])r=r.add(new ho(t.indexId,e.key,this.dn(a),i))}else r=r.add(new ho(t.indexId,e.key,qg,i));return r}bn(e,t,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(u,l,d,h,g){let y=u.getIterator(),_=l.getIterator(),D=Xa(y),A=Xa(_);for(;D||A;){let P=!1,U=!1;if(D&&A){let F=d(D,A);F<0?U=!0:F>0&&(P=!0)}else D!=null?U=!0:P=!0;P?(h(A),A=Xa(_)):U?(g(D),D=Xa(y)):(D=Xa(y),A=Xa(_))}}(i,s,Qi,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),R.waitFor(o)}yn(e){let t=1;return tu(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Qi(o,a)).filter((o,a,u)=>!a||Qi(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Qi(o,e),u=Qi(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(o),i.push(o.Zt());else if(u>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,qg,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,qg,[]];s.push(IDBKeyRange.bound(a,u))}return s}Cn(e,t){return Qi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(SO)}getMinOffset(e,t){return R.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||W())).next(SO)}};function AO(n){return It(n,"collectionParents")}function eu(n){return It(n,"indexEntries")}function ad(n){return It(n,"indexConfiguration")}function tu(n){return It(n,"indexState")}function SO(n){K(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;u0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Wn(e.readTime,e.documentKey,t)}var RO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function YF(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:o},(d,h,g)=>(a++,g.delete()));s.push(u.next(()=>{K(a===1)}));let l=[];for(let d of t.mutations){let h=rF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return R.waitFor(s).next(()=>l)}function vm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw W();e=n.noDocument}return JSON.stringify(e).length}zn.DEFAULT_COLLECTION_PERCENTILE=10,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zn.DEFAULT=new zn(41943040,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zn.DISABLED=new zn(-1,0,0);var _m=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){K(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=au(e),o=Yi(e);return o.add({}).next(a=>{K(typeof a=="number");let u=new Dd(a,t,r,i),l=function(y,_,D){let A=D.baseMutations.map(U=>Rd(y.ct,U)),P=D.mutations.map(U=>Rd(y.ct,U));return{userId:_,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:A,mutations:P}}(this.serializer,this.userId,u),d=[],h=new Be((g,y)=>le(g.canonicalString(),y.canonicalString()));for(let g of i){let y=rF(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(o.put(l)),d.push(s.put(y,Q5))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),R.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Yi(e).get(t).next(r=>r?(K(r.userId===this.userId),co(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?R.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Yi(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(K(a.batchId>=r),s=co(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Yi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Yi(e).U("userMutationsIndex",t).next(r=>r.map(i=>co(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Wg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return au(e).J({range:i},(o,a,u)=>{let[l,d,h]=o,g=Sr(d);if(l===this.userId&&t.path.isEqual(g))return Yi(e).get(h).next(y=>{if(!y)throw W();K(y.userId===this.userId),s.push(co(this.serializer,y))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(le),i=[];return t.forEach(s=>{let o=Wg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=au(e).J({range:a},(l,d,h)=>{let[g,y,_]=l,D=Sr(y);g===this.userId&&s.path.isEqual(D)?r=r.add(_):h.done()});i.push(u)}),R.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Wg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Be(le);return au(e).J({range:o},(u,l,d)=>{let[h,g,y]=u,_=Sr(g);h===this.userId&&r.isPrefixOf(_)?_.length===i&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Yi(e).get(s).next(o=>{if(o===null)throw W();K(o.userId===this.userId),r.push(co(this.serializer,o))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return YF(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return au(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=Sr(s[1]);i.push(u)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,t){return ZF(e,this.userId,t)}Nn(e){return JF(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function ZF(n,e,t){let r=Wg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return au(n).J({range:s,H:!0},(a,u,l)=>{let[d,h,g]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Yi(n){return It(n,"mutations")}function au(n){return It(n,"documentMutations")}function JF(n){return It(n,"mutationQueues")}var wu=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var XD=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new wu(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>J.fromTimestamp(new Je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>nu(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return nu(e).J((o,a)=>{let u=dd(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return nu(e).J((r,i)=>{let s=dd(i);t(s)})}qn(e){return xO(e).get("targetGlobalKey").next(t=>(K(t!==null),t))}Qn(e,t){return xO(e).put("targetGlobalKey",t)}Kn(e,t){return nu(e).put(WF(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=vo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return nu(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let l=dd(a);jd(t,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Zi(e);return t.forEach(o=>{let a=an(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),R.waitFor(i)}removeMatchingKeys(e,t,r){let i=Zi(e);return R.forEach(t,s=>{let o=an(s.path);return R.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Zi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Zi(e),s=fe();return i.J({range:r,H:!0},(o,a,u)=>{let l=Sr(o[1]),d=new q(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=an(t.path),i=IDBKeyRange.bound([r],[ZO(r)],!1,!0),s=0;return Zi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return nu(e).get(t).next(r=>r?dd(r):null)}};function nu(n){return It(n,"targets")}function xO(n){return It(n,"targetGlobal")}function Zi(n){return It(n,"targetDocuments")}function MO([n,e],[t,r]){let i=le(n,t);return i===0?le(e,r):i}var eb=class{constructor(e){this.Un=e,this.buffer=new Be(MO),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();MO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},tb=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>M(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){hs(t)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield ds(t)}yield this.Hn(3e5)}))}},nb=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(Nn.oe);let r=new eb(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(RO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RO):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,u,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),ru()<=On.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${h} documents in `+(l-u)+`ms
Total Duration: ${l-d}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function H6(n,e){return new nb(n,e)}var rb=class{constructor(e,t){this.db=e,this.garbageCollector=H6(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Hg(e,r)}removeReference(e,t,r){return Hg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Hg(e,t)}nr(e,t){return function(i,s){let o=!1;return JF(i).Y(a=>ZF(i,a,s).next(u=>(u&&(o=!0),R.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let u=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,J.min()),Zi(e).delete(function(h){return[0,an(h.path)]}(o))))});i.push(u)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Hg(e,t)}tr(e,t){let r=Zi(e),i,s=Nn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{o===0?(s!==Nn.oe&&t(new q(Sr(i)),s),s=l,i=u):s=Nn.oe}).next(()=>{s!==Nn.oe&&t(new q(Sr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Hg(n,e){return Zi(n).put(function(r,i){return{targetId:0,path:an(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var wm=class{constructor(){this.changes=new Or(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ib=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return oo(e).put(r)}removeEntry(e,t,r){return oo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],pm(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=yt.newInvalidDocument(t);return oo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ud(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:yt.newInvalidDocument(t)};return oo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ud(t))},(i,s)=>{r={document:this.ir(t,s),size:vm(s)}}).next(()=>r)}getEntries(e,t){let r=pn();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=pn(),i=new ze(q.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,vm(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return R.resolve();let i=new Be(kO);t.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(ud(i.first()),ud(i.last())),o=i.getIterator(),a=o.getNext();return oo(e).J({index:"documentKeyIndex",range:s},(u,l,d)=>{let h=q.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&kO(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(ud(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),pm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return oo(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=pn();for(let h of l){let g=this.ir(q.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&(Bd(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=pn(),o=PO(t,r),a=PO(t,Wn.max());return oo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{let h=this.ir(q.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new sb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return NO(e).get("remoteDocumentGlobalKey").next(t=>(K(!!t),t))}rr(e,t){return NO(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=B6(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return yt.newInvalidDocument(e)}};function XF(n){return new ib(n)}var sb=class extends wm{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Or(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Be((s,o)=>le(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=_O(this.cr.serializer,o);i=i.add(s.path.popLast());let l=vm(u);r+=l-a.size,t.push(this.cr.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=_O(this.cr.serializer,o.convertToNoDocument(J.min()));t.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function NO(n){return It(n,"remoteDocumentGlobal")}function oo(n){return It(n,"remoteDocumentsV14")}function ud(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function PO(n,e){let t=e.documentKey.path.toArray();return[n,pm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function kO(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=le(t[s],r[s]),i)return i;return i=le(t.length,r.length),i||(i=le(t[t.length-2],r[r.length-2]),i||le(t[t.length-1],r[r.length-1]))}var ob=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Em=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&pd(r.mutation,i,Pn.empty(),Je.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){let i=Rr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ld();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Rr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=pn(),o=fd(),a=function(){return fd()}();return t.forEach((u,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof cr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),pd(d.mutation,l,d.mutation.getFieldMask(),Je.now())):o.set(l.key,Pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new ob(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=fd(),i=new ze((o,a)=>o-a),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let d=r.get(u)||Pn.empty();d=a.applyToLocalView(l,d),r.set(u,d);let h=(i.get(a.batchId)||fe()).add(u);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,d=u.value,h=CF();d.forEach(g=>{if(!s.has(g)){let y=xF(t.get(g),r.get(g));y!==null&&h.set(g,y),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):f0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Rr()),a=-1,u=s;return o.next(l=>R.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?R.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,fe())).next(d=>({batchId:a,changes:IF(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=ld();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=ld();return this.indexManager.getCollectionParents(e,s).next(a=>R.forEach(a,u=>{let l=function(h,g){return new ur(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,g)=>{o=o.insert(h,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,yt.newInvalidDocument(d)))});let a=ld();return o.forEach((u,l)=>{let d=s.get(u);d!==void 0&&pd(d.mutation,l,Pn.empty(),Je.now()),Bd(t,l)&&(a=a.insert(u,l))}),a})}};var ab=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:lt(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:y0(i.bundledQuery),readTime:lt(i.readTime)}}(t)),R.resolve()}};var ub=class{constructor(){this.overlays=new ze(q.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Rr();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=Rr(),s=t.length+1,o=new q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ze((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=Rr(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=Rr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return R.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bd(t,r));let s=this.Ir.get(t);s===void 0&&(s=fe(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var cb=class{constructor(){this.sessionToken=dt.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Md=class{constructor(){this.Tr=new Be(gt.Er),this.dr=new Be(gt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new gt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new gt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new q(new Ae([])),r=new gt(t,e),i=new gt(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new q(new Ae([])),r=new gt(t,e),i=new gt(t,e+1),s=fe();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new gt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},gt=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return q.comparator(e.key,t.key)||le(e.wr,t.wr)}static Ar(e,t){return le(e.wr,t.wr)||q.comparator(e.key,t.key)}};var lb=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Be(gt.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Dd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new gt(t,0),i=new gt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(le);return t.forEach(i=>{let s=new gt(i,0),o=new gt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),R.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;q.isDocumentKey(s)||(s=s.child(""));let o=new gt(new q(s),0),a=new Be(le);return this.br.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.wr)),!0)},o),R.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){K(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return R.forEach(t.mutations,i=>{let s=new gt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new gt(t,0),i=this.br.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var db=class{constructor(e){this.Mr=e,this.docs=function(){return new ze(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let r=pn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=pn(),o=t.path,a=new q(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||u0(XO(d),r)<=0||(i.has(d.key)||Bd(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){W()}Or(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hb(this)}getSize(e){return R.resolve(this.size)}},hb=class extends wm{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var fb=class{constructor(e){this.persistence=e,this.Nr=new Or(t=>vo(t),jd),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Md,this.targetCount=0,this.kr=wu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new wu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var Im=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Nn(0),this.Kr=!1,this.Kr=!0,this.$r=new cb,this.referenceDelegate=e(this),this.Ur=new fb(this),this.indexManager=new ZD,this.remoteDocumentCache=function(i){return new db(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new fm(t),this.Gr=new ab(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ub,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new lb(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new pb(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return R.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},pb=class extends tm{constructor(e){super(),this.currentSequenceNumber=e}},Cm=class n{constructor(e){this.persistence=e,this.Jr=new Md,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw W()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,r=>{let i=q.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var gb=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new nm("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Y1,{unique:!0}),u.createObjectStore("documentMutations")}(e),OO(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=R.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),OO(e)),o=o.next(()=>function(u){let l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,l){return l.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Y1,{unique:!0});let h=l.store("mutations"),g=d.map(y=>h.put(y));return R.waitFor(g)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:a6});l.createIndex("collectionPathOverlayIndex",u6,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",c6,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:Y5});l.createIndex("documentKeyIndex",Z5),l.createIndex("collectionGroupIndex",J5)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:r6}).createIndex("sequenceNumberIndex",i6,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:s6}).createIndex("documentKeyIndex",o6,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=vm(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>R.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>R.forEach(a,u=>{K(u.userId===s.userId);let l=co(this.serializer,u);return YF(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let u=new Ae(o),l=function(h){return[0,an(h)]}(u);s.push(t.get(l).next(d=>d?R.resolve():(h=>t.put({targetId:0,path:an(h),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>R.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:n6});let r=t.store("collectionParents"),i=new xd,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:an(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let u=new Ae(o);return s(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],l)=>{let d=Sr(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=dd(i),o=WF(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),u=function(h){return h.document?new q(Ae.fromString(h.document.name).popFirst(5)):h.noDocument?q.fromSegments(h.noDocument.path):h.unknownDocument?q.fromSegments(h.unknownDocument.path):W()}(o).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>R.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=XF(this.serializer),s=new Im(Cm.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(u=>{var l;let d=(l=a.get(u.userId))!==null&&l!==void 0?l:fe();co(this.serializer,u).keys().forEach(h=>d=d.add(h)),a.set(u.userId,d)}),R.forEach(a,(u,l)=>{let d=new mt(l),h=gm.lt(this.serializer,d),g=s.getIndexManager(d),y=_m.lt(d,this.serializer,g,s.referenceDelegate);return new Em(i,y,h,g).recalculateAndSaveOverlaysForDocumentKeys(new _d(t,Nn.oe),u).next()})})}};function OO(n){n.createObjectStore("targetDocuments",{keyPath:e6}).createIndex("documentTargetsIndex",t6,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",X5,{unique:!0}),n.createObjectStore("targetGlobal")}var rD="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mb=class n{constructor(e,t,r,i,s,o,a,u,l,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!n.D())throw new k(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rb(this,i),this.Ai=t+"main",this.serializer=new fm(u),this.Ri=new ns(this.Ai,this.hi,new gb(this.serializer)),this.$r=new HD,this.Ur=new XD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=XF(this.serializer),this.Gr=new qD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&ut("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,rD);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Nn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>M(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>M(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>M(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Gg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(hs(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return cd(e).get("owner").next(t=>R.resolve(this.vi(t)))}Ci(e){return Gg(e).delete(this.clientId)}Fi(){return M(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=It(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return R.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?R.resolve(!0):cd(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,rD);return!1}}return!(!this.networkEnabled||!this.inForeground)||Gg(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return M(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new _d(e,Nn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Gg(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return _m.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return gm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===17?h6:u===16?d6:u===15?l0:u===14?oF:u===13?sF:u===12?l6:u===11?iF:void W()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new _d(a,this.Qr?this.Qr.next():Nn.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw ut(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new k(N.FAILED_PRECONDITION,eF);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return cd(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(N.FAILED_PRECONDITION,rD)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cd(e).put("owner",t)}static D(){return ns.D()}bi(e){let t=cd(e);return t.get("owner").next(r=>this.vi(r)?(O("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ut(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;zy()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ut("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ut("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function cd(n){return It(n,"owner")}function Gg(n){return It(n,"clientMetadata")}function _0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var yb=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=fe(),i=fe();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var vb=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Dm=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return zy()?8:tF(sc())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new vb;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ru()<=On.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",iu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(ru()<=On.DEBUG&&O("QueryEngine","Query:",iu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ru()<=On.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",iu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(t))):R.resolve())}Yi(e,t){if(uO(t))return R.resolve(null);let r=un(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=cm(t,null,"F"),r=un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=fe(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.ts(t,a);return this.ns(t,l,o,u.readTime)?this.Yi(e,cm(t,null,"F")):this.rs(e,l,t,u)}))})))}Zi(e,t,r,i){return uO(t)||i.isEqual(J.min())?R.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?R.resolve(null):(ru()<=On.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),iu(t)),this.rs(e,o,t,JO(i,-1)).next(a=>a))})}ts(e,t){let r=new Be(wF(e));return t.forEach((i,s)=>{Bd(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return ru()<=On.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",iu(t)),this.Ji.getDocumentsMatchingQuery(e,t,Wn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var _b=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ze(le),this._s=new Or(s=>vo(s),jd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Em(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function eV(n,e,t,r){return new _b(n,e,t,r)}function tV(n,e){return M(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=fe();for(let l of i){o.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function G6(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){let h=l.batch,g=h.keys(),y=R.resolve();return g.forEach(_=>{y=y.next(()=>d.getEntry(u,_)).next(D=>{let A=l.docVersions.get(_);K(A!==null),D.version.compareTo(A)<0&&(h.applyToRemoteDocument(D,l),D.isValidDocument()&&(D.setReadTime(l.commitVersion),d.addEntry(D)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=fe();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function nV(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function z6(n,e){let t=$(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,h)));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(dt.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(h,y),function(D,A,P){return D.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(s,y))});let u=pn(),l=fe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(rV(s,o,e.documentUpdates).next(d=>{u=d.Ps,l=d.Is})),!r.isEqual(J.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return R.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.os=i,s))}function rV(n,e,t){let r=fe(),i=fe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=pn();return t.forEach((a,u)=>{let l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(J.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function W6(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Eu(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new _u(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Iu(n,e,t){return M(this,null,function*(){let r=$(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!hs(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function bm(n,e,t){let r=$(n),i=J.min(),s=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){let h=$(u),g=h._s.get(d);return g!==void 0?R.resolve(h.os.get(g)):h.Ur.getTargetData(l,d)}(r,o,un(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:J.min(),t?s:fe())).next(a=>(oV(r,_F(e),a),{documents:a,Ts:s})))}function iV(n,e){let t=$(n),r=$(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function sV(n,e){let t=$(n),r=t.us.get(e)||J.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,JO(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(oV(t,e,i),i))}function oV(n,e,t){let r=n.us.get(e)||J.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function K6(n,e,t,r){return M(this,null,function*(){let i=$(n),s=fe(),o=pn();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let h=e.ds(l);h.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,h)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),u=yield Eu(i,function(d){return un(xu(Ae.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>rV(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.Ur.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function Q6(r,i){return M(this,arguments,function*(n,e,t=fe()){let s=yield Eu(n,un(y0(e.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=lt(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(dt.EMPTY_BYTE_STRING,u);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function FO(n,e){return`firestore_clients_${n}_${e}`}function VO(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function iD(n,e){return`firestore_targets_${n}_${e}`}var Tm=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new k(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ut("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},gd=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new n(e,r.state,i):(ut("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Am=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=p0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=nF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ut("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},wb=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ut("SharedClientState",`Failed to parse online state: ${e}`),null)}},Nd=class{constructor(){this.activeTargetIds=p0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},md=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ze(le),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=FO(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Nd),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return M(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(FO(this.persistenceKey,r));if(i){let s=Am.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(iD(this.persistenceKey,e));if(i){let s=gd.Rs(e,i);s&&(r=s.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(iD(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O("SharedClientState","READ",e,t),t}setItem(e,t){O("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(O("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ut("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>M(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=Nn.oe;if(s!=null)try{let a=JSON.parse(s);K(typeof a=="number"),o=a}catch(a){ut("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Nn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Tm(this.currentUser,e,t,r),s=VO(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=VO(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=iD(this.persistenceKey,e),s=new gd(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return Am.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Tm.Rs(new mt(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return gd.Rs(i,t)}Ls(e){return wb.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return M(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=p0();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Sm=class{constructor(){this.so=new Nd,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Nd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Eb=class{_o(e){}shutdown(){}};var Rm=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var zg=null;function sD(){return zg===null?zg=function(){return 268435456+Math.round(2147483648*Math.random())}():zg++,"0x"+zg.toString(16)}var Y6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ib=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var zt="WebChannelConnection",Cb=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=sD(),u=this.xo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,u,l,i).then(d=>(O("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw ar("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ru}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=Y6[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=sD();return new Promise((o,a)=>{let u=new ZC;u.setWithCredentials(!0),u.listenOnce(JC.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case sd.NO_ERROR:let d=u.getResponseJson();O(zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case sd.TIMEOUT:O(zt,`RPC '${e}' ${s} timed out`),a(new k(N.DEADLINE_EXCEEDED,"Request time out"));break;case sd.HTTP_ERROR:let h=u.getStatus();if(O(zt,`RPC '${e}' ${s} failed with status:`,h,"response text:",u.getResponseText()),h>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let _=function(A){let P=A.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(P)>=0?P:N.UNKNOWN}(y.status);a(new k(_,y.message))}else a(new k(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new k(N.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{O(zt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);O(zt,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=sD(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=tD(),a=eD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let d=s.join("");O(zt,`Creating RPC '${e}' stream ${i}: ${d}`,u);let h=o.createWebChannel(d,u),g=!1,y=!1,_=new Ib({Io:A=>{y?O(zt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(g||(O(zt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),O(zt,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},To:()=>h.close()}),D=(A,P,U)=>{A.listen(P,F=>{try{U(F)}catch(Q){setTimeout(()=>{throw Q},0)}})};return D(h,Ja.EventType.OPEN,()=>{y||(O(zt,`RPC '${e}' stream ${i} transport opened.`),_.yo())}),D(h,Ja.EventType.CLOSE,()=>{y||(y=!0,O(zt,`RPC '${e}' stream ${i} transport closed`),_.So())}),D(h,Ja.EventType.ERROR,A=>{y||(y=!0,ar(zt,`RPC '${e}' stream ${i} transport errored:`,A),_.So(new k(N.UNAVAILABLE,"The operation could not be completed")))}),D(h,Ja.EventType.MESSAGE,A=>{var P;if(!y){let U=A.data[0];K(!!U);let F=U,Q=F.error||((P=F[0])===null||P===void 0?void 0:P.error);if(Q){O(zt,`RPC '${e}' stream ${i} received error:`,Q);let re=Q.status,X=function(E){let C=pt[E];if(C!==void 0)return PF(C)}(re),I=Q.message;X===void 0&&(X=N.INTERNAL,I="Unknown error status: "+re+" with message "+Q.message),y=!0,_.So(new k(X,I)),h.close()}else O(zt,`RPC '${e}' stream ${i} received:`,U),_.bo(U)}}),D(a,XC.STAT_EVENT,A=>{A.stat===$g.PROXY?O(zt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===$g.NOPROXY&&O(zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.wo()},0),_}};function aV(){return typeof window<"u"?window:null}function Zg(){return typeof document<"u"?document:null}function $d(n){return new LD(n,!0)}var Pd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var xm=class{constructor(e,t,r,i,s,o,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Pd(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return M(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return M(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return M(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(ut(t.toString()),ut("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new k(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>M(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Db=class extends xm{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=k6(this.serializer,e),r=function(s){if(!("targetChange"in s))return J.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?J.min():o.readTime?lt(o.readTime):J.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=BD(this.serializer),t.addTarget=function(s,o){let a,u=o.target;if(a=am(u)?{documents:BF(s,u)}:{query:$F(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=OF(s,o.resumeToken);let l=jD(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(J.min())>0){a.readTime=vu(s,o.snapshotVersion.toTimestamp());let l=jD(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=F6(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=BD(this.serializer),t.removeTarget=e,this.a_(t)}},bb=class extends xm{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return K(!!e.streamToken),this.lastStreamToken=e.streamToken,K(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=O6(e.writeResults,e.commitTime),r=lt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=BD(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Rd(this.serializer,r))};this.a_(t)}};var Tb=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,UD(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(N.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,UD(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(N.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Ab=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ut(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Sb=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>M(this,null,function*(){fs(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(u){return M(this,null,function*(){let l=$(u);l.L_.add(4),yield Mu(l),l.q_.set("Unknown"),l.L_.delete(4),yield qd(l)})}(this))}))}),this.q_=new Ab(r,i)}};function qd(n){return M(this,null,function*(){if(fs(n))for(let e of n.B_)yield e(!0)})}function Mu(n){return M(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Zm(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),I0(t)?E0(t):Pu(t).r_()&&w0(t,e))}function Cu(n,e){let t=$(n),r=Pu(t);t.N_.delete(e),r.r_()&&uV(t,e),t.N_.size===0&&(r.r_()?r.o_():fs(t)&&t.q_.set("Unknown"))}function w0(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pu(n).A_(e)}function uV(n,e){n.Q_.xe(e),Pu(n).R_(e)}function E0(n){n.Q_=new VD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Pu(n).start(),n.q_.v_()}function I0(n){return fs(n)&&!Pu(n).n_()&&n.N_.size>0}function fs(n){return $(n).L_.size===0}function cV(n){n.Q_=void 0}function Z6(n){return M(this,null,function*(){n.q_.set("Online")})}function J6(n){return M(this,null,function*(){n.N_.forEach((e,t)=>{w0(n,e)})})}function X6(n,e){return M(this,null,function*(){cV(n),I0(n)?(n.q_.M_(e),E0(n)):n.q_.set("Unknown")})}function e8(n,e,t){return M(this,null,function*(){if(n.q_.set("Online"),e instanceof dm&&e.state===2&&e.cause)try{yield function(i,s){return M(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Mm(n,r)}else if(e instanceof du?n.Q_.Ke(e):e instanceof lm?n.Q_.He(e):n.Q_.We(e),!t.isEqual(J.min()))try{let r=yield nV(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{let d=s.N_.get(u);if(!d)return;s.N_.set(u,d.withResumeToken(dt.EMPTY_BYTE_STRING,d.snapshotVersion)),uV(s,u);let h=new _u(d.target,u,l,d.sequenceNumber);w0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield Mm(n,r)}})}function Mm(n,e,t){return M(this,null,function*(){if(!hs(e))throw e;n.L_.add(1),yield Mu(n),n.q_.set("Offline"),t||(t=()=>nV(n.localStore)),n.asyncQueue.enqueueRetryable(()=>M(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield qd(n)}))})}function lV(n,e){return e().catch(t=>Mm(n,t,e))}function Nu(n){return M(this,null,function*(){let e=$(n),t=ls(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;t8(e);)try{let i=yield W6(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,n8(e,i)}catch(i){yield Mm(e,i)}dV(e)&&hV(e)})}function t8(n){return fs(n)&&n.O_.length<10}function n8(n,e){n.O_.push(e);let t=ls(n);t.r_()&&t.V_&&t.m_(e.mutations)}function dV(n){return fs(n)&&!ls(n).n_()&&n.O_.length>0}function hV(n){ls(n).start()}function r8(n){return M(this,null,function*(){ls(n).p_()})}function i8(n){return M(this,null,function*(){let e=ls(n);for(let t of n.O_)e.m_(t.mutations)})}function s8(n,e,t){return M(this,null,function*(){let r=n.O_.shift(),i=kD.from(r,e,t);yield lV(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Nu(n)})}function o8(n,e){return M(this,null,function*(){e&&ls(n).V_&&(yield function(r,i){return M(this,null,function*(){if(function(o){return NF(o)&&o!==N.ABORTED}(i.code)){let s=r.O_.shift();ls(r).s_(),yield lV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Nu(r)}})}(n,e)),dV(n)&&hV(n)})}function LO(n,e){return M(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=fs(t);t.L_.add(3),yield Mu(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield qd(t)})}function Rb(n,e){return M(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield qd(t)):e||(t.L_.add(2),yield Mu(t),t.q_.set("Unknown"))})}function Pu(n){return n.K_||(n.K_=function(t,r,i){let s=$(t);return s.w_(),new Db(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:Z6.bind(null,n),Ro:J6.bind(null,n),mo:X6.bind(null,n),d_:e8.bind(null,n)}),n.B_.push(e=>M(this,null,function*(){e?(n.K_.s_(),I0(n)?E0(n):n.q_.set("Unknown")):(yield n.K_.stop(),cV(n))}))),n.K_}function ls(n){return n.U_||(n.U_=function(t,r,i){let s=$(t);return s.w_(),new bb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:r8.bind(null,n),mo:o8.bind(null,n),f_:i8.bind(null,n),g_:s8.bind(null,n)}),n.B_.push(e=>M(this,null,function*(){e?(n.U_.s_(),yield Nu(n)):(yield n.U_.stop(),n.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var xb=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ku(n,e){if(ut("AsyncQueue",`${e}: ${n}`),hs(n))return new k(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Nm=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=ld(),this.sortedSet=new ze(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Pm=class{constructor(){this.W_=new ze(q.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):W():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Du=class n{constructor(e,t,r,i,s,o,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Nm.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ud(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Mb=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Nb=class{constructor(){this.queries=jO(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=$(t),s=i.queries;i.queries=jO(),s.forEach((o,a)=>{for(let u of a.j_)u.onError(r)})})(this,new k(N.ABORTED,"Firestore shutting down"))}};function jO(){return new Or(n=>vF(n),Ud)}function C0(n,e){return M(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new Mb,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=ku(o,`Initialization of query '${iu(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&b0(t)})}function D0(n,e){return M(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function a8(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&b0(t)}function u8(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function b0(n){n.Y_.forEach(e=>{e.next()})}var Pb,UO;(UO=Pb||(Pb={})).ea="default",UO.Cache="cache";var kd=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Du(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Du.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Pb.Cache}};var kb=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var km=class{constructor(e){this.serializer=e}Es(e){return Mr(this.serializer,e)}ds(e){return e.metadata.exists?UF(this.serializer,e.document,!1):yt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return lt(e)}},Ob=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=fV(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=Ae.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new km(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||fe()).add(s);t.set(o,a)}}return t}complete(){return M(this,null,function*(){let e=yield K6(this.localStore,new km(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield Q6(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function fV(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Om=class{constructor(e){this.key=e}},Fm=class{constructor(e){this.key=e}},Vm=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=fe(),this.mutatedKeys=fe(),this.Aa=wF(e),this.Ra=new Nm(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Pm,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),y=Bd(this.query,h)?h:null,_=!!g&&this.mutatedKeys.has(g.key),D=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),A=!1;g&&y?g.data.isEqual(y.data)?_!==D&&(r.track({type:3,doc:y}),A=!0):this.ga(g,y)||(r.track({type:2,doc:y}),A=!0,(u&&this.Aa(y,u)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),A=!0):g&&!y&&(r.track({type:1,doc:g}),A=!0,(u||l)&&(a=!0)),A&&(y?(o=o.add(y),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,h)=>function(y,_){let D=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return D(y)-D(_)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,l=u!==this.Ea;return this.Ea=u,o.length!==0||l?{snapshot:new Du(this.query,e.Ra,s,o,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=fe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Fm(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Om(r))}),t}ba(e){this.Ta=e.Ts,this.da=fe();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Du.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Fb=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Vb=class{constructor(e){this.key=e,this.va=!1}},Lb=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Or(a=>vF(a),Ud),this.Ma=new Map,this.xa=new Set,this.Oa=new ze(q.comparator),this.Na=new Map,this.La=new Md,this.Ba={},this.ka=new Map,this.qa=wu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function c8(n,e,t=!0){return M(this,null,function*(){let r=Jm(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield pV(r,e,t,!0),i})}function l8(n,e){return M(this,null,function*(){let t=Jm(n);yield pV(t,e,!0,!1)})}function pV(n,e,t,r){return M(this,null,function*(){let i=yield Eu(n.localStore,un(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield T0(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Zm(n.remoteStore,i),a})}function T0(n,e,t,r,i){return M(this,null,function*(){n.Ka=(h,g,y)=>function(D,A,P,U){return M(this,null,function*(){let F=A.view.ma(P);F.ns&&(F=yield bm(D.localStore,A.query,!1).then(({documents:I})=>A.view.ma(I,F)));let Q=U&&U.targetChanges.get(A.targetId),re=U&&U.targetMismatches.get(A.targetId)!=null,X=A.view.applyChanges(F,D.isPrimaryClient,Q,re);return jb(D,A.targetId,X.wa),X.snapshot})}(n,h,g,y);let s=yield bm(n.localStore,e,!0),o=new Vm(e,s.Ts),a=o.ma(s.documents),u=Ad.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,u);jb(n,t,l.wa);let d=new Fb(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function d8(n,e,t){return M(this,null,function*(){let r=$(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Ud(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Iu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Cu(r.remoteStore,i.targetId),bu(r,i.targetId)}).catch(ds))):(bu(r,i.targetId),yield Iu(r.localStore,i.targetId,!0))})}function h8(n,e){return M(this,null,function*(){let t=$(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Cu(t.remoteStore,r.targetId))})}function f8(n,e,t){return M(this,null,function*(){let r=x0(n);try{let i=yield function(o,a){let u=$(o),l=Je.now(),d=a.reduce((y,_)=>y.add(_.key),fe()),h,g;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let _=pn(),D=fe();return u.cs.getEntries(y,d).next(A=>{_=A,_.forEach((P,U)=>{U.isValidDocument()||(D=D.add(P))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,_)).next(A=>{h=A;let P=[];for(let U of a){let F=A6(U,h.get(U.key).overlayedDocument);F!=null&&P.push(new cr(U.key,F,dF(F.value.mapValue),rt.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,P,a)}).next(A=>{g=A;let P=A.applyToLocalDocumentSet(h,D);return u.documentOverlayCache.saveOverlays(y,A.batchId,P)})}).then(()=>({batchId:g.batchId,changes:IF(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Ba[o.currentUser.toKey()];l||(l=new ze(le)),l=l.insert(a,u),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield li(r,i.changes),yield Nu(r.remoteStore)}catch(i){let s=ku(i,"Failed to persist write");t.reject(s)}})}function gV(n,e){return M(this,null,function*(){let t=$(n);try{let r=yield z6(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?K(o.va):i.removedDocuments.size>0&&(K(o.va),o.va=!1))}),yield li(t,r,e)}catch(r){yield ds(r)}})}function BO(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=$(o);u.onlineState=a;let l=!1;u.queries.forEach((d,h)=>{for(let g of h.j_)g.Z_(a)&&(l=!0)}),l&&b0(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function p8(n,e,t){return M(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new ze(q.comparator);o=o.insert(s,yt.newNoDocument(s,J.min()));let a=fe().add(s),u=new Td(J.min(),new Map,new ze(le),o,a);yield gV(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),R0(r)}else yield Iu(r.localStore,e,!1).then(()=>bu(r,e,t)).catch(ds)})}function g8(n,e){return M(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield G6(t.localStore,e);S0(t,r,null),A0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield li(t,i)}catch(i){yield ds(i)}})}function m8(n,e,t){return M(this,null,function*(){let r=$(n);try{let i=yield function(o,a){let u=$(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(h=>(K(h!==null),d=h.keys(),u.mutationQueue.removeMutationBatch(l,h))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);S0(r,e,t),A0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield li(r,i)}catch(i){yield ds(i)}})}function y8(n,e){return M(this,null,function*(){let t=$(n);fs(t.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=ku(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function A0(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function S0(n,e,t){let r=$(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function bu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||mV(n,r)})}function mV(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Cu(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),R0(n))}function jb(n,e,t){for(let r of t)r instanceof Om?(n.La.addReference(r.key,e),v8(n,r)):r instanceof Fm?(O("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||mV(n,r.key)):W()}function v8(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(O("SyncEngine","New document in limbo: "+t),n.xa.add(r),R0(n))}function R0(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new q(Ae.fromString(e)),r=n.qa.next();n.Na.set(r,new Vb(t)),n.Oa=n.Oa.insert(t,r),Zm(n.remoteStore,new _u(un(xu(t.path)),r,"TargetPurposeLimboResolution",Nn.oe))}}function li(n,e,t){return M(this,null,function*(){let r=$(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=t?.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){i.push(l);let h=yb.Wi(u.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(u,l){return M(this,null,function*(){let d=$(u);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(l,g=>R.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(h,g.targetId,y)).next(()=>R.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(h,g.targetId,y)))))}catch(h){if(!hs(h))throw h;O("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let g=h.targetId;if(!h.fromCache){let y=d.os.get(g),_=y.snapshotVersion,D=y.withLastLimboFreeSnapshotVersion(_);d.os=d.os.insert(g,D)}}})}(r.localStore,s))})}function _8(n,e){return M(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield tV(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(u=>{u.reject(new k(N.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield li(t,r.hs)}})}function w8(n,e){let t=$(n),r=t.Na.get(e);if(r&&r.va)return fe().add(r.key);{let i=fe(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function E8(n,e){return M(this,null,function*(){let t=$(n),r=yield bm(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&jb(t,e.targetId,i.wa),i})}function I8(n,e){return M(this,null,function*(){let t=$(n);return sV(t.localStore,e).then(r=>li(t,r))})}function C8(n,e,t,r){return M(this,null,function*(){let i=$(n),s=yield function(a,u){let l=$(a),d=$(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,u).next(g=>g?l.localDocuments.getDocuments(h,g):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Nu(i.remoteStore):t==="acknowledged"||t==="rejected"?(S0(i,e,r||null),A0(i,e),function(a,u){$($(a).mutationQueue).On(u)}(i.localStore,e)):W(),yield li(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function D8(n,e){return M(this,null,function*(){let t=$(n);if(Jm(t),x0(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield $O(t,r.toArray());t.Qa=!0,yield Rb(t.remoteStore,!0);for(let s of i)Zm(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(bu(t,o),Iu(t.localStore,o,!0))),Cu(t.remoteStore,o)}),yield i,yield $O(t,r),function(o){let a=$(o);a.Na.forEach((u,l)=>{Cu(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new ze(q.comparator)}(t),t.Qa=!1,yield Rb(t.remoteStore,!1)}})}function $O(n,e,t){return M(this,null,function*(){let r=$(n),i=[],s=[];for(let o of e){let a,u=r.Ma.get(o);if(u&&u.length!==0){a=yield Eu(r.localStore,un(u[0]));for(let l of u){let d=r.Fa.get(l),h=yield E8(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield iV(r.localStore,o);a=yield Eu(r.localStore,l),yield T0(r,yV(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function yV(n){return yF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function b8(n){return function(t){return $($(t).persistence).Qi()}($(n).localStore)}function T8(n,e,t,r){return M(this,null,function*(){let i=$(n);if(i.Qa)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield sV(i.localStore,_F(s[0])),a=Td.createSynthesizedRemoteEventForCurrentChange(e,t==="current",dt.EMPTY_BYTE_STRING);yield li(i,o,a);break}case"rejected":yield Iu(i.localStore,e,!0),bu(i,e,r);break;default:W()}})}function A8(n,e,t){return M(this,null,function*(){let r=Jm(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield iV(r.localStore,i),o=yield Eu(r.localStore,s);yield T0(r,yV(s),o.targetId,!1,o.resumeToken),Zm(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield Iu(r.localStore,i,!1).then(()=>{Cu(r.remoteStore,i),bu(r,i)}).catch(ds))}})}function Jm(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=w8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p8.bind(null,e),e.Ca.d_=a8.bind(null,e.eventManager),e.Ca.$a=u8.bind(null,e.eventManager),e}function x0(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=g8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=m8.bind(null,e),e}function S8(n,e,t){let r=$(n);(function(s,o,a){return M(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(y,_){let D=$(y),A=lt(_.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",P=>D.Gr.getBundleMetadata(P,_.id)).then(P=>!!P&&P.createTime.compareTo(A)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(fV(u));let l=new Ob(u,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let g=yield l.la(d);g&&a._updateProgress(g),d=yield o.Ua()}let h=yield l.complete();return yield li(s,h.Ia,void 0),yield function(y,_){let D=$(y);return D.persistence.runTransaction("Save bundle","readwrite",A=>D.Gr.saveBundleMetadata(A,_))}(s.localStore,u),a._completeWith(h.progress),Promise.resolve(h.Pa)}catch(u){return ar("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Ub=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return M(this,null,function*(){this.serializer=$d(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return eV(this.persistence,new Dm,t.initialUser,this.serializer)}Ga(t){return new Im(Cm.Zr,this.serializer)}Wa(t){return new Sm}terminate(){return M(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Lm=class n extends Ub{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return M(this,null,function*(){yield Hy(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield x0(this.Ja.syncEngine),yield Nu(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return eV(this.persistence,new Dm,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new tb(r,e.asyncQueue,t)}Ha(e,t){let r=new vD(t,this.persistence);return new yD(e.asyncQueue,r)}Ga(e){let t=_0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?zn.withCacheSize(this.cacheSizeBytes):zn.DEFAULT;return new mb(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,aV(),Zg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Sm}},Bb=class n extends Lm{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return M(this,null,function*(){yield Hy(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof md&&(this.sharedClientState.syncEngine={no:C8.bind(null,t),ro:T8.bind(null,t),io:A8.bind(null,t),Qi:b8.bind(null,t),eo:I8.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>M(this,null,function*(){yield D8(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=aV();if(!md.D(t))throw new k(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=_0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new md(t,e.asyncQueue,r,e.clientId,e.initialUser)}},M0=(()=>{class n{initialize(t,r){return M(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>BO(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=_8.bind(null,this.syncEngine),yield Rb(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Nb}()}createDatastore(t){let r=$d(t.databaseInfo.databaseId),i=function(o){return new Cb(o)}(t.databaseInfo);return function(o,a,u,l){return new Tb(o,a,u,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,u){return new Sb(i,s,o,a,u)}(this.localStore,this.datastore,t.asyncQueue,r=>BO(this.syncEngine,r,0),function(){return Rm.D()?new Rm:new Eb}())}createSyncEngine(t,r){return function(s,o,a,u,l,d,h){let g=new Lb(s,o,a,u,l,d);return h&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return M(this,null,function*(){var t,r;yield function(s){return M(this,null,function*(){let o=$(s);O("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Mu(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function qO(n,e=10240){let t=0;return{read(){return M(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return M(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Tu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ut("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var $b=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Et,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return M(this,null,function*(){return this.metadata.promise})}Ua(){return M(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return M(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new kb(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return M(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return M(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return M(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var qb=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return M(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return M(this,null,function*(){let o=$(i),a={documents:s.map(h=>Sd(o.serializer,h))},u=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,Ae.emptyPath(),a,s.length),l=new Map;u.forEach(h=>{let g=P6(o.serializer,h);l.set(g.key.toString(),g)});let d=[];return s.forEach(h=>{let g=l.get(h.toString());K(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new cs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return M(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=q.fromPath(r);this.mutations.push(new Cd(i,this.precondition(i)))}),yield function(r,i){return M(this,null,function*(){let s=$(r),o={writes:i.map(a=>Rd(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,Ae.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw W();t=J.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?rt.exists(!1):rt.updateTime(t):rt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new k(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(t)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Hb=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new Pd(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>M(this,null,function*(){let e=new qb(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!Ld(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!NF(t)}return!1}};var Gb=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=mt.UNAUTHENTICATED,this.clientId=Xg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>M(this,null,function*(){O("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(O("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>M(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ku(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function oD(n,e){return M(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>M(this,null,function*(){r.isEqual(i)||(yield tV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function HO(n,e){return M(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield N0(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>LO(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>LO(e.remoteStore,i)),n._onlineComponents=e})}function N0(n){return M(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield oD(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ar("Error using user provided cache. Falling back to memory cache: "+t),yield oD(n,new Ub)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield oD(n,new Ub);return n._offlineComponents})}function Xm(n){return M(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield HO(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield HO(n,new M0))),n._onlineComponents})}function vV(n){return N0(n).then(e=>e.persistence)}function P0(n){return N0(n).then(e=>e.localStore)}function _V(n){return Xm(n).then(e=>e.remoteStore)}function k0(n){return Xm(n).then(e=>e.syncEngine)}function R8(n){return Xm(n).then(e=>e.datastore)}function Au(n){return M(this,null,function*(){let e=yield Xm(n),t=e.eventManager;return t.onListen=c8.bind(null,e.syncEngine),t.onUnlisten=d8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=l8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=h8.bind(null,e.syncEngine),t})}function x8(n){return n.asyncQueue.enqueue(()=>M(this,null,function*(){let e=yield vV(n),t=yield _V(n);return e.setNetworkEnabled(!0),function(i){let s=$(i);return s.L_.delete(0),qd(s)}(t)}))}function M8(n){return n.asyncQueue.enqueue(()=>M(this,null,function*(){let e=yield vV(n),t=yield _V(n);return e.setNetworkEnabled(!1),function(i){return M(this,null,function*(){let s=$(i);s.L_.add(0),yield Mu(s),s.q_.set("Offline")})}(t)}))}function N8(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s,o){return M(this,null,function*(){try{let a=yield function(l,d){let h=$(l);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new k(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=ku(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield P0(n),e,t)})),t.promise}function wV(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(s,o,a,u,l){let d=new Tu({next:g=>{d.Za(),o.enqueueAndForget(()=>D0(s,h));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new k(N.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&u&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new kd(xu(a.path),d,{includeMetadataChanges:!0,_a:!0});return C0(s,h)}(yield Au(n),n.asyncQueue,e,t,r)})),r.promise}function P8(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s,o){return M(this,null,function*(){try{let a=yield bm(i,s,!0),u=new Vm(s,a.Ts),l=u.ma(a.documents),d=u.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let u=ku(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield P0(n),e,t)})),t.promise}function EV(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(s,o,a,u,l){let d=new Tu({next:g=>{d.Za(),o.enqueueAndForget(()=>D0(s,h)),g.fromCache&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new kd(a,d,{includeMetadataChanges:!0,_a:!0});return C0(s,h)}(yield Au(n),n.asyncQueue,e,t,r)})),r.promise}function k8(n,e){let t=new Tu(e);return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s){$(i).Y_.add(s),s.next()}(yield Au(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s){$(i).Y_.delete(s)}(yield Au(n),t)}))}}function O8(n,e,t,r){let i=function(o,a){let u;return u=typeof o=="string"?kF().encode(o):o,function(d,h){return new $b(d,h)}(function(d,h){if(d instanceof Uint8Array)return qO(d,h);if(d instanceof ArrayBuffer)return qO(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,$d(e));n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){S8(yield k0(n),i,r)}))}function F8(n,e){return n.asyncQueue.enqueue(()=>M(this,null,function*(){return function(r,i){let s=$(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield P0(n),e)}))}function IV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var GO=new Map;function O0(n,e,t){if(!t)throw new k(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function F0(n,e,t,r){if(e===!0&&r===!0)throw new k(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zO(n){if(!q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function WO(n){if(q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ey(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function Se(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ey(n);throw new k(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function CV(n,e){if(e<=0)throw new k(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var jm=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Io=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aD;switch(r.type){case"firstParty":return new dD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return M(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=GO.get(t);r&&(O("ComponentProvider","Removing Datastore"),GO.delete(t),r.terminate())}(this),Promise.resolve()}};function ty(n,e,t,r={}){var i;let s=(n=Se(n,Io))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&ar("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=mt.MOCK_USER;else{a=fh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new k(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new mt(l)}n._authCredentials=new uD(new Jg(a,u))}}var Pt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},qe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Nr=class n extends Pt{constructor(e,t,r){super(e,t,xu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function ny(n,e,...t){if(n=Ee(n),O0("collection","path",e),n instanceof Io){let r=Ae.fromString(e,...t);return WO(r),new Nr(n,null,r)}{if(!(n instanceof qe||n instanceof Nr))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ae.fromString(e,...t));return WO(r),new Nr(n.firestore,null,r)}}function V0(n,e){if(n=Se(n,Io),O0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pt(n,null,function(r){return new ur(Ae.emptyPath(),r)}(e))}function Ou(n,e,...t){if(n=Ee(n),arguments.length===1&&(e=Xg.newId()),O0("doc","path",e),n instanceof Io){let r=Ae.fromString(e,...t);return zO(r),new qe(n,null,new q(r))}{if(!(n instanceof qe||n instanceof Nr))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ae.fromString(e,...t));return zO(r),new qe(n.firestore,n instanceof Nr?n.converter:null,new q(r))}}function ry(n,e){return n=Ee(n),e=Ee(e),(n instanceof qe||n instanceof Nr)&&(e instanceof qe||e instanceof Nr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function iy(n,e){return n=Ee(n),e=Ee(e),n instanceof Pt&&e instanceof Pt&&n.firestore===e.firestore&&Ud(n._query,e._query)&&n.converter===e.converter}var Um=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Pd(this,"async_queue_retry"),this.Vu=()=>{let r=Zg();r&&O("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Zg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Zg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Et;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return M(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!hs(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ut("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=xb.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&W()}verifyOperationInProgress(){}wu(){return M(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function zb(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Wb=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var DV=-1,Xe=class extends Io{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Um,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return M(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Um(e),this._firestoreClient=void 0,yield e}})}};function bV(n,e){let t=typeof n=="object"?n:_s(),r=typeof n=="string"?n:e||"(default)",i=uc(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=hh("firestore");s&&ty(i,...s)}return i}function kt(n){if(n._terminated)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||TV(n),n._firestoreClient}function TV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,u,l,d){return new _D(a,u,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,IV(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Gb(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){let u=a?._online.build();return{_offline:a?._offline.build(u),_online:u}}(n._componentsProvider))}function L0(n,e){ar("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return AV(n,M0.provider,{build:r=>new Lm(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function j0(n){return M(this,null,function*(){ar("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();AV(n,M0.provider,{build:t=>new Bb(t,e.cacheSizeBytes)})})}function AV(n,e,t){if((n=Se(n,Xe))._firestoreClient||n._terminated)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new k(N.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},TV(n)}function U0(n){if(n._initialized&&!n._terminated)throw new k(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Et;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>M(this,null,function*(){try{yield function(r){return M(this,null,function*(){if(!ns.D())return Promise.resolve();let i=r+"main";yield ns.delete(i)})}(_0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function B0(n){return function(t){let r=new Et;return t.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return y8(yield k0(t),r)})),r.promise}(kt(n=Se(n,Xe)))}function $0(n){return x8(kt(n=Se(n,Xe)))}function q0(n){return M8(kt(n=Se(n,Xe)))}function H0(n,e){let t=kt(n=Se(n,Xe)),r=new Wb;return O8(t,n._databaseId,e,r),r}function G0(n,e){return F8(kt(n=Se(n,Xe)),e).then(t=>t?new Pt(n,null,t.query):null)}var Fr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(dt.fromBase64String(e))}catch(t){throw new k(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var lr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ui=class{constructor(e){this._methodName=e}};var Co=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}};var Od=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var V8=/^__.*__$/,Kb=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new cr(e,this.data,this.fieldMask,t,this.fieldTransforms):new us(e,this.data,t,this.fieldTransforms)}},Bm=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new cr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function SV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var $m=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return qm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(SV(this.Cu)&&V8.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Qb=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$d(e)}Qu(e,t,r,i=!1){return new $m({Cu:e,methodName:t,qu:r,path:ct.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ao(n){let e=n._freezeSettings(),t=$d(n._databaseId);return new Qb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sy(n,e,t,r,i,s={}){let o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);K0("Data must be an object, but it was:",o,r);let a=MV(r,o),u,l;if(s.merge)u=new Pn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let g=e0(e,h,t);if(!o.contains(g))throw new k(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);PV(d,g)||d.push(g)}u=new Pn(d),l=o.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,l=o.fieldTransforms;return new Kb(new Wt(a),u,l)}var Fd=class n extends ui{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function RV(n,e,t){return new $m({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Yb=class n extends ui{_toFieldTransform(e){return new _o(e.path,new os)}isEqual(e){return e instanceof n}},Zb=class n extends ui{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=RV(this,e,!0),r=this.Ku.map(s=>So(s,t)),i=new oi(r);return new _o(e.path,i)}isEqual(e){return e instanceof n&&Wy(this.Ku,e.Ku)}},Jb=class n extends ui{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=RV(this,e,!0),r=this.Ku.map(s=>So(s,t)),i=new ai(r);return new _o(e.path,i)}isEqual(e){return e instanceof n&&Wy(this.Ku,e.Ku)}},Xb=class n extends ui{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new as(e.serializer,bF(e.serializer,this.$u));return new _o(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function z0(n,e,t,r){let i=n.Qu(1,e,t);K0("Data must be an object, but it was:",i,r);let s=[],o=Wt.empty();To(r,(u,l)=>{let d=Q0(e,u,t);l=Ee(l);let h=i.Nu(d);if(l instanceof Fd)s.push(d);else{let g=So(l,h);g!=null&&(s.push(d),o.set(d,g))}});let a=new Pn(s);return new Bm(o,a,i.fieldTransforms)}function W0(n,e,t,r,i,s){let o=n.Qu(1,e,t),a=[e0(e,r,t)],u=[i];if(s.length%2!=0)throw new k(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(e0(e,s[g])),u.push(s[g+1]);let l=[],d=Wt.empty();for(let g=a.length-1;g>=0;--g)if(!PV(l,a[g])){let y=a[g],_=u[g];_=Ee(_);let D=o.Nu(y);if(_ instanceof Fd)l.push(y);else{let A=So(_,D);A!=null&&(l.push(y),d.set(y,A))}}let h=new Pn(l);return new Bm(d,h,o.fieldTransforms)}function xV(n,e,t,r=!1){return So(t,n.Qu(r?4:3,e))}function So(n,e){if(NV(n=Ee(n)))return K0("Unsupported field value:",e,n),MV(n,e);if(n instanceof ui)return function(r,i){if(!SV(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=So(a,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return bF(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Je.fromDate(r);return{timestampValue:vu(i.serializer,s)}}if(r instanceof Je){let s=new Je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vu(i.serializer,s)}}if(r instanceof Co)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fr)return{bytesValue:OF(i.serializer,r._byteString)};if(r instanceof qe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:m0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Od)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return g0(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ey(r)}`)}(n,e)}function MV(n,e){let t={};return aF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):To(n,(r,i)=>{let s=So(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function NV(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Je||n instanceof Co||n instanceof Fr||n instanceof qe||n instanceof ui||n instanceof Od)}function K0(n,e,t){if(!NV(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ey(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function e0(n,e,t){if((e=Ee(e))instanceof lr)return e._internalPath;if(typeof e=="string")return Q0(n,e);throw qm("Field path arguments must be of type string or ",n,!1,void 0,t)}var L8=new RegExp("[~\\*/\\[\\]]");function Q0(n,e,t){if(e.search(L8)>=0)throw qm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lr(...e.split("."))._internalPath}catch{throw qm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qm(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new k(N.INVALID_ARGUMENT,a+n+u)}function PV(n,e){return n.some(t=>t.isEqual(e))}var Do=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new t0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(oy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},t0=class extends Do{data(){return super.data()}};function oy(n,e){return typeof e=="string"?Q0(n,e):e instanceof lr?e._internalPath:e._delegate._internalPath}function kV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Vd=class{},bo=class extends Vd{};function Vr(n,e,...t){let r=[];e instanceof Vd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(u=>u instanceof n0).length,a=s.filter(u=>u instanceof Hm).length;if(o>1||o>0&&a>0)throw new k(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Hm=class n extends bo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return FV(e._query,t),new Pt(e.firestore,e.converter,ND(e._query,t))}_parse(e){let t=Ao(e.firestore);return function(s,o,a,u,l,d,h){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new k(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){QO(h,d);let y=[];for(let _ of h)y.push(KO(u,s,_));g={arrayValue:{values:y}}}else g=KO(u,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||QO(h,d),g=xV(a,o,h,d==="in"||d==="not-in");return De.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Y0(n,e,t){let r=e,i=oy("where",n);return Hm._create(i,r,t)}var n0=class n extends Vd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Fe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)FV(o,u),o=ND(o,u)}(e._query,t),new Pt(e.firestore,e.converter,ND(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var r0=class n extends bo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yo(s,o)}(e._query,this._field,this._direction);return new Pt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new ur(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function Z0(n,e="asc"){let t=e,r=oy("orderBy",n);return r0._create(r,t)}var Gm=class n extends bo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Pt(e.firestore,e.converter,cm(e._query,this._limit,this._limitType))}};function J0(n){return CV("limit",n),Gm._create("limit",n,"F")}function X0(n){return CV("limitToLast",n),Gm._create("limitToLast",n,"L")}var zm=class n extends bo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=OV(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new ur(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function eT(...n){return zm._create("startAt",n,!0)}function tT(...n){return zm._create("startAfter",n,!1)}var Wm=class n extends bo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=OV(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new ur(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function nT(...n){return Wm._create("endBefore",n,!1)}function rT(...n){return Wm._create("endAt",n,!0)}function OV(n,e,t,r){if(t[0]=Ee(t[0]),t[0]instanceof Do)return function(s,o,a,u,l){if(!u)throw new k(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of lu(s))if(h.field.isKeyField())d.push(mo(o,u.key));else{let g=u.data.field(h.field);if(Qm(g))throw new k(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=h.field.canonicalString();throw new k(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new kr(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ao(n.firestore);return function(o,a,u,l,d,h){let g=o.explicitOrderBy;if(d.length>g.length)throw new k(N.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let _=0;_<d.length;_++){let D=d[_];if(g[_].field.isKeyField()){if(typeof D!="string")throw new k(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof D}`);if(!f0(o)&&D.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${D}' contains a slash.`);let A=o.path.child(Ae.fromString(D));if(!q.isDocumentKey(A))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let P=new q(A);y.push(mo(a,P))}else{let A=xV(u,l,D);y.push(A)}}return new kr(y,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function KO(n,e,t){if(typeof(t=Ee(t))=="string"){if(t==="")throw new k(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!f0(e)&&t.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Ae.fromString(t));if(!q.isDocumentKey(r))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mo(n,new q(r))}if(t instanceof qe)return mo(n,t._key);throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ey(t)}.`)}function QO(n,e){if(!Array.isArray(n)||n.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function FV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Su=class{convertValue(e,t="none"){switch(go(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return To(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Qe(o.doubleValue));return new Od(s)}convertGeoPoint(e){return new Co(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=d0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(wd(e));default:return null}}convertTimestamp(e){let t=si(e);return new Je(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ae.fromString(e);K(zF(r));let i=new is(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||ut(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function ay(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var i0=class extends Su{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};var ii=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Kn=class extends Do{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new es(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(oy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},es=class extends Kn{data(e={}){return super.data(e)}},dr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ii(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new es(this._firestore,this._userDataWriter,r.key,r,new ii(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ii(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ii(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:j8(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function j8(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function uy(n,e){return n instanceof Kn&&e instanceof Kn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof dr&&e instanceof dr&&n._firestore===e._firestore&&iy(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function iT(n){n=Se(n,qe);let e=Se(n.firestore,Xe);return wV(kt(e),n._key).then(t=>fT(e,n,t))}var ci=class extends Su{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};function sT(n){n=Se(n,qe);let e=Se(n.firestore,Xe),t=kt(e),r=new ci(e);return N8(t,n._key).then(i=>new Kn(e,r,n._key,i,new ii(i!==null&&i.hasLocalMutations,!0),n.converter))}function oT(n){n=Se(n,qe);let e=Se(n.firestore,Xe);return wV(kt(e),n._key,{source:"server"}).then(t=>fT(e,n,t))}function aT(n){n=Se(n,Pt);let e=Se(n.firestore,Xe),t=kt(e),r=new ci(e);return kV(n._query),EV(t,n._query).then(i=>new dr(e,r,n,i))}function uT(n){n=Se(n,Pt);let e=Se(n.firestore,Xe),t=kt(e),r=new ci(e);return P8(t,n._query).then(i=>new dr(e,r,n,i))}function cT(n){n=Se(n,Pt);let e=Se(n.firestore,Xe),t=kt(e),r=new ci(e);return EV(t,n._query,{source:"server"}).then(i=>new dr(e,r,n,i))}function cy(n,e,t){n=Se(n,qe);let r=Se(n.firestore,Xe),i=ay(n.converter,e,t);return Fu(r,[sy(Ao(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function ly(n,e,t,...r){n=Se(n,qe);let i=Se(n.firestore,Xe),s=Ao(i),o;return o=typeof(e=Ee(e))=="string"||e instanceof lr?W0(s,"updateDoc",n._key,e,t,r):z0(s,"updateDoc",n._key,e),Fu(i,[o.toMutation(n._key,rt.exists(!0))])}function lT(n){return Fu(Se(n.firestore,Xe),[new cs(n._key,rt.none())])}function dT(n,e){let t=Se(n.firestore,Xe),r=Ou(n),i=ay(n.converter,e);return Fu(t,[sy(Ao(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function dy(n,...e){var t,r,i;n=Ee(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||zb(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(zb(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let u,l,d;if(n instanceof qe)l=Se(n.firestore,Xe),d=xu(n._key.path),u={next:h=>{e[o]&&e[o](fT(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Se(n,Pt);l=Se(h.firestore,Xe),d=h._query;let g=new ci(l);u={next:y=>{e[o]&&e[o](new dr(l,g,h,y))},error:e[o+1],complete:e[o+2]},kV(n._query)}return function(g,y,_,D){let A=new Tu(D),P=new kd(y,A,_);return g.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return C0(yield Au(g),P)})),()=>{A.Za(),g.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return D0(yield Au(g),P)}))}}(kt(l),d,a,u)}function hT(n,e){return k8(kt(n=Se(n,Xe)),zb(e)?e:{next:e})}function Fu(n,e){return function(r,i){let s=new Et;return r.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return f8(yield k0(r),i,s)})),s.promise}(kt(n),e)}function fT(n,e,t){let r=t.docs.get(e._key),i=new ci(n);return new Kn(n,i,e._key,r,new ii(t.hasPendingWrites,t.fromCache),e.converter)}var U8={maxAttempts:5};var Km=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ao(e)}set(e,t,r){this._verifyNotCommitted();let i=Ji(e,this._firestore),s=ay(i.converter,t,r),o=sy(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Ji(e,this._firestore),o;return o=typeof(t=Ee(t))=="string"||t instanceof lr?W0(this._dataReader,"WriteBatch.update",s._key,t,r,i):z0(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ji(e,this._firestore);return this._mutations=this._mutations.concat(new cs(t._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ji(n,e){if((n=Ee(n)).firestore!==e)throw new k(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var s0=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ao(t)}get(t){let r=Ji(t,this._firestore),i=new i0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return W();let o=s[0];if(o.isFoundDocument())return new Do(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Do(this._firestore,i,r._key,null,r.converter);throw W()})}set(t,r,i){let s=Ji(t,this._firestore),o=ay(s.converter,r,i),a=sy(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Ji(t,this._firestore),a;return a=typeof(r=Ee(r))=="string"||r instanceof lr?W0(this._dataReader,"Transaction.update",o._key,r,i,s):z0(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Ji(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ji(e,this._firestore),r=new ci(this._firestore);return super.get(e).then(i=>new Kn(this._firestore,r,t._key,i._document,new ii(!1,!1),t.converter))}};function pT(n,e,t){n=Se(n,Xe);let r=Object.assign(Object.assign({},U8),t);return function(s){if(s.maxAttempts<1)throw new k(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new Et;return s.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){let l=yield R8(s);new Hb(s.asyncQueue,l,a,o,u).au()})),u.promise}(kt(n),i=>e(new s0(n,i)),r)}function gT(){return new Fd("deleteField")}function mT(){return new Yb("serverTimestamp")}function yT(...n){return new Zb("arrayUnion",n)}function vT(...n){return new Jb("arrayRemove",n)}function _T(n){return new Xb("increment",n)}(function(e,t=!0){(function(i){Ru=i})(vh),vs(new mn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Xe(new cD(r.getProvider("auth-internal")),new fD(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new k(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new is(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),it(W1,"4.7.3",e),it(W1,"4.7.3","esm2017")})();var Hd=class{constructor(e){return e}},VV="firestore",wT=class{constructor(){return Ks(VV)}};var ET=new G("angularfire2.firestore-instances");function B8(n,e){let t=Ra(VV,n,e);return t&&new Hd(t)}function $8(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Hd(r)}}var q8={provide:wT,deps:[[new at,ET]]},H8={provide:Hd,useFactory:B8,deps:[[new at,ET],rr]};function LV(n,...e){return it("angularfire",Dt.full,"fst"),en([H8,q8,{provide:ET,useFactory:$8(n),multi:!0,deps:[me,Ht,fn,Jr,[new at,so],[new at,nn],...e]}])}var jV=ki(bV,!0);var Gd=class{constructor(e){return e}},UV="database",IT=class{constructor(){return Ks(UV)}};var CT=new G("angularfire2.database-instances");function G8(n,e){let t=Ra(UV,n,e);return t&&new Gd(t)}function z8(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Gd(r)}}var W8={provide:IT,deps:[[new at,CT]]},K8={provide:Gd,useFactory:G8,deps:[[new at,CT],rr]};function BV(n,...e){return it("angularfire",Dt.full,"rtdb"),en([K8,W8,{provide:CT,useFactory:z8(n),multi:!0,deps:[me,Ht,fn,Jr,[new at,so],[new at,nn],...e]}])}var $V=ki(Hk,!0);var Q8="@firebase/firestore-compat",Y8="0.3.38";function RT(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function qV(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function HV(){if(!uF())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}var hy=class n{constructor(e){this._delegate=e}static fromBase64String(e){return HV(),new n(Fr.fromBase64String(e))}static fromUint8Array(e){return qV(),new n(Fr.fromUint8Array(e))}toBase64(){return HV(),this._delegate.toBase64()}toUint8Array(){return qV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function DT(n){return Z8(n,["next","error","complete"])}function Z8(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var bT=class{enableIndexedDbPersistence(e,t){return L0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return j0(e._delegate)}clearIndexedDbPersistence(e){return U0(e._delegate)}},fy=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof is||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ar("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){ty(this._delegate,e,t,r)}enableNetwork(){return $0(this._delegate)}disableNetwork(){return q0(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,F0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return B0(this._delegate)}onSnapshotsInSync(e){return hT(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ju(this,ny(this._delegate,e))}catch(t){throw cn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Lr(this,Ou(this._delegate,e))}catch(t){throw cn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new No(this,V0(this._delegate,e))}catch(t){throw cn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return pT(this._delegate,t=>e(new py(this,t)))}batch(){return kt(this._delegate),new gy(new Km(this._delegate,e=>Fu(this._delegate,e)))}loadBundle(e){return H0(this._delegate,e)}namedQuery(e){return G0(this._delegate,e).then(t=>t?new No(this,t):null)}},Vu=class extends Su{constructor(e){super(),this.firestore=e}convertBytes(e){return new hy(new Fr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Lr.forKey(t,this.firestore,null)}};function J8(n){o0(n)}var py=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Vu(e)}get(e){let t=Ro(e);return this._delegate.get(t).then(r=>new xo(this._firestore,new Kn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Ro(e);return r?(RT("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ro(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ro(e);return this._delegate.delete(t),this}},gy=class{constructor(e){this._delegate=e}set(e,t,r){let i=Ro(e);return r?(RT("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ro(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ro(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Lu=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new es(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Mo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Vu(e),t),i.set(t,s)),s}};Lu.INSTANCES=new WeakMap;var Lr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Vu(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new qe(t._delegate,r,new q(e)))}static forKey(e,t,r){return new n(t,new qe(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ju(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ju(this.firestore,ny(this._delegate,e))}catch(t){throw cn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ee(e),e instanceof qe?ry(this._delegate,e):!1}set(e,t){t=RT("DocumentReference.set",t);try{return t?cy(this._delegate,e,t):cy(this._delegate,e)}catch(r){throw cn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?ly(this._delegate,e):ly(this._delegate,e,t,...r)}catch(i){throw cn(i,"updateDoc()","DocumentReference.update()")}}delete(){return lT(this._delegate)}onSnapshot(...e){let t=GV(e),r=zV(e,i=>new xo(this.firestore,new Kn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return dy(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=sT(this._delegate):e?.source==="server"?t=oT(this._delegate):t=iT(this._delegate),t.then(r=>new xo(this.firestore,new Kn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function cn(n,e,t){return n.message=n.message.replace(e,t),n}function GV(n){for(let e of n)if(typeof e=="object"&&!DT(e))return e;return{}}function zV(n,e){var t,r;let i;return DT(n[0])?i=n[0]:DT(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var xo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Lr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uy(this._delegate,e._delegate)}},Mo=class extends xo{data(e){let t=this._delegate.data(e);return this._delegate._converter||YO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},No=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Vu(e)}where(e,t,r){try{return new n(this.firestore,Vr(this._delegate,Y0(e,t,r)))}catch(i){throw cn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Vr(this._delegate,Z0(e,t)))}catch(r){throw cn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Vr(this._delegate,J0(e)))}catch(t){throw cn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Vr(this._delegate,X0(e)))}catch(t){throw cn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Vr(this._delegate,eT(...e)))}catch(t){throw cn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Vr(this._delegate,tT(...e)))}catch(t){throw cn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Vr(this._delegate,nT(...e)))}catch(t){throw cn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Vr(this._delegate,rT(...e)))}catch(t){throw cn(t,"endAt()","Query.endAt()")}}isEqual(e){return iy(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=uT(this._delegate):e?.source==="server"?t=cT(this._delegate):t=aT(this._delegate),t.then(r=>new zd(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=GV(e),r=zV(e,i=>new zd(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return dy(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},TT=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Mo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},zd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new No(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Mo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new TT(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Mo(this._firestore,r))})}isEqual(e){return uy(this._delegate,e._delegate)}},ju=class n extends No{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Lr(this.firestore,e):null}doc(e){try{return e===void 0?new Lr(this.firestore,Ou(this._delegate)):new Lr(this.firestore,Ou(this._delegate,e))}catch(t){throw cn(t,"doc()","CollectionReference.doc()")}}add(e){return dT(this._delegate,e).then(t=>new Lr(this.firestore,t))}isEqual(e){return ry(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ro(n){return Se(n,qe)}var AT=class n{constructor(...e){this._delegate=new lr(...e)}static documentId(){return new n(ct.keyField().canonicalString())}isEqual(e){return e=Ee(e),e instanceof lr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var ST=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=mT();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=gT();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=yT(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=vT(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=_T(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var X8={Firestore:fy,GeoPoint:Co,Timestamp:Je,Blob:hy,Transaction:py,WriteBatch:gy,DocumentReference:Lr,DocumentSnapshot:xo,Query:No,QueryDocumentSnapshot:Mo,QuerySnapshot:zd,CollectionReference:ju,FieldPath:AT,FieldValue:ST,setLogLevel:J8,CACHE_SIZE_UNLIMITED:DV};function eK(n,e){n.INTERNAL.registerComponent(new mn("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},X8)))}function tK(n){eK(n,(e,t)=>new fy(e,t,new bT)),n.registerVersion(Q8,Y8)}tK(_t);function nK(n,e=Ds){return new he(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function WV(n,e){return nK(n,e)}function rK(n,e){return WV(n,e).pipe(Ts(void 0),fc(),Z(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function NT(n,e){return WV(n,e).pipe(Z(t=>({payload:t,type:"query"})))}var my=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=JV(r,t);return new vy(i,s,this.afs)}snapshotChanges(){return rK(this.ref,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return this.snapshotChanges().pipe(Z(({payload:t})=>e.idField?xe(z({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Me(this.ref.get(e)).pipe(nt)}};function yy(n,e){return NT(n,e).pipe(Ts(void 0),fc(),Z(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let l=s.find(h=>h.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(h=>h.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function KV(n,e,t){return yy(n,t).pipe(pr((r,i)=>iK(r,i.map(s=>s.payload),e),[]),hc(),Z(r=>r.map(i=>({type:i.type,payload:i}))))}function iK(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=sK(n,r))}),n}function xT(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function sK(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return xT(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return xT(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return xT(n,e.oldIndex,1);break}return n}function QV(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var vy=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=yy(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Z(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Ts(void 0),fc(),xt(([r,i])=>i.length>0||!r),Z(([,r])=>r),nt)}auditTrail(e){return this.stateChanges(e).pipe(pr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=QV(e);return KV(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return NT(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.payload.docs.map(r=>e.idField?xe(z({},r.data()),{[e.idField]:r.id}):r.data())),nt)}get(e){return Me(this.query.get(e)).pipe(nt)}add(e){return this.ref.add(e)}doc(e){return new my(this.ref.doc(e),this.afs)}},MT=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?yy(this.query,this.afs.schedulers.outsideAngular).pipe(nt):yy(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.filter(r=>e.indexOf(r.type)>-1)),xt(t=>t.length>0),nt)}auditTrail(e){return this.stateChanges(e).pipe(pr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=QV(e);return KV(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return NT(this.query,this.afs.schedulers.outsideAngular).pipe(Z(r=>r.payload.docs.map(i=>e.idField?z({[e.idField]:i.id},i.data()):i.data())),nt)}get(e){return Me(this.query.get(e)).pipe(nt)}},YV=new G("angularfire2.enableFirestorePersistence"),ZV=new G("angularfire2.firestore.persistenceSettings"),oK=new G("angularfire2.firestore.settings"),aK=new G("angularfire2.firestore.use-emulator");function JV(n,e=t=>t){return{query:e(n),ref:n}}var uK=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,u,l,d,h,g,y,_,D,A,P,U){this.schedulers=u;let F=Qs(t,a,r),Q=d;h&&vl(F,a,g,_,D,A,y,P),[this.firestore,this.persistenceEnabled$]=xa(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let re=a.runOutsideAngular(()=>F.firestore());if(s&&re.settings(s),Q&&re.useEmulator(...Q),i&&!Zr(o)){let X=()=>{try{return Me(re.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),ee(!1)}};return[re,a.runOutsideAngular(X)]}else return[re,ee(!1)]},[s,Q,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=JV(i,r),a=this.schedulers.ngZone.run(()=>s);return new vy(a,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new MT(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new my(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(L(Fi),L(Vi,8),L(YV,8),L(oK,8),L(ft),L(me),L(fn),L(ZV,8),L(aK,8),L(_l,8),L(hl,8),L(fl,8),L(pl,8),L(gl,8),L(ml,8),L(yl,8),L(nn,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),XV=(()=>{class n{constructor(){_t.registerVersion("angularfire",Dt.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:YV,useValue:!0},{provide:ZV,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Xt({type:n});static \u0275inj=Jt({providers:[uK]})}return n})();var eL={apiKey:"AIzaSyAR1vRlux6tvsqbsvsejQGpoJ9w7VxBlOE",authDomain:"zuu-makup-shop.firebaseapp.com",databaseURL:"https://zuu-makup-shop-default-rtdb.firebaseio.com",projectId:"zuu-makup-shop",storageBucket:"zuu-makup-shop.firebasestorage.app",messagingSenderId:"13943401966",appId:"1:13943401966:web:c944415f1aca6be35a32ff",measurementId:"G-PW0KK53GE8"};var tL={providers:[UN(B1),M_([nP.initializeApp(eL),rP,n1,XV]),oN(),BN(()=>$N({projectId:"zuu-makup-shop",appId:"1:13943401966:web:c944415f1aca6be35a32ff",databaseURL:"https://zuu-makup-shop-default-rtdb.firebaseio.com",storageBucket:"zuu-makup-shop.firebasestorage.app",apiKey:"AIzaSyAR1vRlux6tvsqbsvsejQGpoJ9w7VxBlOE",authDomain:"zuu-makup-shop.firebaseapp.com",messagingSenderId:"13943401966",measurementId:"G-PW0KK53GE8"})),q1(()=>H1()),LV(()=>jV()),BV(()=>$V())]};var nL=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-navbar"]],standalone:!0,features:[$n],decls:19,vars:0,consts:[[1,"text-center"],[1,"navbar","navbar-expand-lg","bg-body-tertiary"],[1,"container-fluid","justify-content-center"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","mx-auto","mb-2","mb-lg-0","justify-content-center"],[1,"nav-item"],["aria-current","page","routerLink","home",1,"nav-link","active","text-center"],["routerLink","makeupproducts",1,"nav-link"],["routerLink","shades",1,"nav-link"]],template:function(r,i){r&1&&(H(0,"div",0)(1,"h1")(2,"b"),se(3,"MAYBELLINE"),Y()()(),H(4,"nav",1)(5,"div",2)(6,"button",3),Ce(7,"span",4),Y(),H(8,"div",5)(9,"ul",6)(10,"li",7)(11,"a",8),se(12,"Home"),Y()(),H(13,"li",7)(14,"a",9),se(15,"Products"),Y()(),H(16,"li",7)(17,"a",10),se(18,"Shades"),Y()()()()()())},dependencies:[Sp],styles:[".navbar[_ngcontent-%COMP%]{background-color:#000!important}.navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#fff!important}.navbar-toggler-icon[_ngcontent-%COMP%]{background-color:#fff}"]})}}return n})();var rL=(()=>{class n{constructor(){this.title="zuu-makup-shop"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-root"]],standalone:!0,features:[$n],decls:2,vars:0,template:function(r,i){r&1&&Ce(0,"app-navbar")(1,"router-outlet")},dependencies:[al,nL]})}}return n})();iN(rL,tL).catch(n=>console.error(n));
